import{s as De,e as y,k as j,c as I,a as k,d as m,o as A,f as h,i as C,g as _,n as ve,t as U,b as W,I as Oe,C as nt,u as me,h as G,Q as Ue,H as Xe,j as Me,p as qe,B as ht,q as vt,y as ze,A as Ze,r as yn,v as In,w as Mn,x as En,E as be,F as ke,l as ce,T as nn,D as Ne,N as Nn,an as Kt,S as Tt,P as Dt,ai as Dn,aj as Vn}from"./scheduler.BXITcVIL.js";import{S as Te,i as Be,b as K,d as Q,m as X,t as b,a as D,e as $,f as Ke,g as ee,c as te,h as Vt}from"./index.CKC1pLeO.js";import{e as ye,u as rn,o as an}from"./each.CeC5znru.js";import{m as Ot,b as Qt,h as on,g as Cn,F as Tn,G as Bn,k as Ht,e as fn,u as Lt,c as Bt,l as Sn,z as Xt,B as Rn}from"./index.DGiyb8ll.js";import{t as Le}from"./Toaster.svelte_svelte_type_style_lang.D8ruyfxE.js";import{f as On,u as Hn,i as Ln}from"./index.CsC5nGr8.js";import{b as Ut,l as un,t as Pn,f as gt,q as St,v as $t}from"./index.CaHcOjnl.js";import{d as _t}from"./relativeTime.BDz4fsXT.js";import{s as jn}from"./index.DZ2HRC5r.js";import{i as An}from"./index.Bb72RTxA.js";import{ai as zn,ag as kt,af as cn,ae as Wt,ah as dn}from"./Markdown.BbZedqzQ.js";import{T as Re}from"./Tooltip.Bk1C4ypY.js";import{T as Un}from"./Tags.kVqnOEmd.js";import{S as Pt}from"./Spinner.Ds4ZYjMW.js";import{C as hn}from"./ChevronDown.42HMvR_9.js";import{C as mn}from"./ChevronUp.Bgs0GDa3.js";import{M as Wn}from"./MagnifyingGlass.D1DKxpCN.js";import{C as gn}from"./Collapsible.CJfsRPy2.js";import{I as qn,F as Jn}from"./FileItem.CACyhZZd.js";import{M as _n}from"./Modal.DzDM0HzR.js";import{B as qt}from"./Badge.CuKOUNVw.js";import{C as Fn}from"./Check.D1vNMA1z.js";import{X as Gn}from"./XMark.DBrT1hqs.js";import{E as Yn}from"./EllipsisHorizontal.BVtzwp2E.js";import{m as Rt}from"./marked.esm._0_gBwjO.js";import{c as xt}from"./index.CyvP7FPD.js";import{u as el,c as Zn}from"./index.eSIRLnfB.js";import{b as Kn}from"./index.DppQFxdV.js";import{L as Qn}from"./Loader.B3t5FLIZ.js";import{f as Ct}from"./index.tP7o4U0v.js";function Xn(r){let e,t,l,s,n,i,a,o,f,u,c,d,g,v,M,p,N,w,S,B,T,V,R,O,E,L;return{c(){e=y("div"),t=y("div"),l=y("div"),s=y("div"),i=j(),a=y("div"),o=y("div"),u=j(),c=y("div"),g=j(),v=y("div"),M=y("div"),N=j(),w=y("div"),B=j(),T=y("div"),R=j(),O=y("div"),this.h()},l(z){e=I(z,"DIV",{class:!0});var q=k(e);t=I(q,"DIV",{class:!0});var ie=k(t);l=I(ie,"DIV",{class:!0});var se=k(l);s=I(se,"DIV",{class:!0}),k(s).forEach(m),i=A(se),a=I(se,"DIV",{class:!0});var ne=k(a);o=I(ne,"DIV",{class:!0}),k(o).forEach(m),u=A(ne),c=I(ne,"DIV",{class:!0}),k(c).forEach(m),ne.forEach(m),g=A(se),v=I(se,"DIV",{class:!0});var fe=k(v);M=I(fe,"DIV",{class:!0}),k(M).forEach(m),N=A(fe),w=I(fe,"DIV",{class:!0}),k(w).forEach(m),B=A(fe),T=I(fe,"DIV",{class:!0}),k(T).forEach(m),fe.forEach(m),R=A(se),O=I(se,"DIV",{class:!0}),k(O).forEach(m),se.forEach(m),ie.forEach(m),q.forEach(m),this.h()},h(){h(s,"class",n=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded mr-14"),h(o,"class",f=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2"),h(c,"class",d=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1"),h(a,"class","grid grid-cols-3 gap-4"),h(M,"class",p=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1"),h(w,"class",S=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2"),h(T,"class",V=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1 mr-4"),h(v,"class","grid grid-cols-4 gap-4"),h(O,"class",E=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded"),h(l,"class",L=(r[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),h(t,"class","animate-pulse flex w-full"),h(e,"class","w-full mt-2 mb-2")},m(z,q){C(z,e,q),_(e,t),_(t,l),_(l,s),_(l,i),_(l,a),_(a,o),_(a,u),_(a,c),_(l,g),_(l,v),_(v,M),_(v,N),_(v,w),_(v,B),_(v,T),_(l,R),_(l,O)},p(z,[q]){q&1&&n!==(n=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded mr-14")&&h(s,"class",n),q&1&&f!==(f=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2")&&h(o,"class",f),q&1&&d!==(d=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1")&&h(c,"class",d),q&1&&p!==(p=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1")&&h(M,"class",p),q&1&&S!==(S=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-2")&&h(w,"class",S),q&1&&V!==(V=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded col-span-1 mr-4")&&h(T,"class",V),q&1&&E!==(E=(z[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded")&&h(O,"class",E),q&1&&L!==(L=(z[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&h(l,"class",L)},i:ve,o:ve,d(z){z&&m(e)}}}function $n(r,e,t){let{size:l="md"}=e;return r.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Jt extends Te{constructor(e){super(),Be(this,e,$n,Xn,De,{size:0})}}function tl(r,e,t){const l=r.slice();return l[23]=e[t],l}function ll(r,e,t){const l=r.slice();return l[26]=e[t],l}function sl(r){var s;let e,t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((s=r[7])==null?void 0:s.name)??r[7].id:r[1].selectedModelId})+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);l=W(i,t),i.forEach(m),this.h()},h(){h(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(n,i){C(n,e,i),_(e,l)},p(n,i){var a;i&386&&t!==(t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((a=n[7])==null?void 0:a.name)??n[7].id:n[1].selectedModelId})+"")&&G(l,t)},d(n){n&&m(e)}}}function nl(r){let e,t=r[26]+"",l,s,n,i,a,o;function f(){return r[12](r[26])}return{c(){e=y("button"),l=U(t),s=j(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var c=k(e);l=W(c,t),s=A(c),c.forEach(m),this.h()},h(){var u,c;h(e,"class",n="size-7 text-sm border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white disabled:dark:bg-gray-900"),e.disabled=i=((c=(u=r[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?r[26]>5:r[26]<6},m(u,c){C(u,e,c),_(e,l),_(e,s),a||(o=me(e,"click",f),a=!0)},p(u,c){var d,g;r=u,c&64&&n!==(n="size-7 text-sm border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white disabled:dark:bg-gray-900")&&h(e,"class",n),c&2&&i!==(i=((g=(d=r[1])==null?void 0:d.annotation)==null?void 0:g.rating)===-1?r[26]>5:r[26]<6)&&(e.disabled=i)},d(u){u&&m(e),a=!1,o()}}}function rl(r){let e,t=r[8].t("Why?")+"",l,s,n,i=ye(r[3]),a=[];for(let o=0;o<i.length;o+=1)a[o]=il(tl(r,i,o));return{c(){e=y("div"),l=U(t),s=j(),n=y("div");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(m),s=A(o),n=I(o,"DIV",{class:!0});var u=k(n);for(let c=0;c<a.length;c+=1)a[c].l(u);u.forEach(m),this.h()},h(){h(e,"class","text-sm mt-1.5 font-medium"),h(n,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(o,f){C(o,e,f),_(e,l),C(o,s,f),C(o,n,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(n,null)},p(o,f){if(f&256&&t!==(t=o[8].t("Why?")+"")&&G(l,t),f&280){i=ye(o[3]);let u;for(u=0;u<i.length;u+=1){const c=tl(o,i,u);a[u]?a[u].p(c,f):(a[u]=il(c),a[u].c(),a[u].m(n,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}},d(o){o&&(m(e),m(s),m(n)),Ue(a,o)}}}function xn(r){let e=r[23]+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&G(t,e)},d(l){l&&m(t)}}}function er(r){let e=r[8].t("Other")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&G(t,e)},d(l){l&&m(t)}}}function tr(r){let e=r[8].t("Being lazy")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&G(t,e)},d(l){l&&m(t)}}}function lr(r){let e=r[8].t("Refused when it shouldn't have")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&G(t,e)},d(l){l&&m(t)}}}function sr(r){let e=r[8].t("Didn't fully follow instructions")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&G(t,e)},d(l){l&&m(t)}}}function nr(r){let e=r[8].t("Not factually correct")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&G(t,e)},d(l){l&&m(t)}}}function rr(r){let e=r[8].t("Not helpful")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&G(t,e)},d(l){l&&m(t)}}}function ir(r){let e=r[8].t("Too verbose")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&G(t,e)},d(l){l&&m(t)}}}function ar(r){let e=r[8].t("Don't like the style")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&G(t,e)},d(l){l&&m(t)}}}function or(r){let e=r[8].t("Thorough explanation")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&G(t,e)},d(l){l&&m(t)}}}function fr(r){let e=r[8].t("Attention to detail")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&G(t,e)},d(l){l&&m(t)}}}function ur(r){let e=r[8].t("Positive attitude")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&G(t,e)},d(l){l&&m(t)}}}function cr(r){let e=r[8].t("Showcased creativity")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&G(t,e)},d(l){l&&m(t)}}}function dr(r){let e=r[8].t("Followed instructions perfectly")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&G(t,e)},d(l){l&&m(t)}}}function hr(r){let e=r[8].t("Accurate information")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&G(t,e)},d(l){l&&m(t)}}}function il(r){let e,t,l,s,n;function i(u,c){return u[23]==="accurate_information"?hr:u[23]==="followed_instructions_perfectly"?dr:u[23]==="showcased_creativity"?cr:u[23]==="positive_attitude"?ur:u[23]==="attention_to_detail"?fr:u[23]==="thorough_explanation"?or:u[23]==="dont_like_the_style"?ar:u[23]==="too_verbose"?ir:u[23]==="not_helpful"?rr:u[23]==="not_factually_correct"?nr:u[23]==="didnt_fully_follow_instructions"?sr:u[23]==="refused_when_it_shouldnt_have"?lr:u[23]==="being_lazy"?tr:u[23]==="other"?er:xn}let a=i(r),o=a(r);function f(){return r[13](r[23])}return{c(){e=y("button"),o.c(),t=j(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var c=k(e);o.l(c),t=A(c),c.forEach(m),this.h()},h(){h(e,"class",l="px-3 py-0.5 border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){C(u,e,c),o.m(e,null),_(e,t),s||(n=me(e,"click",f),s=!0)},p(u,c){r=u,a===(a=i(r))&&o?o.p(r,c):(o.d(1),o=a(r),o&&(o.c(),o.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-50 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&h(e,"class",l)},d(u){u&&m(e),o.d(),s=!1,n()}}}function mr(r){var oe;let e,t,l,s,n=r[8].t("How would you rate this response?")+"",i,a,o,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,d,g,v,M,p,N,w=r[8].t("Awful")+"",S,B,T,V,R=r[8].t("Amazing")+"",O,E,L,z,q,ie,se,ne,fe,F,le,ge,_e,H=r[8].t("Save")+"",x,he,ae,Y,P,Z=((oe=r[1])==null?void 0:oe.arena)&&sl(r),de=ye(Array.from({length:10}).map(al)),ue=[];for(let re=0;re<de.length;re+=1)ue[re]=nl(ll(r,de,re));let we=r[3].length>0&&rl(r);return le=new Un({props:{tags:r[2]}}),le.$on("delete",r[15]),le.$on("add",r[16]),{c(){Z&&Z.c(),e=j(),t=y("div"),l=y("div"),s=y("div"),i=U(n),a=j(),o=y("button"),o.innerHTML=f,u=j(),c=y("div"),d=y("div"),g=y("div");for(let re=0;re<ue.length;re+=1)ue[re].c();v=j(),M=y("div"),p=y("div"),N=U("1 - "),S=U(w),B=j(),T=y("div"),V=U("10 - "),O=U(R),E=j(),L=y("div"),we&&we.c(),z=j(),q=y("div"),ie=y("textarea"),ne=j(),fe=y("div"),F=y("div"),K(le.$$.fragment),ge=j(),_e=y("button"),x=U(H),this.h()},l(re){Z&&Z.l(re),e=A(re),t=I(re,"DIV",{class:!0,id:!0});var pe=k(t);l=I(pe,"DIV",{class:!0});var Ve=k(l);s=I(Ve,"DIV",{class:!0});var Pe=k(s);i=W(Pe,n),Pe.forEach(m),a=A(Ve),o=I(Ve,"BUTTON",{"data-svelte-h":!0}),Oe(o)!=="svelte-1ew22ui"&&(o.innerHTML=f),Ve.forEach(m),u=A(pe),c=I(pe,"DIV",{class:!0});var Ce=k(c);d=I(Ce,"DIV",{class:!0});var je=k(d);g=I(je,"DIV",{class:!0});var Ae=k(g);for(let et=0;et<ue.length;et+=1)ue[et].l(Ae);Ae.forEach(m),v=A(je),M=I(je,"DIV",{class:!0});var Je=k(M);p=I(Je,"DIV",{});var $e=k(p);N=W($e,"1 - "),S=W($e,w),$e.forEach(m),B=A(Je),T=I(Je,"DIV",{});var xe=k(T);V=W(xe,"10 - "),O=W(xe,R),xe.forEach(m),Je.forEach(m),je.forEach(m),Ce.forEach(m),E=A(pe),L=I(pe,"DIV",{});var rt=k(L);we&&we.l(rt),rt.forEach(m),z=A(pe),q=I(pe,"DIV",{class:!0});var it=k(q);ie=I(it,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(ie).forEach(m),it.forEach(m),ne=A(pe),fe=I(pe,"DIV",{class:!0});var Qe=k(fe);F=I(Qe,"DIV",{class:!0});var at=k(F);Q(le.$$.fragment,at),at.forEach(m),ge=A(Qe),_e=I(Qe,"BUTTON",{class:!0});var ot=k(_e);x=W(ot,H),ot.forEach(m),Qe.forEach(m),pe.forEach(m),this.h()},h(){h(s,"class","text-sm font-medium"),h(l,"class","flex justify-between items-center"),h(g,"class","mt-1.5 w-fit flex gap-1 pb-5"),h(M,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),h(d,"class","relative w-fit"),h(c,"class","w-full flex justify-center"),h(ie,"class","w-full text-sm px-1 py-2 bg-transparent outline-none resize-none rounded-xl"),h(ie,"placeholder",se=r[8].t("Feel free to add specific details")),h(ie,"rows","3"),h(q,"class","mt-2"),h(F,"class","flex items-end group"),h(_e,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(fe,"class","mt-2 gap-1.5 flex justify-between"),h(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-50 dark:border-gray-850"),h(t,"id",he="message-feedback-"+r[1].id)},m(re,pe){Z&&Z.m(re,pe),C(re,e,pe),C(re,t,pe),_(t,l),_(l,s),_(s,i),_(l,a),_(l,o),_(t,u),_(t,c),_(c,d),_(d,g);for(let Ve=0;Ve<ue.length;Ve+=1)ue[Ve]&&ue[Ve].m(g,null);_(d,v),_(d,M),_(M,p),_(p,N),_(p,S),_(M,B),_(M,T),_(T,V),_(T,O),_(t,E),_(t,L),we&&we.m(L,null),_(t,z),_(t,q),_(q,ie),nt(ie,r[5]),_(t,ne),_(t,fe),_(fe,F),X(le,F,null),_(fe,ge),_(fe,_e),_(_e,x),ae=!0,Y||(P=[me(o,"click",r[11]),me(ie,"input",r[14]),me(_e,"click",r[17])],Y=!0)},p(re,[pe]){var Pe;if((Pe=re[1])!=null&&Pe.arena?Z?Z.p(re,pe):(Z=sl(re),Z.c(),Z.m(e.parentNode,e)):Z&&(Z.d(1),Z=null),(!ae||pe&256)&&n!==(n=re[8].t("How would you rate this response?")+"")&&G(i,n),pe&66){de=ye(Array.from({length:10}).map(al));let Ce;for(Ce=0;Ce<de.length;Ce+=1){const je=ll(re,de,Ce);ue[Ce]?ue[Ce].p(je,pe):(ue[Ce]=nl(je),ue[Ce].c(),ue[Ce].m(g,null))}for(;Ce<ue.length;Ce+=1)ue[Ce].d(1);ue.length=de.length}(!ae||pe&256)&&w!==(w=re[8].t("Awful")+"")&&G(S,w),(!ae||pe&256)&&R!==(R=re[8].t("Amazing")+"")&&G(O,R),re[3].length>0?we?we.p(re,pe):(we=rl(re),we.c(),we.m(L,null)):we&&(we.d(1),we=null),(!ae||pe&256&&se!==(se=re[8].t("Feel free to add specific details")))&&h(ie,"placeholder",se),pe&32&&nt(ie,re[5]);const Ve={};pe&4&&(Ve.tags=re[2]),le.$set(Ve),(!ae||pe&256)&&H!==(H=re[8].t("Save")+"")&&G(x,H),(!ae||pe&2&&he!==(he="message-feedback-"+re[1].id))&&h(t,"id",he)},i(re){ae||(b(le.$$.fragment,re),ae=!0)},o(re){D(le.$$.fragment,re),ae=!1},d(re){re&&(m(e),m(t)),Z&&Z.d(re),Ue(ue,re),we&&we.d(),$(le),Y=!1,Xe(P)}}}const al=(r,e)=>e+1;function gr(r,e,t){let l,s;Me(r,Ot,L=>t(18,s=L));const n=qe("i18n");Me(r,n,L=>t(8,l=L));const i=ht();let{message:a}=e,{show:o=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],d=[],g=null,v="",M=null,p=null;const N=()=>{var L,z,q,ie,se;g||t(4,g=((L=a==null?void 0:a.annotation)==null?void 0:L.reason)??""),v||t(5,v=((z=a==null?void 0:a.annotation)==null?void 0:z.comment)??""),t(2,c=(((q=a==null?void 0:a.annotation)==null?void 0:q.tags)??[]).map(ne=>({name:ne}))),M||t(6,M=((se=(ie=a==null?void 0:a.annotation)==null?void 0:ie.details)==null?void 0:se.rating)??null)};vt(()=>{a!=null&&a.arena&&(t(7,p=s.find(L=>L.id===a.selectedModelId)),Le.success(l.t('This response was generated by "{{model}}"',{model:p?(p==null?void 0:p.name)??p.id:a.selectedModelId})))});const w=()=>{console.log("saveHandler"),i("save",{reason:g,comment:v,tags:c.map(L=>L.name),details:{rating:M}}),Le.success(l.t("Thanks for your feedback!")),t(0,o=!1)},S=()=>{t(0,o=!1)},B=L=>{t(6,M=L)},T=L=>{t(4,g=L)};function V(){v=this.value,t(5,v)}const R=L=>{t(2,c=c.filter(z=>z.name.replaceAll(" ","_").toLowerCase()!==L.detail.replaceAll(" ","_").toLowerCase()))},O=L=>{t(2,c=[...c,{name:L.detail}])},E=()=>{w()};return r.$$set=L=>{"message"in L&&t(1,a=L.message),"show"in L&&t(0,o=L.show)},r.$$.update=()=>{var L,z;r.$$.dirty&2&&(((L=a==null?void 0:a.annotation)==null?void 0:L.rating)===1?t(3,d=f):((z=a==null?void 0:a.annotation)==null?void 0:z.rating)===-1&&t(3,d=u)),r.$$.dirty&2&&a&&N()},[o,a,c,d,g,v,M,p,l,n,w,S,B,T,V,R,O,E]}class _r extends Te{constructor(e){super(),Be(this,e,gr,mr,De,{message:1,show:0})}}function ol(r,e,t){const l=r.slice();return l[5]=e[t],l[7]=t,l}function vr(r){let e,t;return e=new hn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function pr(r){let e,t;return e=new mn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function br(r){let e,t,l,s,n;const i=r[2].default,a=yn(i,r,r[4],null),o=[pr,vr],f=[];function u(c,d){return c[1]?0:1}return l=u(r),s=f[l]=o[l](r),{c(){e=y("div"),a&&a.c(),t=j(),s.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var d=k(e);a&&a.l(d),t=A(d),s.l(d),d.forEach(m),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,d){C(c,e,d),a&&a.m(e,null),_(e,t),f[l].m(e,null),n=!0},p(c,d){a&&a.p&&(!n||d&16)&&In(a,i,c,c[4],n?En(i,c[4],d,null):Mn(c[4]),null);let g=l;l=u(c),l!==g&&(ee(),D(f[g],1,1,()=>{f[g]=null}),te(),s=f[l],s||(s=f[l]=o[l](c),s.c()),b(s,1),s.m(e,null))},i(c){n||(b(a,c),b(s),n=!0)},o(c){D(a,c),D(s),n=!1},d(c){c&&m(e),a&&a.d(c),f[l].d()}}}function fl(r){let e,t,l,s,n,i=r[0].query+"",a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,d;return l=new Wn({}),{c(){e=y("a"),t=y("div"),K(l.$$.fragment),s=j(),n=y("div"),a=U(i),o=j(),f=y("div"),f.innerHTML=u,this.h()},l(g){e=I(g,"A",{href:!0,target:!0,class:!0});var v=k(e);t=I(v,"DIV",{class:!0});var M=k(t);Q(l.$$.fragment,M),s=A(M),n=I(M,"DIV",{class:!0});var p=k(n);a=W(p,i),p.forEach(m),M.forEach(m),o=A(v),f=I(v,"DIV",{class:!0,"data-svelte-h":!0}),Oe(f)!=="svelte-14xjows"&&(f.innerHTML=u),v.forEach(m),this.h()},h(){h(n,"class","line-clamp-1"),h(t,"class","flex gap-2 items-center"),h(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",c="https://www.google.com/search?q="+r[0].query),h(e,"target","_blank"),h(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(g,v){C(g,e,v),_(e,t),X(l,t,null),_(t,s),_(t,n),_(n,a),_(e,o),_(e,f),d=!0},p(g,v){(!d||v&1)&&i!==(i=g[0].query+"")&&G(a,i),(!d||v&1&&c!==(c="https://www.google.com/search?q="+g[0].query))&&h(e,"href",c)},i(g){d||(b(l.$$.fragment,g),d=!0)},o(g){D(l.$$.fragment,g),d=!1},d(g){g&&m(e),$(l)}}}function ul(r){let e,t,l=r[5]+"",s,n,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',o,f,u;return{c(){e=y("a"),t=y("div"),s=U(l),n=j(),i=y("div"),i.innerHTML=a,o=j(),this.h()},l(c){e=I(c,"A",{href:!0,target:!0,class:!0});var d=k(e);t=I(d,"DIV",{class:!0});var g=k(t);s=W(g,l),g.forEach(m),n=A(d),i=I(d,"DIV",{class:!0,"data-svelte-h":!0}),Oe(i)!=="svelte-14xjows"&&(i.innerHTML=a),o=A(d),d.forEach(m),this.h()},h(){h(t,"class","line-clamp-1"),h(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",f=r[5]),h(e,"target","_blank"),h(e,"class",u="flex w-full items-center p-3 px-4 "+(r[7]===r[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,d){C(c,e,d),_(e,t),_(t,s),_(e,n),_(e,i),_(e,o)},p(c,d){d&1&&l!==(l=c[5]+"")&&G(s,l),d&1&&f!==(f=c[5])&&h(e,"href",f),d&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&h(e,"class",u)},d(c){c&&m(e)}}}function kr(r){var a;let e,t,l,s=((a=r[0])==null?void 0:a.query)&&fl(r),n=ye(r[0].urls),i=[];for(let o=0;o<n.length;o+=1)i[o]=ul(ol(r,n,o));return{c(){e=y("div"),s&&s.c(),t=j();for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=I(o,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=A(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){h(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),h(e,"slot","content")},m(o,f){C(o,e,f),s&&s.m(e,null),_(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(o,f){var u;if((u=o[0])!=null&&u.query?s?(s.p(o,f),f&1&&b(s,1)):(s=fl(o),s.c(),b(s,1),s.m(e,t)):s&&(ee(),D(s,1,1,()=>{s=null}),te()),f&1){n=ye(o[0].urls);let c;for(c=0;c<n.length;c+=1){const d=ol(o,n,c);i[c]?i[c].p(d,f):(i[c]=ul(d),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=n.length}},i(o){l||(b(s),l=!0)},o(o){D(s),l=!1},d(o){o&&m(e),s&&s.d(),Ue(i,o)}}}function wr(r){let e,t,l;function s(i){r[3](i)}let n={className:"w-full space-y-1",$$slots:{content:[kr],default:[br]},$$scope:{ctx:r}};return r[1]!==void 0&&(n.open=r[1]),e=new gn({props:n}),ze.push(()=>Ke(e,"open",s)),{c(){K(e.$$.fragment)},l(i){Q(e.$$.fragment,i)},m(i,a){X(e,i,a),l=!0},p(i,[a]){const o={};a&19&&(o.$$scope={dirty:a,ctx:i}),!t&&a&2&&(t=!0,o.open=i[1],Ze(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){$(e,i)}}}function yr(r,e,t){let{$$slots:l={},$$scope:s}=e,{status:n={urls:[],query:""}}=e,i=!1;function a(o){i=o,t(1,i)}return r.$$set=o=>{"status"in o&&t(0,n=o.status),"$$scope"in o&&t(4,s=o.$$scope)},[n,i,l,a,s]}class Ir extends Te{constructor(e){super(),Be(this,e,yr,wr,De,{status:0})}}function Mr(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Er(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Nr extends Te{constructor(e){super(),Be(this,e,Er,Mr,De,{className:0,strokeWidth:1})}}function Dr(r){let e,t,l,s,n,i=(typeof r[0]=="string"?r[0]:JSON.stringify(r[0]))+"",a,o;return l=new qn({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=y("div"),t=y("div"),K(l.$$.fragment),s=j(),n=y("div"),a=U(i),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);t=I(u,"DIV",{class:!0});var c=k(t);Q(l.$$.fragment,c),c.forEach(m),s=A(u),n=I(u,"DIV",{class:!0});var d=k(n);a=W(d,i),d.forEach(m),u.forEach(m),this.h()},h(){h(t,"class","self-start mt-0.5"),h(n,"class","self-center text-sm"),h(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){C(f,e,u),_(e,t),X(l,t,null),_(e,s),_(e,n),_(n,a),o=!0},p(f,[u]){(!o||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&G(a,i)},i(f){o||(b(l.$$.fragment,f),o=!0)},o(f){D(l.$$.fragment,f),o=!1},d(f){f&&m(e),$(l)}}}function Vr(r,e,t){let{content:l=""}=e;return r.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}class Cr extends Te{constructor(e){super(),Be(this,e,Vr,Dr,De,{content:0})}}function cl(r,e,t){const l=r.slice();return l[9]=e[t],l[11]=t,l}function Tr(r){const e=r.slice(),t=Wr(e[9].distance);return e[12]=t,e}function Br(r){let e,t=r[4].t("No source available")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No source available")+"")&&G(l,t)},i:ve,o:ve,d(s){s&&m(e)}}}function Sr(r){let e,t,l,s;e=new Re({props:{className:"w-fit",content:r[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Rr]},$$scope:{ctx:r}}});let n=r[2]&&hl(r);return{c(){K(e.$$.fragment),t=j(),n&&n.c(),l=ce()},l(i){Q(e.$$.fragment,i),t=A(i),n&&n.l(i),l=ce()},m(i,a){X(e,i,a),C(i,t,a),n&&n.m(i,a),C(i,l,a),s=!0},p(i,a){const o={};a&16&&(o.content=i[4].t("Open file")),a&8216&&(o.$$scope={dirty:a,ctx:i}),e.$set(o),i[2]?n?(n.p(i,a),a&4&&b(n,1)):(n=hl(i),n.c(),b(n,1),n.m(l.parentNode,l)):n&&(ee(),D(n,1,1,()=>{n=null}),te())},i(i){s||(b(e.$$.fragment,i),b(n),s=!0)},o(i){D(e.$$.fragment,i),D(n),s=!1},d(i){i&&(m(t),m(l)),$(e,i),n&&n.d(i)}}}function dl(r){let e,t,l=r[4].t("page")+"",s,n,i=r[9].metadata.page+1+"",a,o;return{c(){e=y("span"),t=U("("),s=U(l),n=j(),a=U(i),o=U(")"),this.h()},l(f){e=I(f,"SPAN",{class:!0});var u=k(e);t=W(u,"("),s=W(u,l),n=A(u),a=W(u,i),o=W(u,")"),u.forEach(m),this.h()},h(){h(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){C(f,e,u),_(e,t),_(e,s),_(e,n),_(e,a),_(e,o)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&G(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&G(a,i)},d(f){f&&m(e)}}}function Rr(r){var o,f,u,c;let e,t,l=(((f=(o=r[9])==null?void 0:o.metadata)==null?void 0:f.name)??r[9].source.name)+"",s,n,i,a=((c=(u=r[9])==null?void 0:u.metadata)==null?void 0:c.page)&&dl(r);return{c(){e=y("div"),t=y("a"),s=U(l),i=j(),a&&a.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=k(e);t=I(g,"A",{class:!0,href:!0,target:!0});var v=k(t);s=W(v,l),v.forEach(m),i=A(g),a&&a.l(g),g.forEach(m),this.h()},h(){var d,g,v,M,p,N,w,S;h(t,"class","hover:text-gray-500 hover:dark:text-gray-100 underline flex-grow"),h(t,"href",n=(g=(d=r[9])==null?void 0:d.metadata)!=null&&g.file_id?`${Qt}/files/${(M=(v=r[9])==null?void 0:v.metadata)==null?void 0:M.file_id}/content${((N=(p=r[9])==null?void 0:p.metadata)==null?void 0:N.page)!==void 0?`#page=${r[9].metadata.page+1}`:""}`:(S=(w=r[9].source)==null?void 0:w.url)!=null&&S.includes("http")?r[9].source.url:"#"),h(t,"target","_blank"),h(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(d,g){C(d,e,g),_(e,t),_(t,s),_(e,i),a&&a.m(e,null)},p(d,g){var v,M,p,N,w,S,B,T,V,R,O,E;g&8&&l!==(l=(((M=(v=d[9])==null?void 0:v.metadata)==null?void 0:M.name)??d[9].source.name)+"")&&G(s,l),g&8&&n!==(n=(N=(p=d[9])==null?void 0:p.metadata)!=null&&N.file_id?`${Qt}/files/${(S=(w=d[9])==null?void 0:w.metadata)==null?void 0:S.file_id}/content${((T=(B=d[9])==null?void 0:B.metadata)==null?void 0:T.page)!==void 0?`#page=${d[9].metadata.page+1}`:""}`:(R=(V=d[9].source)==null?void 0:V.url)!=null&&R.includes("http")?d[9].source.url:"#")&&h(t,"href",n),(E=(O=d[9])==null?void 0:O.metadata)!=null&&E.page?a?a.p(d,g):(a=dl(d),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(d){d&&m(e),a&&a.d()}}}function hl(r){let e,t=r[4].t("Relevance")+"",l,s,n,i,a,o;const f=[Hr,Or],u=[];function c(d,g){return d[9].distance!==void 0?0:1}return n=c(r),i=u[n]=f[n](r),{c(){e=y("div"),l=U(t),s=j(),i.c(),a=ce(),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=k(e);l=W(g,t),g.forEach(m),s=A(d),i.l(d),a=ce(),this.h()},h(){h(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(d,g){C(d,e,g),_(e,l),C(d,s,g),u[n].m(d,g),C(d,a,g),o=!0},p(d,g){(!o||g&16)&&t!==(t=d[4].t("Relevance")+"")&&G(l,t);let v=n;n=c(d),n===v?u[n].p(d,g):(ee(),D(u[v],1,1,()=>{u[v]=null}),te(),i=u[n],i?i.p(d,g):(i=u[n]=f[n](d),i.c()),b(i,1),i.m(a.parentNode,a))},i(d){o||(b(i),o=!0)},o(d){D(i),o=!1},d(d){d&&(m(e),m(s),m(a)),u[n].d(d)}}}function Or(r){let e,t=r[4].t("No distance available")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No distance available")+"")&&G(l,t)},i:ve,o:ve,d(s){s&&m(e)}}}function Hr(r){let e,t;return e=new Re({props:{className:"w-fit",content:r[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Pr]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s&16&&(n.content=l[4].t("Semantic distance to query")),s&8202&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Lr(r){let e,t=r[9].distance.toFixed(4)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&8&&t!==(t=s[9].distance.toFixed(4)+"")&&G(l,t)},d(s){s&&m(e)}}}function ml(r){let e,t=r[12].toFixed(2)+"",l,s,n,i,a,o,f=r[9].distance.toFixed(4)+"",u,c;return{c(){e=y("span"),l=U(t),s=U("%"),i=j(),a=y("span"),o=U("("),u=U(f),c=U(")"),this.h()},l(d){e=I(d,"SPAN",{class:!0});var g=k(e);l=W(g,t),s=W(g,"%"),g.forEach(m),i=A(d),a=I(d,"SPAN",{class:!0});var v=k(a);o=W(v,"("),u=W(v,f),c=W(v,")"),v.forEach(m),this.h()},h(){h(e,"class",n=`px-1 rounded font-medium ${vl(r[12])}`),h(a,"class","text-gray-500 dark:text-gray-500")},m(d,g){C(d,e,g),_(e,l),_(e,s),C(d,i,g),C(d,a,g),_(a,o),_(a,u),_(a,c)},p(d,g){g&8&&t!==(t=d[12].toFixed(2)+"")&&G(l,t),g&8&&n!==(n=`px-1 rounded font-medium ${vl(d[12])}`)&&h(e,"class",n),g&8&&f!==(f=d[9].distance.toFixed(4)+"")&&G(u,f)},d(d){d&&(m(e),m(i),m(a))}}}function Pr(r){let e;function t(i,a){return i[1]?ml:Lr}function l(i,a){return a===ml?Tr(i):i}let s=t(r),n=s(l(r,s));return{c(){e=y("div"),n.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);n.l(a),a.forEach(m),this.h()},h(){h(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,a){C(i,e,a),n.m(e,null)},p(i,a){s===(s=t(i))&&n?n.p(l(i,s),a):(n.d(1),n=s(l(i,s)),n&&(n.c(),n.m(e,null)))},d(i){i&&m(e),n.d()}}}function jr(r){let e,t,l=r[9].document+"",s,n;return{c(){e=y("pre"),t=U("                "),s=U(l),n=U(`
              `),this.h()},l(i){e=I(i,"PRE",{class:!0});var a=k(e);t=W(a,"                "),s=W(a,l),n=W(a,`
              `),a.forEach(m),this.h()},h(){h(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,a){C(i,e,a),_(e,t),_(e,s),_(e,n)},p(i,a){a&8&&l!==(l=i[9].document+"")&&G(s,l)},d(i){i&&m(e)}}}function Ar(r){let e,t,l;return{c(){e=y("iframe"),this.h()},l(s){e=I(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(m),this.h()},h(){h(e,"class","w-full border-0 h-auto rounded-none"),h(e,"sandbox","allow-scripts allow-forms allow-same-origin"),h(e,"srcdoc",t=r[9].document),h(e,"title",l=r[4].t("Content"))},m(s,n){C(s,e,n)},p(s,n){n&8&&t!==(t=s[9].document)&&h(e,"srcdoc",t),n&16&&l!==(l=s[4].t("Content"))&&h(e,"title",l)},d(s){s&&m(e)}}}function gl(r){let e;return{c(){e=y("hr"),this.h()},l(t){e=I(t,"HR",{class:!0}),this.h()},h(){h(e,"class","dark:border-gray-850 my-3")},m(t,l){C(t,e,l)},d(t){t&&m(e)}}}function _l(r){let e,t,l=r[4].t("Source")+"",s,n,i,a,o,f,u,c=r[4].t("Content")+"",d,g,v,M,p;const N=[Sr,Br],w=[];function S(O,E){var L;return(L=O[9].source)!=null&&L.name?0:1}i=S(r),a=w[i]=N[i](r);function B(O,E){var L;return(L=O[9].metadata)!=null&&L.html?Ar:jr}let T=B(r),V=T(r),R=r[11]!==r[3].length-1&&gl();return{c(){e=y("div"),t=y("div"),s=U(l),n=j(),a.c(),o=j(),f=y("div"),u=y("div"),d=U(c),g=j(),V.c(),v=j(),R&&R.c(),M=ce(),this.h()},l(O){e=I(O,"DIV",{class:!0});var E=k(e);t=I(E,"DIV",{class:!0});var L=k(t);s=W(L,l),L.forEach(m),n=A(E),a.l(E),E.forEach(m),o=A(O),f=I(O,"DIV",{class:!0});var z=k(f);u=I(z,"DIV",{class:!0});var q=k(u);d=W(q,c),q.forEach(m),g=A(z),V.l(z),z.forEach(m),v=A(O),R&&R.l(O),M=ce(),this.h()},h(){h(t,"class","text-sm font-medium dark:text-gray-300"),h(e,"class","flex flex-col w-full"),h(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),h(f,"class","flex flex-col w-full")},m(O,E){C(O,e,E),_(e,t),_(t,s),_(e,n),w[i].m(e,null),C(O,o,E),C(O,f,E),_(f,u),_(u,d),_(f,g),V.m(f,null),C(O,v,E),R&&R.m(O,E),C(O,M,E),p=!0},p(O,E){(!p||E&16)&&l!==(l=O[4].t("Source")+"")&&G(s,l);let L=i;i=S(O),i===L?w[i].p(O,E):(ee(),D(w[L],1,1,()=>{w[L]=null}),te(),a=w[i],a?a.p(O,E):(a=w[i]=N[i](O),a.c()),b(a,1),a.m(e,null)),(!p||E&16)&&c!==(c=O[4].t("Content")+"")&&G(d,c),T===(T=B(O))&&V?V.p(O,E):(V.d(1),V=T(O),V&&(V.c(),V.m(f,null))),O[11]!==O[3].length-1?R||(R=gl(),R.c(),R.m(M.parentNode,M)):R&&(R.d(1),R=null)},i(O){p||(b(a),p=!0)},o(O){D(a),p=!1},d(O){O&&(m(e),m(o),m(f),m(v),m(M)),w[i].d(),V.d(),R&&R.d(O)}}}function zr(r){let e,t,l,s=r[4].t("Citation")+"",n,i,a,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,d,g,v,M=ye(r[3]),p=[];for(let w=0;w<M.length;w+=1)p[w]=_l(cl(r,M,w));const N=w=>D(p[w],1,1,()=>{p[w]=null});return{c(){e=y("div"),t=y("div"),l=y("div"),n=U(s),i=j(),a=y("button"),a.innerHTML=o,f=j(),u=y("div"),c=y("div");for(let w=0;w<p.length;w+=1)p[w].c();this.h()},l(w){e=I(w,"DIV",{});var S=k(e);t=I(S,"DIV",{class:!0});var B=k(t);l=I(B,"DIV",{class:!0});var T=k(l);n=W(T,s),T.forEach(m),i=A(B),a=I(B,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(a)!=="svelte-745w2y"&&(a.innerHTML=o),B.forEach(m),f=A(S),u=I(S,"DIV",{class:!0});var V=k(u);c=I(V,"DIV",{class:!0});var R=k(c);for(let O=0;O<p.length;O+=1)p[O].l(R);R.forEach(m),V.forEach(m),S.forEach(m),this.h()},h(){h(l,"class","text-lg font-medium self-center capitalize"),h(a,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(w,S){C(w,e,S),_(e,t),_(t,l),_(l,n),_(t,i),_(t,a),_(e,f),_(e,u),_(u,c);for(let B=0;B<p.length;B+=1)p[B]&&p[B].m(c,null);d=!0,g||(v=me(a,"click",r[7]),g=!0)},p(w,S){if((!d||S&16)&&s!==(s=w[4].t("Citation")+"")&&G(n,s),S&30){M=ye(w[3]);let B;for(B=0;B<M.length;B+=1){const T=cl(w,M,B);p[B]?(p[B].p(T,S),b(p[B],1)):(p[B]=_l(T),p[B].c(),b(p[B],1),p[B].m(c,null))}for(ee(),B=M.length;B<p.length;B+=1)N(B);te()}},i(w){if(!d){for(let S=0;S<M.length;S+=1)b(p[S]);d=!0}},o(w){p=p.filter(Boolean);for(let S=0;S<p.length;S+=1)D(p[S]);d=!1},d(w){w&&m(e),Ue(p,w),g=!1,v()}}}function Ur(r){let e,t,l;function s(i){r[8](i)}let n={size:"lg",$$slots:{default:[zr]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new _n({props:n}),ze.push(()=>Ke(e,"show",s)),{c(){K(e.$$.fragment)},l(i){Q(e.$$.fragment,i)},m(i,a){X(e,i,a),l=!0},p(i,[a]){const o={};a&8223&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ze(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){$(e,i)}}}function Wr(r){return r<0?0:r>1?100:Math.round(r*1e4)/100}function vl(r){return r>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":r>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":r>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function qr(r,e,t){let l;const s=qe("i18n");Me(r,s,d=>t(4,l=d));let{show:n=!1}=e,{citation:i}=e,{showPercentage:a=!1}=e,{showRelevance:o=!0}=e,f=[];const u=()=>{t(0,n=!1)};function c(d){n=d,t(0,n)}return r.$$set=d=>{"show"in d&&t(0,n=d.show),"citation"in d&&t(6,i=d.citation),"showPercentage"in d&&t(1,a=d.showPercentage),"showRelevance"in d&&t(2,o=d.showRelevance)},r.$$.update=()=>{var d;r.$$.dirty&72&&i&&(t(3,f=(d=i.document)==null?void 0:d.map((g,v)=>{var M,p;return{source:i.source,document:g,metadata:(M=i.metadata)==null?void 0:M[v],distance:(p=i.distances)==null?void 0:p[v]}})),f.every(g=>g.distance!==void 0)&&t(3,f=f.sort((g,v)=>(v.distance??1/0)-(g.distance??1/0))))},[n,a,o,f,l,s,i,u,c]}class Jr extends Te{constructor(e){super(),Be(this,e,qr,Ur,De,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function pl(r,e,t){const l=r.slice();return l[17]=e[t],l[19]=t,l}function bl(r,e,t){const l=r.slice();return l[17]=e[t],l[19]=t,l}function kl(r,e,t){const l=r.slice();return l[17]=e[t],l[19]=t,l}function wl(r){let e,t,l,s;const n=[Gr,Fr],i=[];function a(o,f){return o[0].length<=3?0:1}return t=a(r),l=i[t]=n[t](r),{c(){e=y("div"),l.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){h(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(o,f){C(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t===u?i[t].p(o,f):(ee(),D(i[u],1,1,()=>{i[u]=null}),te(),l=i[t],l?l.p(o,f):(l=i[t]=n[t](o),l.c()),b(l,1),l.m(e,null))},i(o){s||(b(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function Fr(r){let e,t,l;function s(i){r[16](i)}let n={className:"w-full",$$slots:{content:[Qr],default:[Kr]},$$scope:{ctx:r}};return r[5]!==void 0&&(n.open=r[5]),e=new gn({props:n}),ze.push(()=>Ke(e,"open",s)),{c(){K(e.$$.fragment)},l(i){Q(e.$$.fragment,i)},m(i,a){X(e,i,a),l=!0},p(i,a){const o={};a&4194425&&(o.$$scope={dirty:a,ctx:i}),!t&&a&32&&(t=!0,o.open=i[5],Ze(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){$(e,i)}}}function Gr(r){let e,t=ye(r[0]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Dl(kl(r,t,s));return{c(){e=y("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);for(let i=0;i<l.length;i+=1)l[i].l(n);n.forEach(m),this.h()},h(){h(e,"class","flex text-xs font-medium")},m(s,n){C(s,e,n);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,n){if(n&25){t=ye(s[0]);let i;for(i=0;i<t.length;i+=1){const a=kl(s,t,i);l[i]?l[i].p(a,n):(l[i]=Dl(a),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ve,o:ve,d(s){s&&m(e),Ue(l,s)}}}function yl(r){let e,t=r[19]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&m(e)}}}function Il(r){let e,t=r[0].every(r[11]),l,s,n=r[17].source.name+"",i,a,o,f,u=t&&yl(r);function c(){return r[15](r[17])}return{c(){e=y("button"),u&&u.c(),l=j(),s=y("div"),i=U(n),a=j(),this.h()},l(d){e=I(d,"BUTTON",{class:!0});var g=k(e);u&&u.l(g),l=A(g),s=I(g,"DIV",{class:!0});var v=k(s);i=W(v,n),v.forEach(m),a=A(g),g.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 line-clamp-1 truncate"),h(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(d,g){C(d,e,g),u&&u.m(e,null),_(e,l),_(e,s),_(s,i),_(e,a),o||(f=[me(e,"click",c),me(e,"pointerup",ei)],o=!0)},p(d,g){r=d,g&1&&(t=r[0].every(r[11])),t?u||(u=yl(r),u.c(),u.m(e,l)):u&&(u.d(1),u=null),g&1&&n!==(n=r[17].source.name+"")&&G(i,n)},d(d){d&&m(e),u&&u.d(),o=!1,Xe(f)}}}function Yr(r){let e,t;return e=new hn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Zr(r){let e,t;return e=new mn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Kr(r){let e,t,l,s=r[6].t("References from")+"",n,i,a,o,f,u,c,d=r[6].t("and")+"",g,v,M=r[0].length-2+"",p,N,w,S=r[6].t("more")+"",B,T,V,R,O,E,L=ye(r[0].slice(0,2)),z=[];for(let ne=0;ne<L.length;ne+=1)z[ne]=Il(pl(r,L,ne));const q=[Zr,Yr],ie=[];function se(ne,fe){return ne[5]?0:1}return R=se(r),O=ie[R]=q[R](r),{c(){e=y("div"),t=y("div"),l=y("span"),n=U(s),i=j(),a=y("div"),o=y("div");for(let ne=0;ne<z.length;ne+=1)z[ne].c();f=j(),u=y("div"),c=y("span"),g=U(d),v=j(),p=U(M),N=j(),w=y("span"),B=U(S),T=j(),V=y("div"),O.c(),this.h()},l(ne){e=I(ne,"DIV",{class:!0});var fe=k(e);t=I(fe,"DIV",{class:!0});var F=k(t);l=I(F,"SPAN",{class:!0});var le=k(l);n=W(le,s),le.forEach(m),i=A(F),a=I(F,"DIV",{class:!0});var ge=k(a);o=I(ge,"DIV",{class:!0});var _e=k(o);for(let Y=0;Y<z.length;Y+=1)z[Y].l(_e);_e.forEach(m),ge.forEach(m),f=A(F),u=I(F,"DIV",{class:!0});var H=k(u);c=I(H,"SPAN",{class:!0});var x=k(c);g=W(x,d),x.forEach(m),v=A(H),p=W(H,M),N=A(H),w=I(H,"SPAN",{});var he=k(w);B=W(he,S),he.forEach(m),H.forEach(m),F.forEach(m),T=A(fe),V=I(fe,"DIV",{class:!0});var ae=k(V);O.l(ae),ae.forEach(m),fe.forEach(m),this.h()},h(){h(l,"class","whitespace-nowrap hidden sm:inline"),h(o,"class","flex text-xs font-medium items-center"),h(a,"class","flex items-center"),h(c,"class","hidden sm:inline"),h(u,"class","flex items-center gap-1 whitespace-nowrap"),h(t,"class","flex-grow flex items-center gap-1 overflow-hidden"),h(V,"class","flex-shrink-0"),h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(ne,fe){C(ne,e,fe),_(e,t),_(t,l),_(l,n),_(t,i),_(t,a),_(a,o);for(let F=0;F<z.length;F+=1)z[F]&&z[F].m(o,null);_(t,f),_(t,u),_(u,c),_(c,g),_(u,v),_(u,p),_(u,N),_(u,w),_(w,B),_(e,T),_(e,V),ie[R].m(V,null),E=!0},p(ne,fe){if((!E||fe&64)&&s!==(s=ne[6].t("References from")+"")&&G(n,s),fe&25){L=ye(ne[0].slice(0,2));let le;for(le=0;le<L.length;le+=1){const ge=pl(ne,L,le);z[le]?z[le].p(ge,fe):(z[le]=Il(ge),z[le].c(),z[le].m(o,null))}for(;le<z.length;le+=1)z[le].d(1);z.length=L.length}(!E||fe&64)&&d!==(d=ne[6].t("and")+"")&&G(g,d),(!E||fe&1)&&M!==(M=ne[0].length-2+"")&&G(p,M),(!E||fe&64)&&S!==(S=ne[6].t("more")+"")&&G(B,S);let F=R;R=se(ne),R!==F&&(ee(),D(ie[F],1,1,()=>{ie[F]=null}),te(),O=ie[R],O||(O=ie[R]=q[R](ne),O.c()),b(O,1),O.m(V,null))},i(ne){E||(b(O),E=!0)},o(ne){D(O),E=!1},d(ne){ne&&m(e),Ue(z,ne),ie[R].d()}}}function Ml(r){let e,t=r[19]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&m(e)}}}function El(r){let e,t=r[0].every(r[10]),l,s,n=r[17].source.name+"",i,a,o,f,u=t&&Ml(r);function c(){return r[14](r[17])}return{c(){e=y("button"),u&&u.c(),l=j(),s=y("div"),i=U(n),a=j(),this.h()},l(d){e=I(d,"BUTTON",{class:!0});var g=k(e);u&&u.l(g),l=A(g),s=I(g,"DIV",{class:!0});var v=k(s);i=W(v,n),v.forEach(m),a=A(g),g.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 line-clamp-1 truncate"),h(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(d,g){C(d,e,g),u&&u.m(e,null),_(e,l),_(e,s),_(s,i),_(e,a),o||(f=me(e,"click",c),o=!0)},p(d,g){r=d,g&1&&(t=r[0].every(r[10])),t?u||(u=Ml(r),u.c(),u.m(e,l)):u&&(u.d(1),u=null),g&1&&n!==(n=r[17].source.name+"")&&G(i,n)},d(d){d&&m(e),u&&u.d(),o=!1,f()}}}function Qr(r){let e,t,l=ye(r[0]),s=[];for(let n=0;n<l.length;n+=1)s[n]=El(bl(r,l,n));return{c(){e=y("div"),t=y("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=I(n,"DIV",{slot:!0});var i=k(e);t=I(i,"DIV",{class:!0});var a=k(t);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),i.forEach(m),this.h()},h(){h(t,"class","flex text-xs font-medium"),h(e,"slot","content")},m(n,i){C(n,e,i),_(e,t);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null)},p(n,i){if(i&25){l=ye(n[0]);let a;for(a=0;a<l.length;a+=1){const o=bl(n,l,a);s[a]?s[a].p(o,i):(s[a]=El(o),s[a].c(),s[a].m(t,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=l.length}},d(n){n&&m(e),Ue(s,n)}}}function Nl(r){let e,t=r[19]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&m(e)}}}function Dl(r){let e,t=r[0].every(r[9]),l,s,n=r[17].source.name+"",i,a,o,f,u,c=t&&Nl(r);function d(){return r[13](r[17])}return{c(){e=y("button"),c&&c.c(),l=j(),s=y("div"),i=U(n),a=j(),this.h()},l(g){e=I(g,"BUTTON",{id:!0,class:!0});var v=k(e);c&&c.l(v),l=A(v),s=I(v,"DIV",{class:!0});var M=k(s);i=W(M,n),M.forEach(m),a=A(v),v.forEach(m),this.h()},h(){h(s,"class","flex-1 mx-1 line-clamp-1 text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),h(e,"id",o=`source-${r[17].source.name}`),h(e,"class","no-toggle outline-none flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(g,v){C(g,e,v),c&&c.m(e,null),_(e,l),_(e,s),_(s,i),_(e,a),f||(u=me(e,"click",d),f=!0)},p(g,v){r=g,v&1&&(t=r[0].every(r[9])),t?c||(c=Nl(r),c.c(),c.m(e,l)):c&&(c.d(1),c=null),v&1&&n!==(n=r[17].source.name+"")&&G(i,n),v&1&&o!==(o=`source-${r[17].source.name}`)&&h(e,"id",o)},d(g){g&&m(e),c&&c.d(),f=!1,u()}}}function Xr(r){let e,t,l,s,n;function i(f){r[12](f)}let a={citation:r[4],showPercentage:r[1],showRelevance:r[2]};r[3]!==void 0&&(a.show=r[3]),e=new Jr({props:a}),ze.push(()=>Ke(e,"show",i));let o=r[0].length>0&&wl(r);return{c(){K(e.$$.fragment),l=j(),o&&o.c(),s=ce()},l(f){Q(e.$$.fragment,f),l=A(f),o&&o.l(f),s=ce()},m(f,u){X(e,f,u),C(f,l,u),o&&o.m(f,u),C(f,s,u),n=!0},p(f,[u]){const c={};u&16&&(c.citation=f[4]),u&2&&(c.showPercentage=f[1]),u&4&&(c.showRelevance=f[2]),!t&&u&8&&(t=!0,c.show=f[3],Ze(()=>t=!1)),e.$set(c),f[0].length>0?o?(o.p(f,u),u&1&&b(o,1)):(o=wl(f),o.c(),b(o,1),o.m(s.parentNode,s)):o&&(ee(),D(o,1,1,()=>{o=null}),te())},i(f){n||(b(e.$$.fragment,f),b(o),n=!0)},o(f){D(e.$$.fragment,f),D(o),n=!1},d(f){f&&(m(l),m(s)),$(e,f),o&&o.d(f)}}}function $r(r){const e=r.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function xr(r){return r.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const ei=r=>{r.stopPropagation()};function ti(r,e,t){let l;const s=qe("i18n");Me(r,s,B=>t(6,l=B));let{sources:n=[]}=e,i=[],a=!1,o=!0,f=!1,u=null,c=!1;const d=B=>B.distances!==void 0,g=B=>B.distances!==void 0,v=B=>B.distances!==void 0;function M(B){f=B,t(3,f)}const p=B=>{t(3,f=!0),t(4,u=B)},N=B=>{t(3,f=!0),t(4,u=B)},w=B=>{t(3,f=!0),t(4,u=B)};function S(B){c=B,t(5,c)}return r.$$set=B=>{"sources"in B&&t(8,n=B.sources)},r.$$.update=()=>{r.$$.dirty&257&&(t(0,i=n.reduce((B,T)=>(Object.keys(T).length===0||T.document.forEach((V,R)=>{var ie,se;const O=(ie=T.metadata)==null?void 0:ie[R],E=(se=T.distances)==null?void 0:se[R],L=(O==null?void 0:O.source)??"N/A";let z=T==null?void 0:T.source;O!=null&&O.name&&(z={...z,name:O.name}),(L.startsWith("http://")||L.startsWith("https://"))&&(z={...z,name:L,url:L});const q=B.find(ne=>ne.id===L);q?(q.document.push(V),q.metadata.push(O),E!==void 0&&q.distances.push(E)):B.push({id:L,source:z,document:[V],metadata:O?[O]:[],distances:E!==void 0?[E]:void 0})}),B),[])),t(2,o=$r(i)),t(1,a=xr(i)))},[i,a,o,f,u,c,l,s,n,d,g,v,M,p,N,w,S]}class li extends Te{constructor(e){super(),Be(this,e,ti,Xr,De,{sources:8})}}function Vl(r,e,t){const l=r.slice();return l[6]=e[t],l}function Cl(r){let e,t,l,s;const n=[ri,ni,si],i=[];function a(o,f){var u,c;return(u=o[1].result)!=null&&u.error?0:(c=o[1].result)!=null&&c.output?1:2}return t=a(r),l=i[t]=n[t](r),{c(){e=y("div"),l.c()},l(o){e=I(o,"DIV",{});var f=k(e);l.l(f),f.forEach(m)},m(o,f){C(o,e,f),i[t].m(e,null),s=!0},p(o,f){let u=t;t=a(o),t!==u&&(ee(),D(i[u],1,1,()=>{i[u]=null}),te(),l=i[t],l||(l=i[t]=n[t](o),l.c()),b(l,1),l.m(e,null))},i(o){s||(b(l),s=!0)},o(o){D(l),s=!1},d(o){o&&m(e),i[t].d()}}}function si(r){let e,t;return e=new qt({props:{type:"warning",content:"incomplete"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function ni(r){let e,t;return e=new qt({props:{type:"success",content:"success"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function ri(r){let e,t;return e=new qt({props:{type:"error",content:"error"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Tl(r){let e,t,l;return t=new Pt({props:{className:"size-4"}}),{c(){e=y("div"),K(t.$$.fragment)},l(s){e=I(s,"DIV",{});var n=k(e);Q(t.$$.fragment,n),n.forEach(m)},m(s,n){C(s,e,n),X(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),$(t)}}}function ii(r){let e=r[2].t("Code execution")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&G(t,e)},d(l){l&&m(t)}}}function ai(r){var i;let e=r[2].t("Code execution")+"",t,l,s=((i=r[1])==null?void 0:i.name)+"",n;return{c(){t=U(e),l=U(": "),n=U(s)},l(a){t=W(a,e),l=W(a,": "),n=W(a,s)},m(a,o){C(a,t,o),C(a,l,o),C(a,n,o)},p(a,o){var f;o&4&&e!==(e=a[2].t("Code execution")+"")&&G(t,e),o&2&&s!==(s=((f=a[1])==null?void 0:f.name)+"")&&G(n,s)},d(a){a&&(m(t),m(l),m(n))}}}function Bl(r){var n,i,a,o;let e,t,l=((i=(n=r[1])==null?void 0:n.result)==null?void 0:i.error)&&Sl(r),s=((o=(a=r[1])==null?void 0:a.result)==null?void 0:o.output)&&Rl(r);return{c(){e=y("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=A(u),s&&s.l(u),u.forEach(m),this.h()},h(){h(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){C(f,e,u),l&&l.m(e,null),_(e,t),s&&s.m(e,null)},p(f,u){var c,d,g,v;(d=(c=f[1])==null?void 0:c.result)!=null&&d.error?l?l.p(f,u):(l=Sl(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(v=(g=f[1])==null?void 0:g.result)!=null&&v.output?s?s.p(f,u):(s=Rl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function Sl(r){var f,u;let e,t,l=r[2].t("ERROR")+"",s,n,i,a=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.error)+"",o;return{c(){e=y("div"),t=y("div"),s=U(l),n=j(),i=y("div"),o=U(a),this.h()},l(c){e=I(c,"DIV",{});var d=k(e);t=I(d,"DIV",{class:!0});var g=k(t);s=W(g,l),g.forEach(m),n=A(d),i=I(d,"DIV",{class:!0});var v=k(i);o=W(v,a),v.forEach(m),d.forEach(m),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,d){C(c,e,d),_(e,t),_(t,s),_(e,n),_(e,i),_(i,o)},p(c,d){var g,v;d&4&&l!==(l=c[2].t("ERROR")+"")&&G(s,l),d&2&&a!==(a=((v=(g=c[1])==null?void 0:g.result)==null?void 0:v.error)+"")&&G(o,a)},d(c){c&&m(e)}}}function Rl(r){var f,u;let e,t,l=r[2].t("OUTPUT")+"",s,n,i,a=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.output)+"",o;return{c(){e=y("div"),t=y("div"),s=U(l),n=j(),i=y("div"),o=U(a),this.h()},l(c){e=I(c,"DIV",{});var d=k(e);t=I(d,"DIV",{class:!0});var g=k(t);s=W(g,l),g.forEach(m),n=A(d),i=I(d,"DIV",{class:!0});var v=k(i);o=W(v,a),v.forEach(m),d.forEach(m),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,d){C(c,e,d),_(e,t),_(t,s),_(e,n),_(e,i),_(i,o)},p(c,d){var g,v;d&4&&l!==(l=c[2].t("OUTPUT")+"")&&G(s,l),d&2&&a!==(a=((v=(g=c[1])==null?void 0:g.result)==null?void 0:v.output)+"")&&G(o,a)},d(c){c&&m(e)}}}function Ol(r){var c,d;let e,t,l,s,n=r[2].t("Files")+"",i,a,o,f=ye((d=(c=r[1])==null?void 0:c.result)==null?void 0:d.files),u=[];for(let g=0;g<f.length;g+=1)u[g]=Hl(Vl(r,f,g));return{c(){e=y("div"),t=y("hr"),l=j(),s=y("div"),i=U(n),a=j(),o=y("ul");for(let g=0;g<u.length;g+=1)u[g].c();this.h()},l(g){e=I(g,"DIV",{class:!0});var v=k(e);t=I(v,"HR",{class:!0}),l=A(v),s=I(v,"DIV",{class:!0});var M=k(s);i=W(M,n),M.forEach(m),a=A(v),o=I(v,"UL",{class:!0});var p=k(o);for(let N=0;N<u.length;N+=1)u[N].l(p);p.forEach(m),v.forEach(m),this.h()},h(){h(t,"class","dark:border-gray-850 my-2"),h(s,"class","text-sm font-medium dark:text-gray-300"),h(o,"class","mt-1 list-disc pl-4 text-xs"),h(e,"class","flex flex-col w-full")},m(g,v){C(g,e,v),_(e,t),_(e,l),_(e,s),_(s,i),_(e,a),_(e,o);for(let M=0;M<u.length;M+=1)u[M]&&u[M].m(o,null)},p(g,v){var M,p;if(v&4&&n!==(n=g[2].t("Files")+"")&&G(i,n),v&2){f=ye((p=(M=g[1])==null?void 0:M.result)==null?void 0:p.files);let N;for(N=0;N<f.length;N+=1){const w=Vl(g,f,N);u[N]?u[N].p(w,v):(u[N]=Hl(w),u[N].c(),u[N].m(o,null))}for(;N<u.length;N+=1)u[N].d(1);u.length=f.length}},d(g){g&&m(e),Ue(u,g)}}}function Hl(r){let e,t,l=r[6].name+"",s,n,i;return{c(){e=y("li"),t=y("a"),s=U(l),i=j(),this.h()},l(a){e=I(a,"LI",{});var o=k(e);t=I(o,"A",{href:!0,target:!0});var f=k(t);s=W(f,l),f.forEach(m),i=A(o),o.forEach(m),this.h()},h(){h(t,"href",n=r[6].url),h(t,"target","_blank")},m(a,o){C(a,e,o),_(e,t),_(t,s),_(e,i)},p(a,o){o&2&&l!==(l=a[6].name+"")&&G(s,l),o&2&&n!==(n=a[6].url)&&h(t,"href",n)},d(a){a&&m(e)}}}function oi(r){var q,ie,se,ne,fe,F,le,ge,_e,H,x,he,ae,Y,P,Z,de,ue,we;let e,t,l,s,n,i,a,o,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,d,g,v,M,p,N,w,S,B,T=((q=r[1])==null?void 0:q.result)&&Cl(r),V=!((ie=r[1])!=null&&ie.result)&&Tl();function R(oe,re){var pe;return(pe=oe[1])!=null&&pe.name?ai:ii}let O=R(r),E=O(r);M=new zn({props:{id:"code-exec-"+((se=r[1])==null?void 0:se.id)+"-code",lang:((ne=r[1])==null?void 0:ne.language)??"",code:((fe=r[1])==null?void 0:fe.code)??"",className:"",editorClassName:(F=r[1])!=null&&F.result&&((ge=(le=r[1])==null?void 0:le.result)!=null&&ge.error||(H=(_e=r[1])==null?void 0:_e.result)!=null&&H.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let L=((x=r[1])==null?void 0:x.result)&&(((ae=(he=r[1])==null?void 0:he.result)==null?void 0:ae.error)||((P=(Y=r[1])==null?void 0:Y.result)==null?void 0:P.output))&&Bl(r),z=((de=(Z=r[1])==null?void 0:Z.result)==null?void 0:de.files)&&((we=(ue=r[1])==null?void 0:ue.result)==null?void 0:we.files.length)>0&&Ol(r);return{c(){e=y("div"),t=y("div"),l=y("div"),T&&T.c(),s=j(),n=y("div"),V&&V.c(),i=j(),a=y("div"),E.c(),o=j(),f=y("button"),f.innerHTML=u,c=j(),d=y("div"),g=y("div"),v=y("div"),K(M.$$.fragment),p=j(),L&&L.c(),N=j(),z&&z.c(),this.h()},l(oe){e=I(oe,"DIV",{});var re=k(e);t=I(re,"DIV",{class:!0});var pe=k(t);l=I(pe,"DIV",{class:!0});var Ve=k(l);T&&T.l(Ve),s=A(Ve),n=I(Ve,"DIV",{class:!0});var Pe=k(n);V&&V.l(Pe),i=A(Pe),a=I(Pe,"DIV",{});var Ce=k(a);E.l(Ce),Ce.forEach(m),Pe.forEach(m),Ve.forEach(m),o=A(pe),f=I(pe,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(f)!=="svelte-vnrwun"&&(f.innerHTML=u),pe.forEach(m),c=A(re),d=I(re,"DIV",{class:!0});var je=k(d);g=I(je,"DIV",{class:!0});var Ae=k(g);v=I(Ae,"DIV",{class:!0});var Je=k(v);Q(M.$$.fragment,Je),Je.forEach(m),p=A(Ae),L&&L.l(Ae),N=A(Ae),z&&z.l(Ae),Ae.forEach(m),je.forEach(m),re.forEach(m),this.h()},h(){h(n,"class","flex gap-2 items-center"),h(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),h(f,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(v,"class","flex flex-col w-full"),h(g,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(d,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(oe,re){C(oe,e,re),_(e,t),_(t,l),T&&T.m(l,null),_(l,s),_(l,n),V&&V.m(n,null),_(n,i),_(n,a),E.m(a,null),_(t,o),_(t,f),_(e,c),_(e,d),_(d,g),_(g,v),X(M,v,null),_(g,p),L&&L.m(g,null),_(g,N),z&&z.m(g,null),w=!0,S||(B=me(f,"click",r[4]),S=!0)},p(oe,re){var Ve,Pe,Ce,je,Ae,Je,$e,xe,rt,it,Qe,at,ot,et,wt,yt,It,Mt,Et;(Ve=oe[1])!=null&&Ve.result?T?(T.p(oe,re),re&2&&b(T,1)):(T=Cl(oe),T.c(),b(T,1),T.m(l,s)):T&&(ee(),D(T,1,1,()=>{T=null}),te()),(Pe=oe[1])!=null&&Pe.result?V&&(ee(),D(V,1,1,()=>{V=null}),te()):V?re&2&&b(V,1):(V=Tl(),V.c(),b(V,1),V.m(n,i)),O===(O=R(oe))&&E?E.p(oe,re):(E.d(1),E=O(oe),E&&(E.c(),E.m(a,null)));const pe={};re&2&&(pe.id="code-exec-"+((Ce=oe[1])==null?void 0:Ce.id)+"-code"),re&2&&(pe.lang=((je=oe[1])==null?void 0:je.language)??""),re&2&&(pe.code=((Ae=oe[1])==null?void 0:Ae.code)??""),re&2&&(pe.editorClassName=(Je=oe[1])!=null&&Je.result&&((xe=($e=oe[1])==null?void 0:$e.result)!=null&&xe.error||(it=(rt=oe[1])==null?void 0:rt.result)!=null&&it.output)?"rounded-b-none":""),M.$set(pe),(Qe=oe[1])!=null&&Qe.result&&((ot=(at=oe[1])==null?void 0:at.result)!=null&&ot.error||(wt=(et=oe[1])==null?void 0:et.result)!=null&&wt.output)?L?L.p(oe,re):(L=Bl(oe),L.c(),L.m(g,N)):L&&(L.d(1),L=null),(It=(yt=oe[1])==null?void 0:yt.result)!=null&&It.files&&((Et=(Mt=oe[1])==null?void 0:Mt.result)==null?void 0:Et.files.length)>0?z?z.p(oe,re):(z=Ol(oe),z.c(),z.m(g,null)):z&&(z.d(1),z=null)},i(oe){w||(b(T),b(V),b(M.$$.fragment,oe),w=!0)},o(oe){D(T),D(V),D(M.$$.fragment,oe),w=!1},d(oe){oe&&m(e),T&&T.d(),V&&V.d(),E.d(),$(M),L&&L.d(),z&&z.d(),S=!1,B()}}}function fi(r){let e,t,l;function s(i){r[5](i)}let n={size:"lg",$$slots:{default:[oi]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new _n({props:n}),ze.push(()=>Ke(e,"show",s)),{c(){K(e.$$.fragment)},l(i){Q(e.$$.fragment,i)},m(i,a){X(e,i,a),l=!0},p(i,[a]){const o={};a&519&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.show=i[0],Ze(()=>t=!1)),e.$set(o)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){$(e,i)}}}function ui(r,e,t){let l;const s=qe("i18n");Me(r,s,f=>t(2,l=f));let{show:n=!1}=e,{codeExecution:i=null}=e;const a=()=>{t(0,n=!1),t(1,i=null)};function o(f){n=f,t(0,n)}return r.$$set=f=>{"show"in f&&t(0,n=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[n,i,l,s,a,o]}class ci extends Te{constructor(e){super(),Be(this,e,ui,fi,De,{show:0,codeExecution:1})}}function Ll(r,e,t){const l=r.slice();return l[6]=e[t],l}function Pl(r){let e,t=[],l=new Map,s,n=ye(r[0]);const i=a=>a[6].id;for(let a=0;a<n.length;a+=1){let o=Ll(r,n,a),f=i(o);l.set(f,t[a]=jl(f,o))}return{c(){e=y("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);for(let f=0;f<t.length;f+=1)t[f].l(o);o.forEach(m),this.h()},h(){h(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(a,o){C(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(a,o){o&7&&(n=ye(a[0]),ee(),t=rn(t,o,i,1,a,n,l,e,an,jl,null,Ll),te())},i(a){if(!s){for(let o=0;o<n.length;o+=1)b(t[o]);s=!0}},o(a){for(let o=0;o<t.length;o+=1)D(t[o]);s=!1},d(a){a&&m(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function di(r){let e,t;return e=new Pt({props:{className:"size-4"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function hi(r){let e,t,l,s;const n=[_i,gi,mi],i=[];function a(o,f){var u,c;return(u=o[6].result)!=null&&u.error?0:(c=o[6].result)!=null&&c.output?1:2}return e=a(r),t=i[e]=n[e](r),{c(){t.c(),l=ce()},l(o){t.l(o),l=ce()},m(o,f){i[e].m(o,f),C(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e!==u&&(ee(),D(i[u],1,1,()=>{i[u]=null}),te(),t=i[e],t||(t=i[e]=n[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function mi(r){let e,t;return e=new Yn({}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function gi(r){let e,t;return e=new Fn({props:{strokeWidth:"3",className:"size-3"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function _i(r){let e,t;return e=new Gn({}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function jl(r,e){let t,l,s,n,i,a,o,f=e[6].name+"",u,c,d,g,v,M;const p=[hi,di],N=[];function w(B,T){var V;return(V=B[6])!=null&&V.result?0:1}n=w(e),i=N[n]=p[n](e);function S(){return e[4](e[6])}return{key:r,first:null,c(){t=y("div"),l=y("button"),s=y("div"),i.c(),a=j(),o=y("div"),u=U(f),d=j(),this.h()},l(B){t=I(B,"DIV",{class:!0});var T=k(t);l=I(T,"BUTTON",{class:!0});var V=k(l);s=I(V,"DIV",{class:!0});var R=k(s);i.l(R),R.forEach(m),a=A(V),o=I(V,"DIV",{class:!0});var O=k(o);u=W(O,f),O.forEach(m),V.forEach(m),d=A(T),T.forEach(m),this.h()},h(){var B;h(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),h(o,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((B=e[6])!=null&&B.result?"":"pulse")+" svelte-1gvtig2"),h(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),h(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(B,T){C(B,t,T),_(t,l),_(l,s),N[n].m(s,null),_(l,a),_(l,o),_(o,u),_(t,d),g=!0,v||(M=me(l,"click",S),v=!0)},p(B,T){var R;e=B;let V=n;n=w(e),n===V?N[n].p(e,T):(ee(),D(N[V],1,1,()=>{N[V]=null}),te(),i=N[n],i?i.p(e,T):(i=N[n]=p[n](e),i.c()),b(i,1),i.m(s,null)),(!g||T&1)&&f!==(f=e[6].name+"")&&G(u,f),(!g||T&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((R=e[6])!=null&&R.result?"":"pulse")+" svelte-1gvtig2"))&&h(o,"class",c)},i(B){g||(b(i),g=!0)},o(B){D(i),g=!1},d(B){B&&m(t),N[n].d(),v=!1,M()}}}function vi(r){let e,t,l,s,n;function i(f){r[3](f)}let a={codeExecution:r[1]};r[2]!==void 0&&(a.show=r[2]),e=new ci({props:a}),ze.push(()=>Ke(e,"show",i));let o=r[0].length>0&&Pl(r);return{c(){K(e.$$.fragment),l=j(),o&&o.c(),s=ce()},l(f){Q(e.$$.fragment,f),l=A(f),o&&o.l(f),s=ce()},m(f,u){X(e,f,u),C(f,l,u),o&&o.m(f,u),C(f,s,u),n=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Ze(()=>t=!1)),e.$set(c),f[0].length>0?o?(o.p(f,u),u&1&&b(o,1)):(o=Pl(f),o.c(),b(o,1),o.m(s.parentNode,s)):o&&(ee(),D(o,1,1,()=>{o=null}),te())},i(f){n||(b(e.$$.fragment,f),b(o),n=!0)},o(f){D(e.$$.fragment,f),D(o),n=!1},d(f){f&&(m(l),m(s)),$(e,f),o&&o.d(f)}}}function pi(r,e,t){let{codeExecutions:l=[]}=e,s=null,n=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function a(f){n=f,t(2,n)}const o=f=>{t(1,s=f),t(2,n=!0)};return r.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},r.$$.update=()=>{r.$$.dirty&1&&l&&i()},[l,s,n,a,o]}class bi extends Te{constructor(e){super(),Be(this,e,pi,vi,De,{codeExecutions:0})}}function ki(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function wi(r,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class yi extends Te{constructor(e){super(),Be(this,e,wi,ki,De,{className:0,strokeWidth:1})}}function Ii(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Mi(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Ei extends Te{constructor(e){super(),Be(this,e,Mi,Ii,De,{className:0,strokeWidth:1})}}function Ni(r){let e,t,l,s,n,i,a,o,f,u,c,d;s=new kt({props:{id:`${r[0]}-float-prompt`,content:r[4]}});const g=[Ci,Vi],v=[];function M(N,w){return w&32&&(o=null),o==null&&(o=N[5].trim()===""),o?0:1}f=M(r,-1),u=v[f]=g[f](r);let p=r[6]&&Al(r);return{c(){e=y("div"),t=y("div"),l=y("div"),K(s.$$.fragment),n=j(),i=y("div"),a=y("div"),u.c(),c=j(),p&&p.c(),this.h()},l(N){e=I(N,"DIV",{class:!0});var w=k(e);t=I(w,"DIV",{class:!0});var S=k(t);l=I(S,"DIV",{class:!0});var B=k(l);Q(s.$$.fragment,B),B.forEach(m),S.forEach(m),n=A(w),i=I(w,"DIV",{class:!0});var T=k(i);a=I(T,"DIV",{class:!0,id:!0});var V=k(a);u.l(V),c=A(V),p&&p.l(V),V.forEach(m),T.forEach(m),w.forEach(m),this.h()},h(){h(l,"class","font-medium"),h(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(a,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),h(a,"id","response-container"),h(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(N,w){C(N,e,w),_(e,t),_(t,l),X(s,l,null),_(e,n),_(e,i),_(i,a),v[f].m(a,null),_(a,c),p&&p.m(a,null),d=!0},p(N,w){const S={};w&1&&(S.id=`${N[0]}-float-prompt`),w&16&&(S.content=N[4]),s.$set(S);let B=f;f=M(N,w),f===B?v[f].p(N,w):(ee(),D(v[B],1,1,()=>{v[B]=null}),te(),u=v[f],u?u.p(N,w):(u=v[f]=g[f](N),u.c()),b(u,1),u.m(a,c)),N[6]?p?p.p(N,w):(p=Al(N),p.c(),p.m(a,null)):p&&(p.d(1),p=null)},i(N){d||(b(s.$$.fragment,N),b(u),d=!0)},o(N){D(s.$$.fragment,N),D(u),d=!1},d(N){N&&m(e),$(s),v[f].d(),p&&p.d()}}}function Di(r){let e,t,l,s;const n=[Bi,Ti],i=[];function a(o,f){return o[1]?1:0}return e=a(r),t=i[e]=n[e](r),{c(){t.c(),l=ce()},l(o){t.l(o),l=ce()},m(o,f){i[e].m(o,f),C(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(ee(),D(i[u],1,1,()=>{i[u]=null}),te(),t=i[e],t?t.p(o,f):(t=i[e]=n[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Vi(r){let e,t;return e=new kt({props:{id:`${r[0]}-float-response`,content:r[5]}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s&1&&(n.id=`${l[0]}-float-response`),s&32&&(n.content=l[5]),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Ci(r){let e,t;return e=new Jt({props:{size:"sm"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Al(r){let e,t,l=r[7].t("Add")+"",s,n,i;return{c(){e=y("div"),t=y("button"),s=U(l),this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);t=I(o,"BUTTON",{class:!0});var f=k(t);s=W(f,l),f.forEach(m),o.forEach(m),this.h()},h(){h(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(e,"class","flex justify-end pt-3 text-sm font-medium")},m(a,o){C(a,e,o),_(e,t),_(t,s),n||(i=me(t,"click",r[11]),n=!0)},p(a,o){o&128&&l!==(l=a[7].t("Add")+"")&&G(s,l)},d(a){a&&m(e),n=!1,i()}}}function Ti(r){let e,t,l,s,n,i,a,o,f,u,c;return{c(){e=y("div"),t=y("input"),s=j(),n=y("div"),i=y("button"),a=be("svg"),o=be("path"),this.h()},l(d){e=I(d,"DIV",{class:!0});var g=k(e);t=I(g,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=A(g),n=I(g,"DIV",{class:!0});var v=k(n);i=I(v,"BUTTON",{class:!0});var M=k(i);a=ke(M,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var p=k(a);o=ke(p,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(o).forEach(m),p.forEach(m),M.forEach(m),v.forEach(m),g.forEach(m),this.h()},h(){h(t,"type","text"),h(t,"id","floating-message-input"),h(t,"class","ml-5 bg-transparent outline-none w-full flex-1 text-sm"),h(t,"placeholder",l=r[7].t("Ask a question")),h(o,"fill-rule","evenodd"),h(o,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),h(o,"clip-rule","evenodd"),h(a,"xmlns","http://www.w3.org/2000/svg"),h(a,"viewBox","0 0 16 16"),h(a,"fill","currentColor"),h(a,"class","size-4"),h(i,"class",f=(r[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),h(n,"class","ml-1 mr-2"),h(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-800 w-72 rounded-full shadow-xl")},m(d,g){C(d,e,g),_(e,t),nt(t,r[3]),_(e,s),_(e,n),_(n,i),_(i,a),_(a,o),u||(c=[me(t,"input",r[18]),me(t,"keydown",r[19]),me(i,"click",r[20])],u=!0)},p(d,g){g&128&&l!==(l=d[7].t("Ask a question"))&&h(t,"placeholder",l),g&8&&t.value!==d[3]&&nt(t,d[3]),g&8&&f!==(f=(d[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&h(i,"class",f)},i:ve,o:ve,d(d){d&&m(e),u=!1,Xe(c)}}}function Bi(r){let e,t,l,s,n,i="Ask",a,o,f,u,c,d="Explain",g,v,M;return l=new yi({props:{className:"size-3 shrink-0"}}),f=new Ei({props:{className:"size-3 shrink-0"}}),{c(){e=y("div"),t=y("button"),K(l.$$.fragment),s=j(),n=y("div"),n.textContent=i,a=j(),o=y("button"),K(f.$$.fragment),u=j(),c=y("div"),c.textContent=d,this.h()},l(p){e=I(p,"DIV",{class:!0});var N=k(e);t=I(N,"BUTTON",{class:!0});var w=k(t);Q(l.$$.fragment,w),s=A(w),n=I(w,"DIV",{class:!0,"data-svelte-h":!0}),Oe(n)!=="svelte-1ugwo9q"&&(n.textContent=i),w.forEach(m),a=A(N),o=I(N,"BUTTON",{class:!0});var S=k(o);Q(f.$$.fragment,S),u=A(S),c=I(S,"DIV",{class:!0,"data-svelte-h":!0}),Oe(c)!=="svelte-1sxc82g"&&(c.textContent=d),S.forEach(m),N.forEach(m),this.h()},h(){h(n,"class","shrink-0"),h(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded flex items-center gap-1 min-w-fit"),h(c,"class","shrink-0"),h(o,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded flex items-center gap-1 min-w-fit"),h(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(p,N){C(p,e,N),_(e,t),X(l,t,null),_(t,s),_(t,n),_(e,a),_(e,o),X(f,o,null),_(o,u),_(o,c),g=!0,v||(M=[me(t,"click",r[16]),me(o,"click",r[17])],v=!0)},p:ve,i(p){g||(b(l.$$.fragment,p),b(f.$$.fragment,p),g=!0)},o(p){D(l.$$.fragment,p),D(f.$$.fragment,p),g=!1},d(p){p&&m(e),$(l),$(f),v=!1,Xe(M)}}}function Si(r){let e,t,l,s,n;const i=[Di,Ni],a=[];function o(f,u){return f[5]===null?0:1}return t=o(r),l=a[t]=i[t](r),{c(){e=y("div"),l.c(),this.h()},l(f){e=I(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(m),this.h()},h(){h(e,"id",s=`floating-buttons-${r[0]}`),h(e,"class","absolute rounded-lg mt-1 text-xs z-[9999]"),nn(e,"display","none")},m(f,u){C(f,e,u),a[t].m(e,null),n=!0},p(f,[u]){let c=t;t=o(f),t===c?a[t].p(f,u):(ee(),D(a[c],1,1,()=>{a[c]=null}),te(),l=a[t],l?l.p(f,u):(l=a[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!n||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&h(e,"id",s)},i(f){n||(b(l),n=!0)},o(f){D(l),n=!1},d(f){f&&m(e),a[t].d()}}}function Ri(r,e,t){let l;const s=qe("i18n");Me(r,s,E=>t(7,l=E));let{id:n=""}=e,{model:i=null}=e,{messages:a=[]}=e,{onAdd:o=()=>{}}=e,f=!1,u="",c="",d="",g=null,v=!1;const M=async()=>{const E=document.getElementById("response-container");E.scrollHeight-E.clientHeight<=E.scrollTop+50&&(E.scrollTop=E.scrollHeight)},p=async()=>{if(!i){Le.error("Model not selected");return}t(4,d=`${c}
\`\`\`
${u}
\`\`\``),t(3,c=""),t(5,g="");const[E,L]=await xt(localStorage.token,{model:i,messages:[...a,{role:"user",content:d}].map(z=>({role:z.role,content:z.content})),stream:!0});if(E&&E.ok){const z=E.body.getReader(),q=new TextDecoder;await(async()=>{var se,ne;for(;;){const{done:fe,value:F}=await z.read();if(fe)break;const ge=q.decode(F,{stream:!0}).split(`
`).filter(_e=>_e.trim()!=="");for(const _e of ge)if(_e.startsWith("data: "))if(_e.startsWith("data: [DONE]")){t(6,v=!0),await Ne(),M();continue}else try{const H=JSON.parse(_e.slice(6));H.choices&&((ne=(se=H.choices[0])==null?void 0:se.delta)!=null&&ne.content)&&(t(5,g+=H.choices[0].delta.content),M())}catch(H){console.error(H)}}})()}else Le.error("An error occurred while fetching the explanation")},N=async()=>{if(!i){Le.error("Model not selected");return}t(4,d=`Explain this section to me in more detail

\`\`\`
${u}
\`\`\``),t(5,g="");const[E,L]=await xt(localStorage.token,{model:i,messages:[...a,{role:"user",content:d}].map(z=>({role:z.role,content:z.content})),stream:!0});if(E&&E.ok){const z=E.body.getReader(),q=new TextDecoder;await(async()=>{var se,ne;for(;;){const{done:fe,value:F}=await z.read();if(fe)break;const ge=q.decode(F,{stream:!0}).split(`
`).filter(_e=>_e.trim()!=="");for(const _e of ge)if(_e.startsWith("data: "))if(_e.startsWith("data: [DONE]")){t(6,v=!0),await Ne(),M();continue}else try{const H=JSON.parse(_e.slice(6));H.choices&&((ne=(se=H.choices[0])==null?void 0:se.delta)!=null&&ne.content)&&(t(5,g+=H.choices[0].delta.content),M())}catch(H){console.error(H)}}})()}else Le.error("An error occurred while fetching the explanation")},w=async()=>{o({modelId:i,parentId:n,messages:[{role:"user",content:d},{role:"assistant",content:g}]})},S=()=>{t(5,g=null),t(6,v=!1),t(1,f=!1),t(3,c="")},B=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ne(),setTimeout(()=>{const E=document.getElementById("floating-message-input");E&&E.focus()},0)},T=()=>{t(2,u=window.getSelection().toString()),N()};function V(){c=this.value,t(3,c)}const R=E=>{E.key==="Enter"&&p()},O=()=>{p()};return r.$$set=E=>{"id"in E&&t(0,n=E.id),"model"in E&&t(12,i=E.model),"messages"in E&&t(13,a=E.messages),"onAdd"in E&&t(14,o=E.onAdd)},[n,f,u,c,d,g,v,l,s,p,N,w,i,a,o,S,B,T,V,R,O]}class Oi extends Te{constructor(e){super(),Be(this,e,Ri,Si,De,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function zl(r){var s;let e,t,l={id:r[0],model:(s=r[3])==null?void 0:s.id,messages:Ut(r[2],r[0]),onAdd:r[18]};return e=new Oi({props:l}),r[19](e),{c(){K(e.$$.fragment)},l(n){Q(e.$$.fragment,n)},m(n,i){X(e,n,i),t=!0},p(n,i){var o;const a={};i&1&&(a.id=n[0]),i&8&&(a.model=(o=n[3])==null?void 0:o.id),i&5&&(a.messages=Ut(n[2],n[0])),i&256&&(a.onAdd=n[18]),e.$set(a)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){r[19](null),$(e,n)}}}function Hi(r){let e,t,l,s,n;t=new kt({props:{id:r[0],content:r[1],model:r[3],save:r[5],sourceIds:(r[4]??[]).reduce(Ul,[]),onSourceClick:r[7]}}),t.$on("update",r[15]),t.$on("code",r[16]);let i=r[6]&&r[3]&&zl(r);return{c(){e=y("div"),K(t.$$.fragment),l=j(),i&&i.c(),s=ce()},l(a){e=I(a,"DIV",{});var o=k(e);Q(t.$$.fragment,o),o.forEach(m),l=A(a),i&&i.l(a),s=ce()},m(a,o){C(a,e,o),X(t,e,null),r[17](e),C(a,l,o),i&&i.m(a,o),C(a,s,o),n=!0},p(a,[o]){const f={};o&1&&(f.id=a[0]),o&2&&(f.content=a[1]),o&8&&(f.model=a[3]),o&32&&(f.save=a[5]),o&16&&(f.sourceIds=(a[4]??[]).reduce(Ul,[])),o&128&&(f.onSourceClick=a[7]),t.$set(f),a[6]&&a[3]?i?(i.p(a,o),o&72&&b(i,1)):(i=zl(a),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(ee(),D(i,1,1,()=>{i=null}),te())},i(a){n||(b(t.$$.fragment,a),b(i),n=!0)},o(a){D(t.$$.fragment,a),D(i),n=!1},d(a){a&&(m(e),m(l),m(s)),$(t),r[17](null),i&&i.d(a)}}}const Ul=(r,e)=>{let t=[];return e.document.forEach((l,s)=>{var a,o;const n=(a=e.metadata)==null?void 0:a[s],i=(n==null?void 0:n.source)??"N/A";return n!=null&&n.name?(t.push(n.name),t):(i.startsWith("http://")||i.startsWith("https://")?t.push(i):t.push(((o=e==null?void 0:e.source)==null?void 0:o.name)??i),t)}),r=[...r,...t],r.filter((l,s)=>r.indexOf(l)===s)};function Li(r,e,t){let l,s;Me(r,on,E=>t(11,l=E)),Me(r,Cn,E=>t(12,s=E)),qe("i18n");const n=ht();let{id:i}=e,{content:a}=e,{history:o}=e,{model:f=null}=e,{sources:u=null}=e,{save:c=!1}=e,{floatingButtons:d=!0}=e,{onSourceClick:g=()=>{}}=e,{onAddMessages:v=()=>{}}=e,M,p;const N=E=>{const L=document.getElementById(`floating-buttons-${i}`);if(!(M!=null&&M.contains(E.target))&&!(L!=null&&L.contains(E.target))){w();return}setTimeout(async()=>{if(await Ne(),!(M!=null&&M.contains(E.target)))return;let z=window.getSelection();if(z.toString().trim().length>0){const ie=z.getRangeAt(0).getBoundingClientRect(),se=M.getBoundingClientRect(),ne=ie.bottom-se.top,fe=ie.left-se.left;if(L){L.style.display="block";const F=se.width-fe;let le=l?window.innerWidth/2:window.innerWidth/3;if(F<le){const ge=se.right-ie.right;L.style.right=`${ge}px`,L.style.left="auto"}else L.style.left=`${fe}px`,L.style.right="auto";L.style.top=`${ne+5}px`}}else w()},0)},w=()=>{const E=document.getElementById(`floating-buttons-${i}`);E&&(E.style.display="none"),p&&p.closeHandler()},S=E=>{E.key==="Escape"&&w()};vt(()=>{d&&(M==null||M.addEventListener("mouseup",N),document.addEventListener("mouseup",N),document.addEventListener("keydown",S))}),Nn(()=>{d&&(M==null||M.removeEventListener("mouseup",N),document.removeEventListener("mouseup",N),document.removeEventListener("keydown",S))});const B=E=>{n("update",E.detail)},T=E=>{const{lang:L,code:z}=E.detail;(["html","svg"].includes(L)||L==="xml"&&z.includes("svg"))&&!l&&s&&(Tn.set(!0),Bn.set(!0))};function V(E){ze[E?"unshift":"push"](()=>{M=E,t(9,M)})}const R=({modelId:E,parentId:L,messages:z})=>{console.log(E,L,z),v({modelId:E,parentId:L,messages:z}),w()};function O(E){ze[E?"unshift":"push"](()=>{p=E,t(10,p)})}return r.$$set=E=>{"id"in E&&t(0,i=E.id),"content"in E&&t(1,a=E.content),"history"in E&&t(2,o=E.history),"model"in E&&t(3,f=E.model),"sources"in E&&t(4,u=E.sources),"save"in E&&t(5,c=E.save),"floatingButtons"in E&&t(6,d=E.floatingButtons),"onSourceClick"in E&&t(7,g=E.onSourceClick),"onAddMessages"in E&&t(8,v=E.onAddMessages)},[i,a,o,f,u,c,d,g,v,M,p,l,s,n,w,B,T,V,R,O]}class Pi extends Te{constructor(e){super(),Be(this,e,Li,Hi,De,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onAddMessages:8})}}function Wl(r,e,t){const l=r.slice();return l[70]=e[t],l}function jt(r){var l,s,n;const e=r.slice(),t=(((l=e[12])==null?void 0:l.statusHistory)??[...(s=e[12])!=null&&s.status?[(n=e[12])==null?void 0:n.status]:[]]).at(-1);return e[73]=t,e}function ql(r,e,t){const l=r.slice();return l[74]=e[t],l}function ji(r){var s;let e,t=(((s=r[14])==null?void 0:s.name)??r[12].model)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(n){e=I(n,"SPAN",{class:!0});var i=k(e);l=W(i,t),i.forEach(m),this.h()},h(){h(e,"class","line-clamp-1")},m(n,i){C(n,e,i),_(e,l)},p(n,i){var a;i[0]&20480&&t!==(t=(((a=n[14])==null?void 0:a.name)??n[12].model)+"")&&G(l,t)},d(n){n&&m(e)}}}function Jl(r){let e,t,l;return t=new Re({props:{content:_t(r[12].timestamp*1e3).format("dddd, DD MMMM YYYY HH:mm"),$$slots:{default:[Ai]},$$scope:{ctx:r}}}),{c(){e=y("div"),K(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Q(t.$$.fragment,n),n.forEach(m),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){C(s,e,n),X(t,e,null),l=!0},p(s,n){const i={};n[0]&4096&&(i.content=_t(s[12].timestamp*1e3).format("dddd, DD MMMM YYYY HH:mm")),n[0]&4096|n[2]&32768&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),$(t)}}}function Ai(r){let e,t=St(r[12].timestamp*1e3)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","line-clamp-1")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&4096&&t!==(t=St(s[12].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function zi(r){var i;let e,t,l,s;e=new Re({props:{content:((i=r[14])==null?void 0:i.name)??r[12].model,placement:"top-start",$$slots:{default:[ji]},$$scope:{ctx:r}}});let n=r[12].timestamp&&Jl(r);return{c(){K(e.$$.fragment),t=j(),n&&n.c(),l=ce()},l(a){Q(e.$$.fragment,a),t=A(a),n&&n.l(a),l=ce()},m(a,o){X(e,a,o),C(a,t,o),n&&n.m(a,o),C(a,l,o),s=!0},p(a,o){var u;const f={};o[0]&20480&&(f.content=((u=a[14])==null?void 0:u.name)??a[12].model),o[0]&20480|o[2]&32768&&(f.$$scope={dirty:o,ctx:a}),e.$set(f),a[12].timestamp?n?(n.p(a,o),o[0]&4096&&b(n,1)):(n=Jl(a),n.c(),b(n,1),n.m(l.parentNode,l)):n&&(ee(),D(n,1,1,()=>{n=null}),te())},i(a){s||(b(e.$$.fragment,a),b(n),s=!0)},o(a){D(e.$$.fragment,a),D(n),s=!1},d(a){a&&(m(t),m(l)),$(e,a),n&&n.d(a)}}}function Fl(r){let e,t,l=ye(r[12].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Yl(ql(r,l,i));const n=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){h(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,a){C(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&4096){l=ye(i[12].files);let o;for(o=0;o<l.length;o+=1){const f=ql(i,l,o);s[o]?(s[o].p(f,a),b(s[o],1)):(s[o]=Yl(f),s[o].c(),b(s[o],1),s[o].m(e,null))}for(ee(),o=l.length;o<s.length;o+=1)n(o);te()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&m(e),Ue(s,i)}}}function Gl(r){let e,t;return e=new dn({props:{src:r[74].url,alt:r[12].content}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.src=l[74].url),s[0]&4096&&(n.alt=l[12].content),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Yl(r){let e,t,l,s=r[74].type==="image"&&Gl(r);return{c(){e=y("div"),s&&s.c(),t=j()},l(n){e=I(n,"DIV",{});var i=k(e);s&&s.l(i),t=A(i),i.forEach(m)},m(n,i){C(n,e,i),s&&s.m(e,null),_(e,t),l=!0},p(n,i){n[74].type==="image"?s?(s.p(n,i),i[0]&4096&&b(s,1)):(s=Gl(n),s.c(),b(s,1),s.m(e,t)):s&&(ee(),D(s,1,1,()=>{s=null}),te())},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&m(e),s&&s.d()}}}function Zl(r){var s;let e,t,l=!((s=r[73])!=null&&s.hidden)&&Kl(r);return{c(){l&&l.c(),e=ce()},l(n){l&&l.l(n),e=ce()},m(n,i){l&&l.m(n,i),C(n,e,i),t=!0},p(n,i){var a;(a=n[73])!=null&&a.hidden?l&&(ee(),D(l,1,1,()=>{l=null}),te()):l?(l.p(n,i),i[0]&4096&&b(l,1)):(l=Kl(n),l.c(),b(l,1),l.m(e.parentNode,e))},i(n){t||(b(l),t=!0)},o(n){D(l),t=!1},d(n){n&&m(e),l&&l.d(n)}}}function Kl(r){var u;let e,t,l,s,n,i=((u=r[73])==null?void 0:u.done)===!1&&Ql();const a=[qi,Wi,Ui],o=[];function f(c,d){var g,v,M;return((g=c[73])==null?void 0:g.action)==="web_search"&&((v=c[73])!=null&&v.urls)?0:((M=c[73])==null?void 0:M.action)==="knowledge_search"?1:2}return l=f(r),s=o[l]=a[l](r),{c(){e=y("div"),i&&i.c(),t=j(),s.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var d=k(e);i&&i.l(d),t=A(d),s.l(d),d.forEach(m),this.h()},h(){h(e,"class","status-description flex items-center gap-2 py-0.5")},m(c,d){C(c,e,d),i&&i.m(e,null),_(e,t),o[l].m(e,null),n=!0},p(c,d){var v;((v=c[73])==null?void 0:v.done)===!1?i?d[0]&4096&&b(i,1):(i=Ql(),i.c(),b(i,1),i.m(e,t)):i&&(ee(),D(i,1,1,()=>{i=null}),te());let g=l;l=f(c),l===g?o[l].p(c,d):(ee(),D(o[g],1,1,()=>{o[g]=null}),te(),s=o[l],s?s.p(c,d):(s=o[l]=a[l](c),s.c()),b(s,1),s.m(e,null))},i(c){n||(b(i),b(s),n=!0)},o(c){D(i),D(s),n=!1},d(c){c&&m(e),i&&i.d(),o[l].d()}}}function Ql(r){let e,t,l;return t=new Pt({props:{className:"size-4"}}),{c(){e=y("div"),K(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Q(t.$$.fragment,n),n.forEach(m),this.h()},h(){h(e,"class","")},m(s,n){C(s,e,n),X(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),$(t)}}}function Ui(r){let e,t,l,s;function n(o,f){var u,c,d;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[73])!=null&&u.description.includes("{{searchQuery}}"))),l?Yi:((c=o[73])==null?void 0:c.description)==="No search query generated"?Gi:((d=o[73])==null?void 0:d.description)==="Generating search query"?Fi:Ji}let i=n(r,[-1,-1,-1]),a=i(r);return{c(){e=y("div"),t=y("div"),a.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);t=I(f,"DIV",{class:!0});var u=k(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;h(t,"class",s=(((o=r[73])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){C(o,e,f),_(e,t),a.m(t,null)},p(o,f){var u;i===(i=n(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[73])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",s)},i:ve,o:ve,d(o){o&&m(e),a.d()}}}function Wi(r){let e,t,l=r[24].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:r[73].query})+"",s,n;return{c(){e=y("div"),t=y("div"),s=U(l),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);t=I(a,"DIV",{class:!0});var o=k(t);s=W(o,l),o.forEach(m),a.forEach(m),this.h()},h(){var i;h(t,"class",n=(((i=r[73])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,a){C(i,e,a),_(e,t),_(t,s)},p(i,a){var o;a[0]&16781312&&l!==(l=i[24].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[73].query})+"")&&G(s,l),a[0]&4096&&n!==(n=(((o=i[73])==null?void 0:o.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",n)},i:ve,o:ve,d(i){i&&m(e)}}}function qi(r){let e,t;return e=new Ir({props:{status:r[73],$$slots:{default:[$i]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.status=l[73]),s[0]&16781312|s[2]&32768&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Ji(r){var l;let e=((l=r[73])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n[0]&4096&&e!==(e=((i=s[73])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function Fi(r){let e=r[24].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function Gi(r){let e=r[24].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function Yi(r){var l,s;let e=r[24].t((l=r[73])==null?void 0:l.description,{searchQuery:(s=r[73])==null?void 0:s.query})+"",t;return{c(){t=U(e)},l(n){t=W(n,e)},m(n,i){C(n,t,i)},p(n,i){var a,o;i[0]&16781312&&e!==(e=n[24].t((a=n[73])==null?void 0:a.description,{searchQuery:(o=n[73])==null?void 0:o.query})+"")&&G(t,e)},d(n){n&&m(t)}}}function Zi(r){var l;let e=((l=r[73])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n[0]&4096&&e!==(e=((i=s[73])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function Ki(r){let e=r[24].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function Qi(r){let e=r[24].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&16777216&&e!==(e=l[24].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function Xi(r){var l,s;let e=r[24].t((l=r[73])==null?void 0:l.description,{count:(s=r[73])==null?void 0:s.urls.length})+"",t;return{c(){t=U(e)},l(n){t=W(n,e)},m(n,i){C(n,t,i)},p(n,i){var a,o;i[0]&16781312&&e!==(e=n[24].t((a=n[73])==null?void 0:a.description,{count:(o=n[73])==null?void 0:o.urls.length})+"")&&G(t,e)},d(n){n&&m(t)}}}function $i(r){let e,t,l,s;function n(o,f){var u,c,d;return f[0]&4096&&(l=null),l==null&&(l=!!((u=o[73])!=null&&u.description.includes("{{count}}"))),l?Xi:((c=o[73])==null?void 0:c.description)==="No search query generated"?Qi:((d=o[73])==null?void 0:d.description)==="Generating search query"?Ki:Zi}let i=n(r,[-1,-1,-1]),a=i(r);return{c(){e=y("div"),t=y("div"),a.c(),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);t=I(f,"DIV",{class:!0});var u=k(t);a.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var o;h(t,"class",s=(((o=r[73])==null?void 0:o.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(o,f){C(o,e,f),_(e,t),a.m(t,null)},p(o,f){var u;i===(i=n(o,f))&&a?a.p(o,f):(a.d(1),a=i(o),a&&(a.c(),a.m(t,null))),f[0]&4096&&s!==(s=(((u=o[73])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&h(t,"class",s)},d(o){o&&m(e),a.d()}}}function xi(r){var v,M,p,N,w,S,B;let e,t,l,s,n,i,a;const o=[la,ta],f=[];function u(T,V){return T[12].content===""&&!T[12].error?0:T[12].content&&T[12].error!==!0?1:-1}~(t=u(r))&&(l=f[t]=o[t](r));let c=((v=r[12])==null?void 0:v.error)&&Xl(r),d=(((M=r[12])==null?void 0:M.sources)||((p=r[12])==null?void 0:p.citations))&&(((B=(S=(w=(N=r[14])==null?void 0:N.info)==null?void 0:w.meta)==null?void 0:S.capabilities)==null?void 0:B.citations)??!0)&&$l(r),g=r[12].code_executions&&xl(r);return{c(){e=y("div"),l&&l.c(),s=j(),c&&c.c(),n=j(),d&&d.c(),i=j(),g&&g.c(),this.h()},l(T){e=I(T,"DIV",{class:!0,id:!0});var V=k(e);l&&l.l(V),s=A(V),c&&c.l(V),n=A(V),d&&d.l(V),i=A(V),g&&g.l(V),V.forEach(m),this.h()},h(){h(e,"class","w-full flex flex-col relative"),h(e,"id","response-content-container")},m(T,V){C(T,e,V),~t&&f[t].m(e,null),_(e,s),c&&c.m(e,null),_(e,n),d&&d.m(e,null),_(e,i),g&&g.m(e,null),a=!0},p(T,V){var O,E,L,z,q,ie,se;let R=t;t=u(T),t===R?~t&&f[t].p(T,V):(l&&(ee(),D(f[R],1,1,()=>{f[R]=null}),te()),~t?(l=f[t],l?l.p(T,V):(l=f[t]=o[t](T),l.c()),b(l,1),l.m(e,s)):l=null),(O=T[12])!=null&&O.error?c?(c.p(T,V),V[0]&4096&&b(c,1)):(c=Xl(T),c.c(),b(c,1),c.m(e,n)):c&&(ee(),D(c,1,1,()=>{c=null}),te()),((E=T[12])!=null&&E.sources||(L=T[12])!=null&&L.citations)&&(((se=(ie=(q=(z=T[14])==null?void 0:z.info)==null?void 0:q.meta)==null?void 0:ie.capabilities)==null?void 0:se.citations)??!0)?d?(d.p(T,V),V[0]&20480&&b(d,1)):(d=$l(T),d.c(),b(d,1),d.m(e,i)):d&&(ee(),D(d,1,1,()=>{d=null}),te()),T[12].code_executions?g?(g.p(T,V),V[0]&4096&&b(g,1)):(g=xl(T),g.c(),b(g,1),g.m(e,null)):g&&(ee(),D(g,1,1,()=>{g=null}),te())},i(T){a||(b(l),b(c),b(d),b(g),a=!0)},o(T){D(l),D(c),D(d),D(g),a=!1},d(T){T&&m(e),~t&&f[t].d(),c&&c.d(),d&&d.d(),g&&g.d()}}}function ea(r){let e,t,l,s,n,i,a,o=r[24].t("Save As Copy")+"",f,u,c,d,g=r[24].t("Cancel")+"",v,M,p,N=r[24].t("Save")+"",w,S,B;return{c(){e=y("div"),t=y("textarea"),s=j(),n=y("div"),i=y("div"),a=y("button"),f=U(o),u=j(),c=y("div"),d=y("button"),v=U(g),M=j(),p=y("button"),w=U(N),this.h()},l(T){e=I(T,"DIV",{class:!0});var V=k(e);t=I(V,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(m),s=A(V),n=I(V,"DIV",{class:!0});var R=k(n);i=I(R,"DIV",{});var O=k(i);a=I(O,"BUTTON",{id:!0,class:!0});var E=k(a);f=W(E,o),E.forEach(m),O.forEach(m),u=A(R),c=I(R,"DIV",{class:!0});var L=k(c);d=I(L,"BUTTON",{id:!0,class:!0});var z=k(d);v=W(z,g),z.forEach(m),M=A(L),p=I(L,"BUTTON",{id:!0,class:!0});var q=k(p);w=W(q,N),q.forEach(m),L.forEach(m),R.forEach(m),V.forEach(m),this.h()},h(){h(t,"id",l="message-edit-"+r[12].id),h(t,"class","bg-transparent outline-none w-full resize-none"),h(a,"id","save-new-message-button"),h(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(d,"id","close-edit-message-button"),h(d,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(p,"id","confirm-edit-message-button"),h(p,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(c,"class","flex space-x-1.5"),h(n,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(T,V){C(T,e,V),_(e,t),r[42](t),nt(t,r[15]),_(e,s),_(e,n),_(n,i),_(i,a),_(a,f),_(n,u),_(n,c),_(c,d),_(d,v),_(c,M),_(c,p),_(p,w),S||(B=[me(t,"input",r[43]),me(t,"input",wa),me(t,"keydown",r[44]),me(a,"click",r[45]),me(d,"click",r[46]),me(p,"click",r[47])],S=!0)},p(T,V){V[0]&4096&&l!==(l="message-edit-"+T[12].id)&&h(t,"id",l),V[0]&32768&&nt(t,T[15]),V[0]&16777216&&o!==(o=T[24].t("Save As Copy")+"")&&G(f,o),V[0]&16777216&&g!==(g=T[24].t("Cancel")+"")&&G(v,g),V[0]&16777216&&N!==(N=T[24].t("Save")+"")&&G(w,N)},i:ve,o:ve,d(T){T&&m(e),r[42](null),S=!1,Xe(B)}}}function ta(r){var l;let e,t;return e=new Pi({props:{id:r[12].id,history:r[0],content:r[12].content,sources:r[12].sources,floatingButtons:(l=r[12])==null?void 0:l.done,save:!r[11],model:r[14],onSourceClick:r[48],onAddMessages:r[49]}}),e.$on("update",r[50]),e.$on("select",r[51]),{c(){K(e.$$.fragment)},l(s){Q(e.$$.fragment,s)},m(s,n){X(e,s,n),t=!0},p(s,n){var a;const i={};n[0]&4096&&(i.id=s[12].id),n[0]&1&&(i.history=s[0]),n[0]&4096&&(i.content=s[12].content),n[0]&4096&&(i.sources=s[12].sources),n[0]&4096&&(i.floatingButtons=(a=s[12])==null?void 0:a.done),n[0]&2048&&(i.save=!s[11]),n[0]&16384&&(i.model=s[14]),n[0]&512&&(i.onAddMessages=s[49]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){$(e,s)}}}function la(r){let e,t;return e=new Jt({}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Xl(r){var l,s;let e,t;return e=new Cr({props:{content:((s=(l=r[12])==null?void 0:l.error)==null?void 0:s.content)??r[12].content}}),{c(){K(e.$$.fragment)},l(n){Q(e.$$.fragment,n)},m(n,i){X(e,n,i),t=!0},p(n,i){var o,f;const a={};i[0]&4096&&(a.content=((f=(o=n[12])==null?void 0:o.error)==null?void 0:f.content)??n[12].content),e.$set(a)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){$(e,n)}}}function $l(r){var l,s;let e,t;return e=new li({props:{sources:((l=r[12])==null?void 0:l.sources)??((s=r[12])==null?void 0:s.citations)}}),{c(){K(e.$$.fragment)},l(n){Q(e.$$.fragment,n)},m(n,i){X(e,n,i),t=!0},p(n,i){var o,f;const a={};i[0]&4096&&(a.sources=((o=n[12])==null?void 0:o.sources)??((f=n[12])==null?void 0:f.citations)),e.$set(a)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){$(e,n)}}}function xl(r){let e,t;return e=new bi({props:{codeExecutions:r[12].code_executions}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.codeExecutions=l[12].code_executions),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function es(r){let e,t,l,s=(r[12].done||r[1].length>1)&&ts(r),n=r[12].done&&r[20]&&hs(r);return{c(){s&&s.c(),e=j(),n&&n.c(),t=ce()},l(i){s&&s.l(i),e=A(i),n&&n.l(i),t=ce()},m(i,a){s&&s.m(i,a),C(i,e,a),n&&n.m(i,a),C(i,t,a),l=!0},p(i,a){i[12].done||i[1].length>1?s?(s.p(i,a),a[0]&4098&&b(s,1)):(s=ts(i),s.c(),b(s,1),s.m(e.parentNode,e)):s&&(ee(),D(s,1,1,()=>{s=null}),te()),i[12].done&&i[20]?n?(n.p(i,a),a[0]&1052672&&b(n,1)):(n=hs(i),n.c(),b(n,1),n.m(t.parentNode,t)):n&&(ee(),D(n,1,1,()=>{n=null}),te())},i(i){l||(b(s),b(n),l=!0)},o(i){D(s),D(n),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),n&&n.d(i)}}}function ts(r){let e,t,l,s=r[1].length>1&&ls(r),n=r[12].done&&ss(r);return{c(){e=y("div"),s&&s.c(),t=j(),n&&n.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);s&&s.l(a),t=A(a),n&&n.l(a),a.forEach(m),this.h()},h(){h(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(i,a){C(i,e,a),s&&s.m(e,null),_(e,t),n&&n.m(e,null),l=!0},p(i,a){i[1].length>1?s?s.p(i,a):(s=ls(i),s.c(),s.m(e,t)):s&&(s.d(1),s=null),i[12].done?n?(n.p(i,a),a[0]&4096&&b(n,1)):(n=ss(i),n.c(),b(n,1),n.m(e,null)):n&&(ee(),D(n,1,1,()=>{n=null}),te())},i(i){l||(b(n),l=!0)},o(i){D(n),l=!1},d(i){i&&m(e),s&&s.d(),n&&n.d()}}}function ls(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[12].id)+1+"",a,o,f=r[1].length+"",u,c,d,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',v,M;return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),n=y("div"),a=U(i),o=U("/"),u=U(f),c=j(),d=y("button"),d.innerHTML=g,this.h()},l(p){e=I(p,"DIV",{class:!0,dir:!0});var N=k(e);t=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=A(N),n=I(N,"DIV",{class:!0});var w=k(n);a=W(w,i),o=W(w,"/"),u=W(w,f),w.forEach(m),c=A(N),d=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(d)!=="svelte-107ksnk"&&(d.innerHTML=g),N.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"),h(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center min-w-fit"),h(e,"dir","ltr")},m(p,N){C(p,e,N),_(e,t),_(e,s),_(e,n),_(n,a),_(n,o),_(n,u),_(e,c),_(e,d),v||(M=[me(t,"click",r[52]),me(d,"click",r[53])],v=!0)},p(p,N){N[0]&4098&&i!==(i=p[1].indexOf(p[12].id)+1+"")&&G(a,i),N[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&m(e),v=!1,Xe(M)}}}function ss(r){var v,M,p,N;let e,t,l,s,n,i,a,o,f,u=!r[11]&&ns(r);t=new Re({props:{content:r[24].t("Copy"),placement:"bottom",$$slots:{default:[na]},$$scope:{ctx:r}}}),s=new Re({props:{content:r[24].t("Read Aloud"),placement:"bottom",$$slots:{default:[oa]},$$scope:{ctx:r}}});let c=((v=r[23])==null?void 0:v.features.enable_image_generation)&&(r[25].role==="admin"||((N=(p=(M=r[25])==null?void 0:M.permissions)==null?void 0:p.features)==null?void 0:N.image_generation))&&!r[11]&&is(r),d=r[12].usage&&as(r),g=!r[11]&&os(r);return{c(){u&&u.c(),e=j(),K(t.$$.fragment),l=j(),K(s.$$.fragment),n=j(),c&&c.c(),i=j(),d&&d.c(),a=j(),g&&g.c(),o=ce()},l(w){u&&u.l(w),e=A(w),Q(t.$$.fragment,w),l=A(w),Q(s.$$.fragment,w),n=A(w),c&&c.l(w),i=A(w),d&&d.l(w),a=A(w),g&&g.l(w),o=ce()},m(w,S){u&&u.m(w,S),C(w,e,S),X(t,w,S),C(w,l,S),X(s,w,S),C(w,n,S),c&&c.m(w,S),C(w,i,S),d&&d.m(w,S),C(w,a,S),g&&g.m(w,S),C(w,o,S),f=!0},p(w,S){var V,R,O,E;w[11]?u&&(ee(),D(u,1,1,()=>{u=null}),te()):u?(u.p(w,S),S[0]&2048&&b(u,1)):(u=ns(w),u.c(),b(u,1),u.m(e.parentNode,e));const B={};S[0]&16777216&&(B.content=w[24].t("Copy")),S[0]&5120|S[2]&32768&&(B.$$scope={dirty:S,ctx:w}),t.$set(B);const T={};S[0]&16777216&&(T.content=w[24].t("Read Aloud")),S[0]&398336|S[2]&32768&&(T.$$scope={dirty:S,ctx:w}),s.$set(T),(V=w[23])!=null&&V.features.enable_image_generation&&(w[25].role==="admin"||(E=(O=(R=w[25])==null?void 0:R.permissions)==null?void 0:O.features)!=null&&E.image_generation)&&!w[11]?c?(c.p(w,S),S[0]&41945088&&b(c,1)):(c=is(w),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(ee(),D(c,1,1,()=>{c=null}),te()),w[12].usage?d?(d.p(w,S),S[0]&4096&&b(d,1)):(d=as(w),d.c(),b(d,1),d.m(a.parentNode,a)):d&&(ee(),D(d,1,1,()=>{d=null}),te()),w[11]?g&&(ee(),D(g,1,1,()=>{g=null}),te()):g?(g.p(w,S),S[0]&2048&&b(g,1)):(g=os(w),g.c(),b(g,1),g.m(o.parentNode,o))},i(w){f||(b(u),b(t.$$.fragment,w),b(s.$$.fragment,w),b(c),b(d),b(g),f=!0)},o(w){D(u),D(t.$$.fragment,w),D(s.$$.fragment,w),D(c),D(d),D(g),f=!1},d(w){w&&(m(e),m(l),m(n),m(i),m(a),m(o)),u&&u.d(w),$(t,w),$(s,w),c&&c.d(w),d&&d.d(w),g&&g.d(w)}}}function ns(r){var s,n,i;let e,t,l=(r[25].role==="user"?((i=(n=(s=r[25])==null?void 0:s.permissions)==null?void 0:n.chat)==null?void 0:i.edit)??!0:!0)&&rs(r);return{c(){l&&l.c(),e=ce()},l(a){l&&l.l(a),e=ce()},m(a,o){l&&l.m(a,o),C(a,e,o),t=!0},p(a,o){var f,u,c;a[25].role!=="user"||(((c=(u=(f=a[25])==null?void 0:f.permissions)==null?void 0:u.chat)==null?void 0:c.edit)??!0)?l?(l.p(a,o),o[0]&33554432&&b(l,1)):(l=rs(a),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),D(l,1,1,()=>{l=null}),te())},i(a){t||(b(l),t=!0)},o(a){D(l),t=!1},d(a){a&&m(e),l&&l.d(a)}}}function rs(r){let e,t;return e=new Re({props:{content:r[24].t("Edit"),placement:"bottom",$$slots:{default:[sa]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&16777216&&(n.content=l[24].t("Edit")),s[0]&1024|s[2]&32768&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function sa(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[54]),n=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",s)},d(a){a&&m(e),n=!1,i()}}}function na(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[55]),n=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&h(e,"class",s)},d(a){a&&m(e),n=!1,i()}}}function ra(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&m(e)}}}function ia(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&m(e)}}}function aa(r){let e,t,l,s,n,i;return{c(){e=be("svg"),t=be("style"),l=U(`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),s=be("circle"),n=be("circle"),i=be("circle"),this.h()},l(a){e=ke(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=k(e);t=ke(o,"style",{});var f=k(t);l=W(f,`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),f.forEach(m),s=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),n=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(n).forEach(m),i=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),o.forEach(m),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(n,"class","spinner_S1WN spinner_Km9P"),h(n,"cx","12"),h(n,"cy","12"),h(n,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){C(a,e,o),_(e,t),_(t,l),_(e,s),_(e,n),_(e,i)},d(a){a&&m(e)}}}function oa(r){let e,t,l,s,n;function i(f,u){return f[18]?aa:f[17]?ia:ra}let a=i(r),o=a(r);return{c(){e=y("button"),o.c(),this.h()},l(f){e=I(f,"BUTTON",{id:!0,class:!0});var u=k(e);o.l(u),u.forEach(m),this.h()},h(){h(e,"id",t="speak-button-"+r[12].id),h(e,"class",l=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){C(f,e,u),o.m(e,null),s||(n=me(e,"click",r[56]),s=!0)},p(f,u){a!==(a=i(f))&&(o.d(1),o=a(f),o&&(o.c(),o.m(e,null))),u[0]&4096&&t!==(t="speak-button-"+f[12].id)&&h(e,"id",t),u[0]&1024&&l!==(l=(f[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",l)},d(f){f&&m(e),o.d(),s=!1,n()}}}function is(r){let e,t;return e=new Re({props:{content:r[24].t("Generate Image"),placement:"bottom",$$slots:{default:[ca]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&16777216&&(n.content=l[24].t("Generate Image")),s[0]&529408|s[2]&32768&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function fa(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&m(e)}}}function ua(r){let e,t,l,s,n,i;return{c(){e=be("svg"),t=be("style"),l=U(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=be("circle"),n=be("circle"),i=be("circle"),this.h()},l(a){e=ke(a,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var o=k(e);t=ke(o,"style",{});var f=k(t);l=W(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),n=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(n).forEach(m),i=ke(o,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),o.forEach(m),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(n,"class","spinner_S1WN spinner_Km9P"),h(n,"cx","12"),h(n,"cy","12"),h(n,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(a,o){C(a,e,o),_(e,t),_(t,l),_(e,s),_(e,n),_(e,i)},d(a){a&&m(e)}}}function ca(r){let e,t,l,s;function n(o,f){return o[19]?ua:fa}let i=n(r),a=i(r);return{c(){e=y("button"),a.c(),this.h()},l(o){e=I(o,"BUTTON",{class:!0});var f=k(e);a.l(f),f.forEach(m),this.h()},h(){h(e,"class",t=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,f){C(o,e,f),a.m(e,null),l||(s=me(e,"click",r[57]),l=!0)},p(o,f){i!==(i=n(o))&&(a.d(1),a=i(o),a&&(a.c(),a.m(e,null))),f[0]&1024&&t!==(t=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",t)},d(o){o&&m(e),a.d(),l=!1,s()}}}function as(r){let e,t;return e=new Re({props:{content:r[12].usage?`<pre>${gt(JSON.stringify(r[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(_s).map(vs).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[da]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.content=l[12].usage?`<pre>${gt(JSON.stringify(l[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(_s).map(vs).join(`
`))}</pre>`:""),s[0]&5120|s[2]&32768&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function da(r){let e,t,l,s,n,i,a;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(o){e=I(o,"BUTTON",{class:!0,id:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),h(e,"id",n="info-"+r[12].id)},m(o,f){C(o,e,f),_(e,t),_(t,l),i||(a=me(e,"click",r[58]),i=!0)},p(o,f){f[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&h(e,"class",s),f[0]&4096&&n!==(n="info-"+o[12].id)&&h(e,"id",n)},d(o){o&&m(e),i=!1,a()}}}function os(r){var u;let e,t,l,s,n,i,a=(((u=r[23])==null?void 0:u.features.enable_message_rating)??!0)&&fs(r),o=r[10]&&us(r);l=new Re({props:{content:r[24].t("Regenerate"),placement:"bottom",$$slots:{default:[_a]},$$scope:{ctx:r}}});let f=r[10]&&cs(r);return{c(){a&&a.c(),e=j(),o&&o.c(),t=j(),K(l.$$.fragment),s=j(),f&&f.c(),n=ce()},l(c){a&&a.l(c),e=A(c),o&&o.l(c),t=A(c),Q(l.$$.fragment,c),s=A(c),f&&f.l(c),n=ce()},m(c,d){a&&a.m(c,d),C(c,e,d),o&&o.m(c,d),C(c,t,d),X(l,c,d),C(c,s,d),f&&f.m(c,d),C(c,n,d),i=!0},p(c,d){var v;((v=c[23])==null?void 0:v.features.enable_message_rating)??!0?a?(a.p(c,d),d[0]&8388608&&b(a,1)):(a=fs(c),a.c(),b(a,1),a.m(e.parentNode,e)):a&&(ee(),D(a,1,1,()=>{a=null}),te()),c[10]?o?(o.p(c,d),d[0]&1024&&b(o,1)):(o=us(c),o.c(),b(o,1),o.m(t.parentNode,t)):o&&(ee(),D(o,1,1,()=>{o=null}),te());const g={};d[0]&16777216&&(g.content=c[24].t("Regenerate")),d[0]&1070336|d[2]&32768&&(g.$$scope={dirty:d,ctx:c}),l.$set(g),c[10]?f?(f.p(c,d),d[0]&1024&&b(f,1)):(f=cs(c),f.c(),b(f,1),f.m(n.parentNode,n)):f&&(ee(),D(f,1,1,()=>{f=null}),te())},i(c){i||(b(a),b(o),b(l.$$.fragment,c),b(f),i=!0)},o(c){D(a),D(o),D(l.$$.fragment,c),D(f),i=!1},d(c){c&&(m(e),m(t),m(s),m(n)),a&&a.d(c),o&&o.d(c),$(l,c),f&&f.d(c)}}}function fs(r){let e,t,l,s;return e=new Re({props:{content:r[24].t("Good Response"),placement:"bottom",$$slots:{default:[ha]},$$scope:{ctx:r}}}),l=new Re({props:{content:r[24].t("Bad Response"),placement:"bottom",$$slots:{default:[ma]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment),t=j(),K(l.$$.fragment)},l(n){Q(e.$$.fragment,n),t=A(n),Q(l.$$.fragment,n)},m(n,i){X(e,n,i),C(n,t,i),X(l,n,i),s=!0},p(n,i){const a={};i[0]&16777216&&(a.content=n[24].t("Good Response")),i[0]&2102272|i[2]&32768&&(a.$$scope={dirty:i,ctx:n}),e.$set(a);const o={};i[0]&16777216&&(o.content=n[24].t("Bad Response")),i[0]&2102272|i[2]&32768&&(o.$$scope={dirty:i,ctx:n}),l.$set(o)},i(n){s||(b(e.$$.fragment,n),b(l.$$.fragment,n),s=!0)},o(n){D(e.$$.fragment,n),D(l.$$.fragment,n),s=!1},d(n){n&&m(t),$(e,n),$(l,n)}}}function ha(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){var a,o;h(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=r[12])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[21]},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[59]),n=!0)},p(a,o){var f,u;o[0]&5120&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&2097152&&(e.disabled=a[21])},d(a){a&&m(e),n=!1,i()}}}function ma(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var o=k(e);t=ke(o,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=k(t);l=ke(f,"path",{d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){var a,o;h(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((o=(a=r[12])==null?void 0:a.annotation)==null?void 0:o.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[21]},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[60]),n=!0)},p(a,o){var f,u;o[0]&5120&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=a[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),o[0]&2097152&&(e.disabled=a[21])},d(a){a&&m(e),n=!1,i()}}}function us(r){let e,t;return e=new Re({props:{content:r[24].t("Continue Response"),placement:"bottom",$$slots:{default:[ga]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&16777216&&(n.content=l[24].t("Continue Response")),s[0]&1152|s[2]&32768&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function ga(r){let e,t,l,s,n,i,a;return{c(){e=y("button"),t=be("svg"),l=be("path"),s=be("path"),this.h()},l(o){e=I(o,"BUTTON",{type:!0,id:!0,class:!0});var f=k(e);t=ke(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),s=ke(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),h(s,"stroke-linecap","round"),h(s,"stroke-linejoin","round"),h(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","continue-response-button"),h(e,"class",n=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,f){C(o,e,f),_(e,t),_(t,l),_(t,s),i||(a=me(e,"click",r[61]),i=!0)},p(o,f){f[0]&1024&&n!==(n=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",n)},d(o){o&&m(e),i=!1,a()}}}function _a(r){let e,t,l,s,n,i;return{c(){e=y("button"),t=be("svg"),l=be("path"),this.h()},l(a){e=I(a,"BUTTON",{type:!0,class:!0});var o=k(e);t=ke(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=k(t);l=ke(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,o){C(a,e,o),_(e,t),_(t,l),n||(i=me(e,"click",r[62]),n=!0)},p(a,o){o[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(a){a&&m(e),n=!1,i()}}}function cs(r){var i;let e,t,l=ye(((i=r[14])==null?void 0:i.actions)??[]),s=[];for(let a=0;a<l.length;a+=1)s[a]=ds(Wl(r,l,a));const n=a=>D(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=ce()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=ce()},m(a,o){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(a,o);C(a,e,o),t=!0},p(a,o){var f;if(o[0]&21536){l=ye(((f=a[14])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=Wl(a,l,u);s[u]?(s[u].p(c,o),b(s[u],1)):(s[u]=ds(c),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(ee(),u=l.length;u<s.length;u+=1)n(u);te()}},i(a){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(a){a&&m(e),Ue(s,a)}}}function va(r){let e,t;return e=new Nr({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function pa(r){let e,t,l,s,n;return{c(){e=y("div"),t=y("img"),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);t=I(a,"IMG",{src:!0,class:!0,style:!0,alt:!0}),a.forEach(m),this.h()},h(){Tt(t.src,l=r[70].icon_url)||h(t,"src",l),h(t,"class",s="w-4 h-4 "+(r[70].icon_url.includes("svg")?"dark:invert-[80%]":"")),nn(t,"fill","currentColor"),h(t,"alt",n=r[70].name),h(e,"class","size-4")},m(i,a){C(i,e,a),_(e,t)},p(i,a){a[0]&16384&&!Tt(t.src,l=i[70].icon_url)&&h(t,"src",l),a[0]&16384&&s!==(s="w-4 h-4 "+(i[70].icon_url.includes("svg")?"dark:invert-[80%]":""))&&h(t,"class",s),a[0]&16384&&n!==(n=i[70].name)&&h(t,"alt",n)},i:ve,o:ve,d(i){i&&m(e)}}}function ba(r){let e,t,l,s,n,i,a,o;const f=[pa,va],u=[];function c(g,v){return g[70].icon_url?0:1}t=c(r),l=u[t]=f[t](r);function d(){return r[63](r[70])}return{c(){e=y("button"),l.c(),n=j(),this.h()},l(g){e=I(g,"BUTTON",{type:!0,class:!0});var v=k(e);l.l(v),v.forEach(m),n=A(g),this.h()},h(){h(e,"type","button"),h(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(g,v){C(g,e,v),u[t].m(e,null),C(g,n,v),i=!0,a||(o=me(e,"click",d),a=!0)},p(g,v){r=g;let M=t;t=c(r),t===M?u[t].p(r,v):(ee(),D(u[M],1,1,()=>{u[M]=null}),te(),l=u[t],l?l.p(r,v):(l=u[t]=f[t](r),l.c()),b(l,1),l.m(e,null)),(!i||v[0]&1024&&s!==(s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&h(e,"class",s)},i(g){i||(b(l),i=!0)},o(g){D(l),i=!1},d(g){g&&(m(e),m(n)),u[t].d(),a=!1,o()}}}function ds(r){let e,t;return e=new Re({props:{content:r[70].name,placement:"bottom",$$slots:{default:[ba]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&16384&&(n.content=l[70].name),s[0]&21536|s[2]&32768&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function hs(r){let e,t,l,s;function n(o){r[64](o)}function i(o){r[65](o)}let a={};return r[12]!==void 0&&(a.message=r[12]),r[20]!==void 0&&(a.show=r[20]),e=new _r({props:a}),ze.push(()=>Ke(e,"message",n)),ze.push(()=>Ke(e,"show",i)),e.$on("save",r[66]),{c(){K(e.$$.fragment)},l(o){Q(e.$$.fragment,o)},m(o,f){X(e,o,f),s=!0},p(o,f){const u={};!t&&f[0]&4096&&(t=!0,u.message=o[12],Ze(()=>t=!1)),!l&&f[0]&1048576&&(l=!0,u.show=o[20],Ze(()=>l=!1)),e.$set(u)},i(o){s||(b(e.$$.fragment,o),s=!0)},o(o){D(e.$$.fragment,o),s=!1},d(o){$(e,o)}}}function ms(r){var ie,se,ne,fe,F,le,ge,_e;let e,t,l,s,n,i,a,o,f,u=((ie=r[12])==null?void 0:ie.files)&&((se=r[12].files)==null?void 0:se.filter(gs).length)>0,c,d,g,v,M,p,N,w,S,B,T,V;l=new cn({props:{src:((F=(fe=(ne=r[14])==null?void 0:ne.info)==null?void 0:fe.meta)==null?void 0:F.profile_image_url)??(r[24].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`),className:"size-8"}}),a=new Wt({props:{$$slots:{default:[zi]},$$scope:{ctx:r}}});let R=u&&Fl(r),O=(((le=r[12])==null?void 0:le.statusHistory)??[...(ge=r[12])!=null&&ge.status?[(_e=r[12])==null?void 0:_e.status]:[]]).length>0&&Zl(jt(r));const E=[ea,xi],L=[];function z(H,x){return H[13]===!0?0:1}M=z(r),p=L[M]=E[M](r);let q=!r[13]&&es(r);return{c(){e=y("div"),t=y("div"),K(l.$$.fragment),n=j(),i=y("div"),K(a.$$.fragment),o=j(),f=y("div"),R&&R.c(),c=j(),d=y("div"),g=y("div"),O&&O.c(),v=j(),p.c(),w=j(),q&&q.c(),this.h()},l(H){e=I(H,"DIV",{class:!0,id:!0,dir:!0});var x=k(e);t=I(x,"DIV",{class:!0});var he=k(t);Q(l.$$.fragment,he),he.forEach(m),n=A(x),i=I(x,"DIV",{class:!0});var ae=k(i);Q(a.$$.fragment,ae),o=A(ae),f=I(ae,"DIV",{});var Y=k(f);R&&R.l(Y),c=A(Y),d=I(Y,"DIV",{class:!0});var P=k(d);g=I(P,"DIV",{});var Z=k(g);O&&O.l(Z),v=A(Z),p.l(Z),Z.forEach(m),P.forEach(m),w=A(Y),q&&q.l(Y),Y.forEach(m),ae.forEach(m),x.forEach(m),this.h()},h(){var H;h(t,"class",s=Kt(`flex-shrink-0 ${(((H=r[22])==null?void 0:H.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"),h(d,"class",N="chat-"+r[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),h(i,"class","flex-auto w-0 pl-1"),h(e,"class",S="flex w-full message-"+r[12].id+" svelte-1u5gq5j"),h(e,"id",B="message-"+r[12].id),h(e,"dir",T=r[22].chatDirection)},m(H,x){C(H,e,x),_(e,t),X(l,t,null),_(e,n),_(e,i),X(a,i,null),_(i,o),_(i,f),R&&R.m(f,null),_(f,c),_(f,d),_(d,g),O&&O.m(g,null),_(g,v),L[M].m(g,null),_(f,w),q&&q.m(f,null),V=!0},p(H,x){var P,Z,de,ue,we,oe,re,pe,Ve;const he={};x[0]&16793600&&(he.src=((de=(Z=(P=H[14])==null?void 0:P.info)==null?void 0:Z.meta)==null?void 0:de.profile_image_url)??(H[24].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`)),l.$set(he),(!V||x[0]&4194304&&s!==(s=Kt(`flex-shrink-0 ${(((ue=H[22])==null?void 0:ue.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"))&&h(t,"class",s);const ae={};x[0]&20480|x[2]&32768&&(ae.$$scope={dirty:x,ctx:H}),a.$set(ae),x[0]&4096&&(u=((we=H[12])==null?void 0:we.files)&&((oe=H[12].files)==null?void 0:oe.filter(gs).length)>0),u?R?(R.p(H,x),x[0]&4096&&b(R,1)):(R=Fl(H),R.c(),b(R,1),R.m(f,c)):R&&(ee(),D(R,1,1,()=>{R=null}),te()),(((re=H[12])==null?void 0:re.statusHistory)??[...(pe=H[12])!=null&&pe.status?[(Ve=H[12])==null?void 0:Ve.status]:[]]).length>0?O?(O.p(jt(H),x),x[0]&4096&&b(O,1)):(O=Zl(jt(H)),O.c(),b(O,1),O.m(g,v)):O&&(ee(),D(O,1,1,()=>{O=null}),te());let Y=M;M=z(H),M===Y?L[M].p(H,x):(ee(),D(L[Y],1,1,()=>{L[Y]=null}),te(),p=L[M],p?p.p(H,x):(p=L[M]=E[M](H),p.c()),b(p,1),p.m(g,null)),(!V||x[0]&4096&&N!==(N="chat-"+H[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&h(d,"class",N),H[13]?q&&(ee(),D(q,1,1,()=>{q=null}),te()):q?(q.p(H,x),x[0]&8192&&b(q,1)):(q=es(H),q.c(),b(q,1),q.m(f,null)),(!V||x[0]&4096&&S!==(S="flex w-full message-"+H[12].id+" svelte-1u5gq5j"))&&h(e,"class",S),(!V||x[0]&4096&&B!==(B="message-"+H[12].id))&&h(e,"id",B),(!V||x[0]&4194304&&T!==(T=H[22].chatDirection))&&h(e,"dir",T)},i(H){V||(b(l.$$.fragment,H),b(a.$$.fragment,H),b(R),b(O),b(p),b(q),V=!0)},o(H){D(l.$$.fragment,H),D(a.$$.fragment,H),D(R),D(O),D(p),D(q),V=!1},d(H){H&&m(e),$(l),$(a),R&&R.d(),O&&O.d(),L[M].d(),q&&q.d()}}}function ka(r){let e=r[12].id,t,l,s=ms(r);return{c(){s.c(),t=ce()},l(n){s.l(n),t=ce()},m(n,i){s.m(n,i),C(n,t,i),l=!0},p(n,i){i[0]&4096&&De(e,e=n[12].id)?(ee(),D(s,1,1,ve),te(),s=ms(n),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&m(t),s.d(n)}}}const gs=r=>r.type==="image",wa=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`},_s=r=>r.slice(2),vs=r=>r.endsWith(",")?r.slice(0,-1):r;function ya(r,e,t){let l,s,n,i,a;Me(r,Ot,J=>t(41,l=J)),Me(r,Ht,J=>t(22,s=J)),Me(r,fn,J=>t(23,n=J)),Me(r,Lt,J=>t(25,a=J));const o=qe("i18n");Me(r,o,J=>t(24,i=J));const f=ht();let{chatId:u=""}=e,{history:c}=e,{messageId:d}=e,g=JSON.parse(JSON.stringify(c.messages[d])),{siblings:v}=e,{showPreviousMessage:M}=e,{showNextMessage:p}=e,{updateChat:N}=e,{editMessage:w}=e,{saveMessage:S}=e,{rateMessage:B}=e,{actionMessage:T}=e,{submitMessage:V}=e,{continueResponse:R}=e,{regenerateResponse:O}=e,{addMessages:E}=e,{isLastMessage:L=!0}=e,{readOnly:z=!1}=e,q=null,ie=!1,se="",ne,fe={},F=!1,le,ge=!1,_e=!1,H=!1;const x=async J=>{await un(J)&&Le.success(i.t("Copying to clipboard was successful!"))},he=J=>new Promise(Ee=>{le=J;const Ie=fe[J];if(!Ie)return Ee();Ie.play(),Ie.onended=async()=>{await new Promise(He=>setTimeout(He,300)),Object.keys(fe).length-1===J&&t(17,F=!1),Ee()}}),ae=async()=>{var J,Ee,Ie,He,Ge,Ye,Nt,ft,pt,Se,Fe,tt;if(F){try{speechSynthesis.cancel(),le!==void 0&&fe[le]&&(fe[le].pause(),fe[le].currentTime=0)}catch{}t(17,F=!1),le=void 0;return}if(!((g==null?void 0:g.content)??"").trim().length){Le.info(i.t("No content to speak"));return}if(t(17,F=!0),n.audio.tts.engine!==""){t(18,ge=!0);const We=Pn(g.content,((Ee=(J=n==null?void 0:n.audio)==null?void 0:J.tts)==null?void 0:Ee.split_on)??"punctuation");if(!We.length){console.log("No content to speak"),Le.info(i.t("No content to speak")),t(17,F=!1),t(18,ge=!1);return}console.debug("Prepared message content for TTS",We),fe=We.reduce((lt,bt,ut)=>(lt[ut]=null,lt),{});let mt=Promise.resolve();for(const[lt,bt]of We.entries()){const ut=await jn(localStorage.token,((He=(Ie=s==null?void 0:s.audio)==null?void 0:Ie.tts)==null?void 0:He.defaultVoice)===n.audio.tts.voice?((Ye=(Ge=s==null?void 0:s.audio)==null?void 0:Ge.tts)==null?void 0:Ye.voice)??((ft=(Nt=n==null?void 0:n.audio)==null?void 0:Nt.tts)==null?void 0:ft.voice):(Se=(pt=n==null?void 0:n.audio)==null?void 0:pt.tts)==null?void 0:Se.voice,bt).catch(st=>{console.error(st),Le.error(`${st}`),t(17,F=!1),t(18,ge=!1)});if(ut){const st=await ut.blob(),ct=URL.createObjectURL(st),dt=new Audio(ct);dt.playbackRate=((tt=(Fe=s.audio)==null?void 0:Fe.tts)==null?void 0:tt.playbackRate)??1,fe[lt]=dt,t(18,ge=!1),mt=mt.then(()=>he(lt))}}}else{let We=[];const mt=setInterval(()=>{var lt,bt,ut;if(We=speechSynthesis.getVoices(),We.length>0){clearInterval(mt);const st=((lt=We==null?void 0:We.filter(dt=>{var Ft,Gt,Yt,Zt;return dt.voiceURI===(((Gt=(Ft=s==null?void 0:s.audio)==null?void 0:Ft.tts)==null?void 0:Gt.voice)??((Zt=(Yt=n==null?void 0:n.audio)==null?void 0:Yt.tts)==null?void 0:Zt.voice))}))==null?void 0:lt.at(0))??void 0;console.log(st);const ct=new SpeechSynthesisUtterance(g.content);ct.rate=((ut=(bt=s.audio)==null?void 0:bt.tts)==null?void 0:ut.playbackRate)??1,console.log(ct),ct.onend=()=>{var dt;t(17,F=!1),s.conversationMode&&((dt=document.getElementById("voice-input-button"))==null||dt.click())},st&&(ct.voice=st),speechSynthesis.speak(ct)}},100)}},Y=async()=>{t(13,ie=!0),t(15,se=g.content),await Ne(),t(16,ne.style.height="",ne),t(16,ne.style.height=`${ne.scrollHeight}px`,ne)},P=async()=>{w(g.id,se||"",!1),t(13,ie=!1),t(15,se=""),await Ne()},Z=async()=>{w(g.id,se||""),t(13,ie=!1),t(15,se=""),await Ne()},de=async()=>{t(13,ie=!1),t(15,se=""),await Ne()},ue=async J=>{t(19,_e=!0);const Ee=await An(localStorage.token,J.content).catch(Ie=>{Le.error(`${Ie}`)});if(console.log(Ee),Ee){const Ie=Ee.map(He=>({type:"image",url:`${He.url}`}));S(J.id,{...J,files:Ie})}t(19,_e=!1)};let we=!1;const oe=async(J=null,Ee=null)=>{var pt;t(21,we=!0),console.log("Feedback",J,Ee);const Ie={...g,annotation:{...(g==null?void 0:g.annotation)??{},...J!==null?{rating:J}:{},...Ee||{}}},He=await On(localStorage.token,u).catch(Se=>{Le.error(`${Se}`)});if(!He)return;const Ge=Ut(c,g.id);let Ye={type:"rating",data:{...Ie!=null&&Ie.annotation?Ie.annotation:{},model_id:(g==null?void 0:g.selectedModelId)??g.model,...c.messages[g.parentId].childrenIds.length>1?{sibling_model_ids:c.messages[g.parentId].childrenIds.filter(Se=>Se!==g.id).map(Se=>{var Fe;return((Fe=c.messages[Se])==null?void 0:Fe.selectedModelId)??c.messages[Se].model})}:{}},meta:{arena:g?g.arena:!1,model_id:g.model,message_id:g.id,message_index:Ge.length,chat_id:u},snapshot:{chat:He}};const Nt=[Ye.data.model_id,...Ye.data.sibling_model_ids??[]].reduce((Se,Fe)=>{var We;const tt=l.find(mt=>mt.id===Fe);return tt?Se[tt.id]=((We=tt==null?void 0:tt.info)==null?void 0:We.base_model_id)??null:console.warn(`Model with ID ${Fe} not found`),Se},{});Ye.meta.base_models=Nt;let ft=null;if(g!=null&&g.feedbackId?ft=await el(localStorage.token,g.feedbackId,Ye).catch(Se=>{Le.error(`${Se}`)}):(ft=await Zn(localStorage.token,Ye).catch(Se=>{Le.error(`${Se}`)}),ft&&(Ie.feedbackId=ft.id)),console.log(Ie),S(g.id,Ie),await Ne(),!Ee&&(t(20,H=!0),!((pt=Ie.annotation)!=null&&pt.tags))){const Se=await Kn(localStorage.token,g.model,Ge,u).catch(Fe=>(console.error(Fe),[]));console.log(Se),Se&&(Ie.annotation.tags=Se,Ye.data.tags=Se,S(g.id,Ie),await el(localStorage.token,Ie.feedbackId,Ye).catch(Fe=>{Le.error(`${Fe}`)}))}t(21,we=!1)};vt(async()=>{await Ne()});function re(J){ze[J?"unshift":"push"](()=>{ne=J,t(16,ne)})}function pe(){se=this.value,t(15,se)}const Ve=J=>{var He,Ge;J.key==="Escape"&&((He=document.getElementById("close-edit-message-button"))==null||He.click());const Ee=J.metaKey||J.ctrlKey,Ie=J.key==="Enter";Ee&&Ie&&((Ge=document.getElementById("confirm-edit-message-button"))==null||Ge.click())},Pe=()=>{Z()},Ce=()=>{de()},je=()=>{P()},Ae=J=>{console.log(J);const Ee=document.getElementById(`source-${J}`);Ee&&Ee.click()},Je=({modelId:J,parentId:Ee,messages:Ie})=>{E({modelId:J,parentId:Ee,messages:Ie})},$e=J=>{const{raw:Ee,oldContent:Ie,newContent:He}=J.detail;t(0,c.messages[g.id].content=c.messages[g.id].content.replace(Ee,Ee.replace(Ie,He)),c),N()},xe=J=>{var He;const{type:Ee,content:Ie}=J.detail;if(Ee==="explain")V(g.id,`Explain this section to me in more detail

\`\`\`
${Ie}
\`\`\``);else if(Ee==="ask"){const Ge=((He=J.detail)==null?void 0:He.input)??"";V(g.id,`\`\`\`
${Ie}
\`\`\`
${Ge}`)}},rt=()=>{M(g)},it=()=>{p(g)},Qe=()=>{Y()},at=()=>{x(g.content)},ot=()=>{ge||ae()},et=()=>{_e||ue(g)},wt=()=>{console.log(g)},yt=async()=>{await oe(1),window.setTimeout(()=>{var J;(J=document.getElementById(`message-feedback-${g.id}`))==null||J.scrollIntoView()},0)},It=async()=>{await oe(-1),window.setTimeout(()=>{var J;(J=document.getElementById(`message-feedback-${g.id}`))==null||J.scrollIntoView()},0)},Mt=()=>{R()},Et=()=>{t(20,H=!1),O(g),((q==null?void 0:q.actions)??[]).forEach(J=>{f("action",{id:J.id,event:{id:"regenerate-response",data:{messageId:g.id}}})})},pn=J=>{T(J.id,g)};function bn(J){g=J,t(12,g),t(0,c),t(37,d)}function kn(J){H=J,t(20,H)}const wn=async J=>{await oe(null,{...J.detail})};return r.$$set=J=>{"chatId"in J&&t(36,u=J.chatId),"history"in J&&t(0,c=J.history),"messageId"in J&&t(37,d=J.messageId),"siblings"in J&&t(1,v=J.siblings),"showPreviousMessage"in J&&t(2,M=J.showPreviousMessage),"showNextMessage"in J&&t(3,p=J.showNextMessage),"updateChat"in J&&t(4,N=J.updateChat),"editMessage"in J&&t(38,w=J.editMessage),"saveMessage"in J&&t(39,S=J.saveMessage),"rateMessage"in J&&t(40,B=J.rateMessage),"actionMessage"in J&&t(5,T=J.actionMessage),"submitMessage"in J&&t(6,V=J.submitMessage),"continueResponse"in J&&t(7,R=J.continueResponse),"regenerateResponse"in J&&t(8,O=J.regenerateResponse),"addMessages"in J&&t(9,E=J.addMessages),"isLastMessage"in J&&t(10,L=J.isLastMessage),"readOnly"in J&&t(11,z=J.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&4097|r.$$.dirty[1]&64&&c.messages&&JSON.stringify(g)!==JSON.stringify(c.messages[d])&&t(12,g=JSON.parse(JSON.stringify(c.messages[d]))),r.$$.dirty[0]&4096|r.$$.dirty[1]&1024&&t(14,q=l.find(J=>J.id===g.model)),r.$$.dirty[0]&8192&&(ie||(async()=>await Ne())())},[c,v,M,p,N,T,V,R,O,E,L,z,g,ie,q,se,ne,F,ge,_e,H,we,s,n,i,a,o,f,x,ae,Y,P,Z,de,ue,oe,u,d,w,S,B,l,re,pe,Ve,Pe,Ce,je,Ae,Je,$e,xe,rt,it,Qe,at,ot,et,wt,yt,It,Mt,Et,pn,bn,kn,wn]}class vn extends Te{constructor(e){super(),Be(this,e,ya,ka,De,{chatId:36,history:0,messageId:37,siblings:1,showPreviousMessage:2,showNextMessage:3,updateChat:4,editMessage:38,saveMessage:39,rateMessage:40,actionMessage:5,submitMessage:6,continueResponse:7,regenerateResponse:8,addMessages:9,isLastMessage:10,readOnly:11},null,[-1,-1,-1])}}function Ia(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function Ma(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Ea extends Te{constructor(e){super(),Be(this,e,Ma,Ia,De,{className:0,strokeWidth:1})}}function At(r){var l;const e=r.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[15]=t,e}function ps(r,e,t){const l=r.slice();return l[35]=e[t],l}function zt(r){const e=r.slice(),t=e[18][e[35]].messageIds[e[19][e[35]]];return e[38]=t,e}function bs(r){let e,t,l,s,n,i=ye(Object.keys(r[18])),a=[];for(let u=0;u<i.length;u+=1)a[u]=Is(ps(r,i,u));const o=u=>D(a[u],1,1,()=>{a[u]=null});let f=!r[4]&&Ms(r);return{c(){e=y("div"),t=y("div");for(let u=0;u<a.length;u+=1)a[u].c();s=j(),f&&f.c(),this.h()},l(u){e=I(u,"DIV",{});var c=k(e);t=I(c,"DIV",{class:!0,id:!0});var d=k(t);for(let g=0;g<a.length;g+=1)a[g].l(d);d.forEach(m),s=A(c),f&&f.l(c),c.forEach(m),this.h()},h(){h(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),h(t,"id",l="responses-container-"+r[1]+"-"+r[17].id)},m(u,c){C(u,e,c),_(e,t);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(t,null);_(e,s),f&&f.m(e,null),n=!0},p(u,c){if(c[0]&27066359){i=ye(Object.keys(u[18]));let d;for(d=0;d<i.length;d+=1){const g=ps(u,i,d);a[d]?(a[d].p(g,c),b(a[d],1)):(a[d]=Is(g),a[d].c(),b(a[d],1),a[d].m(t,null))}for(ee(),d=i.length;d<a.length;d+=1)o(d);te()}(!n||c[0]&131074&&l!==(l="responses-container-"+u[1]+"-"+u[17].id))&&h(t,"id",l),u[4]?f&&(ee(),D(f,1,1,()=>{f=null}),te()):f?(f.p(u,c),c[0]&16&&b(f,1)):(f=Ms(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!n){for(let c=0;c<i.length;c+=1)b(a[c]);b(f),n=!0}},o(u){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)D(a[c]);D(f),n=!1},d(u){u&&m(e),Ue(a,u),f&&f.d()}}}function ks(r){let e,t=r[0].currentId,l,s,n,i,a,o=ys(r);function f(){return r[31](r[38])}return{c(){e=y("div"),o.c(),l=j(),this.h()},l(u){e=I(u,"DIV",{class:!0});var c=k(e);o.l(c),l=A(c),c.forEach(m),this.h()},h(){var u;h(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=r[0].messages[r[2]])==null?void 0:u.modelIdx)==r[35]?`border-gray-100 dark:border-gray-800 border-[1.5px] ${r[20]?"min-w-full":"min-w-80"}`:`border-gray-50 dark:border-gray-850 border-dashed ${r[20]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){C(u,e,c),o.m(e,null),_(e,l),n=!0,i||(a=me(e,"click",f),i=!0)},p(u,c){var d;r=u,c[0]&1&&De(t,t=r[0].currentId)?(ee(),D(o,1,1,ve),te(),o=ys(r),o.c(),b(o,1),o.m(e,l)):o.p(r,c),(!n||c[0]&1310725&&s!==(s="snap-center w-full max-w-full m-1 border "+(((d=r[0].messages[r[2]])==null?void 0:d.modelIdx)==r[35]?`border-gray-100 dark:border-gray-800 border-[1.5px] ${r[20]?"min-w-full":"min-w-80"}`:`border-gray-50 dark:border-gray-850 border-dashed ${r[20]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&h(e,"class",s)},i(u){n||(b(o),n=!0)},o(u){D(o),n=!1},d(u){u&&m(e),o.d(u),i=!1,a()}}}function ws(r){let e,t;function l(){return r[28](r[35])}function s(){return r[29](r[35])}function n(...i){return r[30](r[35],...i)}return e=new vn({props:{chatId:r[1],history:r[0],messageId:r[38],isLastMessage:!0,siblings:r[18][r[35]].messageIds,showPreviousMessage:l,showNextMessage:s,updateChat:r[5],editMessage:r[6],saveMessage:r[7],rateMessage:r[8],actionMessage:r[9],submitMessage:r[10],continueResponse:r[11],regenerateResponse:n,addMessages:r[13],readOnly:r[4]}}),{c(){K(e.$$.fragment)},l(i){Q(e.$$.fragment,i)},m(i,a){X(e,i,a),t=!0},p(i,a){r=i;const o={};a[0]&2&&(o.chatId=r[1]),a[0]&1&&(o.history=r[0]),a[0]&786432&&(o.messageId=r[38]),a[0]&262144&&(o.siblings=r[18][r[35]].messageIds),a[0]&262144&&(o.showPreviousMessage=l),a[0]&262144&&(o.showNextMessage=s),a[0]&32&&(o.updateChat=r[5]),a[0]&64&&(o.editMessage=r[6]),a[0]&128&&(o.saveMessage=r[7]),a[0]&256&&(o.rateMessage=r[8]),a[0]&512&&(o.actionMessage=r[9]),a[0]&1024&&(o.submitMessage=r[10]),a[0]&2048&&(o.continueResponse=r[11]),a[0]&790528&&(o.regenerateResponse=n),a[0]&8192&&(o.addMessages=r[13]),a[0]&16&&(o.readOnly=r[4]),e.$set(o)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){$(e,i)}}}function ys(r){let e,t,l=r[15]&&ws(r);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[15]?l?(l.p(s,n),n[0]&32768&&b(l,1)):(l=ws(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),D(l,1,1,()=>{l=null}),te())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Is(r){let e,t,l=r[19][r[35]]!==void 0&&r[18][r[35]].messageIds.length>0&&ks(zt(r));return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[19][s[35]]!==void 0&&s[18][s[35]].messageIds.length>0?l?(l.p(zt(s),n),n[0]&786432&&b(l,1)):(l=ks(zt(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),D(l,1,1,()=>{l=null}),te())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Ms(r){let e=!Object.keys(r[18]).find(r[27]),t,l,s=e&&Es(r);return{c(){s&&s.c(),t=ce()},l(n){s&&s.l(n),t=ce()},m(n,i){s&&s.m(n,i),C(n,t,i),l=!0},p(n,i){i[0]&786433&&(e=!Object.keys(n[18]).find(n[27])),e?s?(s.p(n,i),i[0]&786433&&b(s,1)):(s=Es(n),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(ee(),D(s,1,1,()=>{s=null}),te())},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&m(t),s&&s.d(n)}}}function Es(r){var a,o;let e,t,l,s,n=((o=(a=r[0].messages[r[2]])==null?void 0:a.merged)==null?void 0:o.status)&&Ns(At(r)),i=r[3]&&Vs(r);return{c(){e=y("div"),t=y("div"),n&&n.c(),l=j(),i&&i.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);t=I(u,"DIV",{class:!0});var c=k(t);n&&n.l(c),c.forEach(m),l=A(u),i&&i.l(u),u.forEach(m),this.h()},h(){h(t,"class","w-full"),h(e,"class","flex justify-end")},m(f,u){C(f,e,u),_(e,t),n&&n.m(t,null),_(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,d;(d=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&d.status?n?(n.p(At(f),u),u[0]&5&&b(n,1)):(n=Ns(At(f)),n.c(),b(n,1),n.m(t,null)):n&&(ee(),D(n,1,1,()=>{n=null}),te()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Vs(f),i.c(),b(i,1),i.m(e,null)):i&&(ee(),D(i,1,1,()=>{i=null}),te())},i(f){s||(b(n),b(i),s=!0)},o(f){D(n),D(i),s=!1},d(f){f&&m(e),n&&n.d(),i&&i.d()}}}function Ns(r){let e,t,l,s,n,i,a;t=new Wt({props:{$$slots:{default:[Na]},$$scope:{ctx:r}}});const o=[Va,Da],f=[];function u(c,d){var g;return(((g=c[15])==null?void 0:g.content)??"")===""?0:1}return n=u(r),i=f[n]=o[n](r),{c(){e=y("div"),K(t.$$.fragment),l=j(),s=y("div"),i.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var d=k(e);Q(t.$$.fragment,d),l=A(d),s=I(d,"DIV",{class:!0});var g=k(s);i.l(g),g.forEach(m),d.forEach(m),this.h()},h(){h(s,"class","mt-1 markdown-prose w-full min-w-full"),h(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,d){C(c,e,d),X(t,e,null),_(e,l),_(e,s),f[n].m(s,null),a=!0},p(c,d){const g={};d[0]&2097157|d[1]&256&&(g.$$scope={dirty:d,ctx:c}),t.$set(g);let v=n;n=u(c),n===v?f[n].p(c,d):(ee(),D(f[v],1,1,()=>{f[v]=null}),te(),i=f[n],i?i.p(c,d):(i=f[n]=o[n](c),i.c()),b(i,1),i.m(s,null))},i(c){a||(b(t.$$.fragment,c),b(i),a=!0)},o(c){D(t.$$.fragment,c),D(i),a=!1},d(c){c&&m(e),$(t),f[n].d()}}}function Ds(r){let e,t=_t(r[15].timestamp*1e3).format(r[21].t("h:mm a"))+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&2097157&&t!==(t=_t(s[15].timestamp*1e3).format(s[21].t("h:mm a"))+"")&&G(l,t)},d(s){s&&m(e)}}}function Na(r){let e,t,l=r[15].timestamp&&Ds(r);return{c(){e=U(`Merged Response

									`),l&&l.c(),t=ce()},l(s){e=W(s,`Merged Response

									`),l&&l.l(s),t=ce()},m(s,n){C(s,e,n),l&&l.m(s,n),C(s,t,n)},p(s,n){s[15].timestamp?l?l.p(s,n):(l=Ds(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(m(e),m(t)),l&&l.d(s)}}}function Da(r){let e,t;return e=new kt({props:{id:"merged",content:r[15].content??""}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&5&&(n.content=l[15].content??""),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Va(r){let e,t;return e=new Jt({}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Vs(r){let e,t,l;return t=new Re({props:{content:r[21].t("Merge Responses"),placement:"bottom",$$slots:{default:[Ca]},$$scope:{ctx:r}}}),{c(){e=y("div"),K(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Q(t.$$.fragment,n),n.forEach(m),this.h()},h(){h(e,"class","flex-shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,n){C(s,e,n),X(t,e,null),l=!0},p(s,n){const i={};n[0]&2097152&&(i.content=s[21].t("Merge Responses")),n[1]&256&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),$(t)}}}function Ca(r){let e,t,l,s,n;return t=new Ea({props:{className:" size-5 "}}),{c(){e=y("button"),K(t.$$.fragment),this.h()},l(i){e=I(i,"BUTTON",{type:!0,id:!0,class:!0});var a=k(e);Q(t.$$.fragment,a),a.forEach(m),this.h()},h(){h(e,"type","button"),h(e,"id","merge-response-button"),h(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,a){C(i,e,a),X(t,e,null),l=!0,s||(n=me(e,"click",r[32]),s=!0)},p:ve,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&m(e),$(t),s=!1,n()}}}function Ta(r){let e,t,l=r[17]&&bs(r);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[17]?l?(l.p(s,n),n[0]&131072&&b(l,1)):(l=bs(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ee(),D(l,1,1,()=>{l=null}),te())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Ba(r,e,t){let l,s;Me(r,on,H=>t(20,l=H));const n=qe("i18n");Me(r,n,H=>t(21,s=H));let{chatId:i}=e,{history:a}=e,{messageId:o}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:c}=e,{editMessage:d}=e,{saveMessage:g}=e,{rateMessage:v}=e,{actionMessage:M}=e,{submitMessage:p}=e,{continueResponse:N}=e,{regenerateResponse:w}=e,{mergeResponses:S}=e,{addMessages:B}=e,{triggerScroll:T}=e;ht();let V,R,O={},E={},L=JSON.parse(JSON.stringify(a.messages[o]));const z=async H=>{t(19,E[H]=Math.max(0,E[H]-1),E);let x=O[H].messageIds[E[H]];console.log(x);let he=a.messages[x].childrenIds;for(;he.length!==0;)x=he.at(-1),he=a.messages[x].childrenIds;t(0,a.currentId=x,a),await Ne(),await c(),T()},q=async H=>{t(19,E[H]=Math.min(O[H].messageIds.length-1,E[H]+1),E);let x=O[H].messageIds[E[H]];console.log(x);let he=a.messages[x].childrenIds;for(;he.length!==0;)x=he.at(-1),he=a.messages[x].childrenIds;t(0,a.currentId=x,a),await Ne(),await c(),T()},ie=async()=>{console.log("multiresponse:initHandler"),await Ne(),t(16,V=o),t(17,R=a.messages[o].parentId?a.messages[a.messages[o].parentId]:null),t(18,O=R==null?void 0:R.models.reduce((H,x,he)=>{let ae=R==null?void 0:R.childrenIds.map(Y=>a.messages[Y]).filter(Y=>(Y==null?void 0:Y.modelIdx)===he).map(Y=>Y.id);if(ae.length===0){let Y=R==null?void 0:R.childrenIds.map(P=>a.messages[P]).filter(P=>(P==null?void 0:P.model)===x);Y.forEach(P=>{P.modelIdx=he}),ae=Y.map(P=>P.id)}return{...H,[he]:{messageIds:ae}}},{})),t(19,E=R==null?void 0:R.models.reduce((H,x,he)=>{const ae=O[he].messageIds.findIndex(Y=>Y===o);return ae!==-1?{...H,[he]:ae}:{...H,[he]:O[he].messageIds.length-1}},{})),console.log(O,E),await Ne()},se=async()=>{const H=Object.keys(O).map(x=>{const{messageIds:he}=O[x],ae=he[E[x]];return a.messages[ae].content});S(o,H,i)};vt(async()=>{await ie(),await Ne();const H=document.getElementById(`message-${o}`);H&&H.scrollIntoView({block:"start"})});const ne=H=>{var ae;const{messageIds:x}=O[H],he=x[E[H]];return!((ae=a.messages[he])!=null&&ae.done)},fe=H=>z(H),F=H=>q(H),le=async(H,x)=>{w(x),await Ne(),t(19,E[H]=O[H].messageIds.length-1,E)},ge=async H=>{if(o!=H){let x=H,he=a.messages[x].childrenIds;for(;he.length!==0;)x=he.at(-1),he=a.messages[x].childrenIds;t(0,a.currentId=x,a),await Ne(),await c(),T()}},_e=()=>{se()};return r.$$set=H=>{"chatId"in H&&t(1,i=H.chatId),"history"in H&&t(0,a=H.history),"messageId"in H&&t(2,o=H.messageId),"isLastMessage"in H&&t(3,f=H.isLastMessage),"readOnly"in H&&t(4,u=H.readOnly),"updateChat"in H&&t(5,c=H.updateChat),"editMessage"in H&&t(6,d=H.editMessage),"saveMessage"in H&&t(7,g=H.saveMessage),"rateMessage"in H&&t(8,v=H.rateMessage),"actionMessage"in H&&t(9,M=H.actionMessage),"submitMessage"in H&&t(10,p=H.submitMessage),"continueResponse"in H&&t(11,N=H.continueResponse),"regenerateResponse"in H&&t(12,w=H.regenerateResponse),"mergeResponses"in H&&t(26,S=H.mergeResponses),"addMessages"in H&&t(13,B=H.addMessages),"triggerScroll"in H&&t(14,T=H.triggerScroll)},r.$$.update=()=>{r.$$.dirty[0]&32773&&a.messages&&JSON.stringify(L)!==JSON.stringify(a.messages[o])&&t(15,L=JSON.parse(JSON.stringify(a.messages[o])))},[a,i,o,f,u,c,d,g,v,M,p,N,w,B,T,L,V,R,O,E,l,s,n,z,q,se,S,ne,fe,F,le,ge,_e]}class Sa extends Te{constructor(e){super(),Be(this,e,Ba,Ta,De,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,continueResponse:11,regenerateResponse:12,mergeResponses:26,addMessages:13,triggerScroll:14},null,[-1,-1])}}function Cs(r,e,t){const l=r.slice();return l[38]=e[t],l}function Ts(r){var n,i,a,o;let e,t,l,s;return t=new cn({props:{src:r[6].user?((a=(i=(n=r[12].find(r[24]))==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??"/user.png":((o=r[0])==null?void 0:o.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=y("div"),K(t.$$.fragment),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);Q(t.$$.fragment,u),u.forEach(m),this.h()},h(){var f;h(e,"class",l=`flex-shrink-0 ${(((f=r[11])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){C(f,e,u),X(t,e,null),s=!0},p(f,u){var d,g,v,M,p;const c={};u[0]&4161&&(c.src=f[6].user?((v=(g=(d=f[12].find(f[24]))==null?void 0:d.info)==null?void 0:g.meta)==null?void 0:v.profile_image_url)??"/user.png":((M=f[0])==null?void 0:M.profile_image_url)??"/user.png"),t.$set(c),(!s||u[0]&2048&&l!==(l=`flex-shrink-0 ${(((p=f[11])==null?void 0:p.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&h(e,"class",l)},i(f){s||(b(t.$$.fragment,f),s=!0)},o(f){D(t.$$.fragment,f),s=!1},d(f){f&&m(e),$(t)}}}function Bs(r){let e,t,l;return t=new Wt({props:{$$slots:{default:[Pa]},$$scope:{ctx:r}}}),{c(){e=y("div"),K(t.$$.fragment)},l(s){e=I(s,"DIV",{});var n=k(e);Q(t.$$.fragment,n),n.forEach(m)},m(s,n){C(s,e,n),X(t,e,null),l=!0},p(s,n){const i={};n[0]&11329|n[1]&1024&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),$(t)}}}function Ra(r){let e=r[10].t("You")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&1024&&e!==(e=l[10].t("You")+"")&&G(t,e)},d(l){l&&m(t)}}}function Oa(r){let e=r[0].name+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&G(t,e)},d(l){l&&m(t)}}}function Ha(r){var a;let e=r[10].t("You")+"",t,l,s,n=(((a=r[6])==null?void 0:a.user)??"")+"",i;return{c(){t=U(e),l=j(),s=y("span"),i=U(n),this.h()},l(o){t=W(o,e),l=A(o),s=I(o,"SPAN",{class:!0});var f=k(s);i=W(f,n),f.forEach(m),this.h()},h(){h(s,"class","text-gray-500 text-sm font-medium")},m(o,f){C(o,t,f),C(o,l,f),C(o,s,f),_(s,i)},p(o,f){var u;f[0]&1024&&e!==(e=o[10].t("You")+"")&&G(t,e),f[0]&64&&n!==(n=(((u=o[6])==null?void 0:u.user)??"")+"")&&G(i,n)},d(o){o&&(m(t),m(l),m(s))}}}function Ss(r){let e,t,l;return t=new Re({props:{content:_t(r[6].timestamp*1e3).format("dddd, DD MMMM YYYY HH:mm"),$$slots:{default:[La]},$$scope:{ctx:r}}}),{c(){e=y("div"),K(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);Q(t.$$.fragment,n),n.forEach(m),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){C(s,e,n),X(t,e,null),l=!0},p(s,n){const i={};n[0]&64&&(i.content=_t(s[6].timestamp*1e3).format("dddd, DD MMMM YYYY HH:mm")),n[0]&64|n[1]&1024&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&m(e),$(t)}}}function La(r){let e,t=St(r[6].timestamp*1e3)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","line-clamp-1")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&64&&t!==(t=St(s[6].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function Pa(r){let e,t,l;function s(o,f){return o[6].user?Ha:o[11].showUsername||o[13].name!==o[0].name?Oa:Ra}let n=s(r),i=n(r),a=r[6].timestamp&&Ss(r);return{c(){i.c(),e=j(),a&&a.c(),t=ce()},l(o){i.l(o),e=A(o),a&&a.l(o),t=ce()},m(o,f){i.m(o,f),C(o,e,f),a&&a.m(o,f),C(o,t,f),l=!0},p(o,f){n===(n=s(o))&&i?i.p(o,f):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e))),o[6].timestamp?a?(a.p(o,f),f[0]&64&&b(a,1)):(a=Ss(o),a.c(),b(a,1),a.m(t.parentNode,t)):a&&(ee(),D(a,1,1,()=>{a=null}),te())},i(o){l||(b(a),l=!0)},o(o){D(a),l=!1},d(o){o&&(m(e),m(t)),i.d(o),a&&a.d(o)}}}function Rs(r){let e,t,l=ye(r[6].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Os(Cs(r,l,i));const n=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(m),this.h()},h(){h(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,a){C(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&2112){l=ye(i[6].files);let o;for(o=0;o<l.length;o+=1){const f=Cs(i,l,o);s[o]?(s[o].p(f,a),b(s[o],1)):(s[o]=Os(f),s[o].c(),b(s[o],1),s[o].m(e,null))}for(ee(),o=l.length;o<s.length;o+=1)n(o);te()}},i(i){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(i){i&&m(e),Ue(s,i)}}}function ja(r){var l;let e,t;return e=new Jn({props:{item:r[38],url:r[38].url,name:r[38].name,type:r[38].type,size:(l=r[38])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){K(e.$$.fragment)},l(s){Q(e.$$.fragment,s)},m(s,n){X(e,s,n),t=!0},p(s,n){var a;const i={};n[0]&64&&(i.item=s[38]),n[0]&64&&(i.url=s[38].url),n[0]&64&&(i.name=s[38].name),n[0]&64&&(i.type=s[38].type),n[0]&64&&(i.size=(a=s[38])==null?void 0:a.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){$(e,s)}}}function Aa(r){let e,t;return e=new dn({props:{src:r[38].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.src=l[38].url),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Os(r){let e,t,l,s,n,i;const a=[Aa,ja],o=[];function f(u,c){return u[38].type==="image"?0:1}return t=f(r),l=o[t]=a[t](r),{c(){e=y("div"),l.c(),s=j(),this.h()},l(u){e=I(u,"DIV",{class:!0});var c=k(e);l.l(c),s=A(c),c.forEach(m),this.h()},h(){var u;h(e,"class",n=((u=r[11])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){C(u,e,c),o[t].m(e,null),_(e,s),i=!0},p(u,c){var g;let d=t;t=f(u),t===d?o[t].p(u,c):(ee(),D(o[d],1,1,()=>{o[d]=null}),te(),l=o[t],l?l.p(u,c):(l=o[t]=a[t](u),l.c()),b(l,1),l.m(e,s)),(!i||c[0]&2048&&n!==(n=((g=u[11])==null?void 0:g.chatBubble)??!0?"self-end":""))&&h(e,"class",n)},i(u){i||(b(l),i=!0)},o(u){D(l),i=!1},d(u){u&&m(e),o[t].d()}}}function za(r){var B,T;let e,t,l,s,n,i,a,o,f,u,c,d,g,v,M=r[6].content&&Hs(r),p=!(((B=r[11])==null?void 0:B.chatBubble)??!0)&&Ls(r),N=!r[5]&&js(r);u=new Re({props:{content:r[10].t("Copy"),placement:"bottom",$$slots:{default:[qa]},$$scope:{ctx:r}}});let w=!r[4]&&!r[5]&&As(r),S=(((T=r[11])==null?void 0:T.chatBubble)??!0)&&zs(r);return{c(){e=y("div"),t=y("div"),l=y("div"),M&&M.c(),i=j(),a=y("div"),p&&p.c(),o=j(),N&&N.c(),f=j(),K(u.$$.fragment),c=j(),w&&w.c(),d=j(),S&&S.c(),this.h()},l(V){e=I(V,"DIV",{class:!0});var R=k(e);t=I(R,"DIV",{class:!0});var O=k(t);l=I(O,"DIV",{class:!0});var E=k(l);M&&M.l(E),E.forEach(m),O.forEach(m),i=A(R),a=I(R,"DIV",{class:!0});var L=k(a);p&&p.l(L),o=A(L),N&&N.l(L),f=A(L),Q(u.$$.fragment,L),c=A(L),w&&w.l(L),d=A(L),S&&S.l(L),L.forEach(m),R.forEach(m),this.h()},h(){var V,R,O;h(l,"class",s="rounded-3xl "+(((V=r[11])==null?void 0:V.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${r[6].files?"rounded-tr-lg":""}`:" w-full")),h(t,"class",n="flex "+(((R=r[11])==null?void 0:R.chatBubble)??!0?"justify-end pb-1":"w-full")),h(a,"class",g="flex "+(((O=r[11])==null?void 0:O.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),h(e,"class","w-full")},m(V,R){C(V,e,R),_(e,t),_(t,l),M&&M.m(l,null),_(e,i),_(e,a),p&&p.m(a,null),_(a,o),N&&N.m(a,null),_(a,f),X(u,a,null),_(a,c),w&&w.m(a,null),_(a,d),S&&S.m(a,null),v=!0},p(V,R){var E,L,z,q,ie;V[6].content?M?(M.p(V,R),R[0]&64&&b(M,1)):(M=Hs(V),M.c(),b(M,1),M.m(l,null)):M&&(ee(),D(M,1,1,()=>{M=null}),te()),(!v||R[0]&2112&&s!==(s="rounded-3xl "+(((E=V[11])==null?void 0:E.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${V[6].files?"rounded-tr-lg":""}`:" w-full")))&&h(l,"class",s),(!v||R[0]&2048&&n!==(n="flex "+(((L=V[11])==null?void 0:L.chatBubble)??!0?"justify-end pb-1":"w-full")))&&h(t,"class",n),((z=V[11])==null?void 0:z.chatBubble)??!0?p&&(p.d(1),p=null):p?p.p(V,R):(p=Ls(V),p.c(),p.m(a,o)),V[5]?N&&(ee(),D(N,1,1,()=>{N=null}),te()):N?(N.p(V,R),R[0]&32&&b(N,1)):(N=js(V),N.c(),b(N,1),N.m(a,f));const O={};R[0]&1024&&(O.content=V[10].t("Copy")),R[0]&64|R[1]&1024&&(O.$$scope={dirty:R,ctx:V}),u.$set(O),!V[4]&&!V[5]?w?(w.p(V,R),R[0]&48&&b(w,1)):(w=As(V),w.c(),b(w,1),w.m(a,d)):w&&(ee(),D(w,1,1,()=>{w=null}),te()),((q=V[11])==null?void 0:q.chatBubble)??!0?S?S.p(V,R):(S=zs(V),S.c(),S.m(a,null)):S&&(S.d(1),S=null),(!v||R[0]&2048&&g!==(g="flex "+(((ie=V[11])==null?void 0:ie.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&h(a,"class",g)},i(V){v||(b(M),b(N),b(u.$$.fragment,V),b(w),v=!0)},o(V){D(M),D(N),D(u.$$.fragment,V),D(w),v=!1},d(V){V&&m(e),M&&M.d(),p&&p.d(),N&&N.d(),$(u),w&&w.d(),S&&S.d()}}}function Ua(r){let e,t,l,s,n,i,a,o,f=r[10].t("Save")+"",u,c,d,g,v=r[10].t("Cancel")+"",M,p,N,w=r[10].t("Send")+"",S,B,T;return{c(){e=y("div"),t=y("div"),l=y("textarea"),n=j(),i=y("div"),a=y("div"),o=y("button"),u=U(f),c=j(),d=y("div"),g=y("button"),M=U(v),p=j(),N=y("button"),S=U(w),this.h()},l(V){e=I(V,"DIV",{class:!0});var R=k(e);t=I(R,"DIV",{class:!0});var O=k(t);l=I(O,"TEXTAREA",{id:!0,class:!0}),k(l).forEach(m),O.forEach(m),n=A(R),i=I(R,"DIV",{class:!0});var E=k(i);a=I(E,"DIV",{});var L=k(a);o=I(L,"BUTTON",{id:!0,class:!0});var z=k(o);u=W(z,f),z.forEach(m),L.forEach(m),c=A(E),d=I(E,"DIV",{class:!0});var q=k(d);g=I(q,"BUTTON",{id:!0,class:!0});var ie=k(g);M=W(ie,v),ie.forEach(m),p=A(q),N=I(q,"BUTTON",{id:!0,class:!0});var se=k(N);S=W(se,w),se.forEach(m),q.forEach(m),E.forEach(m),R.forEach(m),this.h()},h(){h(l,"id",s="message-edit-"+r[6].id),h(l,"class","bg-transparent outline-none w-full resize-none"),h(t,"class","max-h-96 overflow-auto"),h(o,"id","save-edit-message-button"),h(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(g,"id","close-edit-message-button"),h(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(N,"id","confirm-edit-message-button"),h(N,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(d,"class","flex space-x-1.5"),h(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(V,R){C(V,e,R),_(e,t),_(t,l),r[25](l),nt(l,r[8]),_(e,n),_(e,i),_(i,a),_(a,o),_(o,u),_(i,c),_(i,d),_(d,g),_(g,M),_(d,p),_(d,N),_(N,S),B||(T=[me(l,"input",r[26]),me(l,"input",Ga),me(l,"keydown",r[27]),me(o,"click",r[28]),me(g,"click",r[29]),me(N,"click",r[30])],B=!0)},p(V,R){R[0]&64&&s!==(s="message-edit-"+V[6].id)&&h(l,"id",s),R[0]&256&&nt(l,V[8]),R[0]&1024&&f!==(f=V[10].t("Save")+"")&&G(u,f),R[0]&1024&&v!==(v=V[10].t("Cancel")+"")&&G(M,v),R[0]&1024&&w!==(w=V[10].t("Send")+"")&&G(S,w)},i:ve,o:ve,d(V){V&&m(e),r[25](null),B=!1,Xe(T)}}}function Hs(r){let e,t;return e=new kt({props:{id:r[6].id,content:r[6].content}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.id=l[6].id),s[0]&64&&(n.content=l[6].content),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Ls(r){let e,t=r[1].length>1&&Ps(r);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),C(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=Ps(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function Ps(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",a,o,f=r[1].length+"",u,c,d,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',v,M;return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),n=y("div"),a=U(i),o=U("/"),u=U(f),c=j(),d=y("button"),d.innerHTML=g,this.h()},l(p){e=I(p,"DIV",{class:!0,dir:!0});var N=k(e);t=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=A(N),n=I(N,"DIV",{class:!0});var w=k(n);a=W(w,i),o=W(w,"/"),u=W(w,f),w.forEach(m),c=A(N),d=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(d)!=="svelte-107ksnk"&&(d.innerHTML=g),N.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),h(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(p,N){C(p,e,N),_(e,t),_(e,s),_(e,n),_(n,a),_(n,o),_(n,u),_(e,c),_(e,d),v||(M=[me(t,"click",r[31]),me(d,"click",r[32])],v=!0)},p(p,N){N[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&G(a,i),N[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&m(e),v=!1,Xe(M)}}}function js(r){let e,t;return e=new Re({props:{content:r[10].t("Edit"),placement:"bottom",$$slots:{default:[Wa]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&1024&&(n.content=l[10].t("Edit")),s[1]&1024&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Wa(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(e)!=="svelte-stq9y8"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[33]),l=!0)},p:ve,d(n){n&&m(e),l=!1,s()}}}function qa(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(e)!=="svelte-1f3wx5s"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[34]),l=!0)},p:ve,d(n){n&&m(e),l=!1,s()}}}function As(r){let e,t;return e=new Re({props:{content:r[10].t("Delete"),placement:"bottom",$$slots:{default:[Ja]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&1024&&(n.content=l[10].t("Delete")),s[1]&1024&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function Ja(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(e)!=="svelte-1r7mjym"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1 rounded dark:hover:text-white hover:text-black transition")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[35]),l=!0)},p:ve,d(n){n&&m(e),l=!1,s()}}}function zs(r){let e,t=r[1].length>1&&Us(r);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),C(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=Us(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function Us(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",a,o,f=r[1].length+"",u,c,d,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',v,M;return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),n=y("div"),a=U(i),o=U("/"),u=U(f),c=j(),d=y("button"),d.innerHTML=g,this.h()},l(p){e=I(p,"DIV",{class:!0,dir:!0});var N=k(e);t=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=A(N),n=I(N,"DIV",{class:!0});var w=k(n);a=W(w,i),o=W(w,"/"),u=W(w,f),w.forEach(m),c=A(N),d=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(d)!=="svelte-107ksnk"&&(d.innerHTML=g),N.forEach(m),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),h(d,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(p,N){C(p,e,N),_(e,t),_(e,s),_(e,n),_(n,a),_(n,o),_(n,u),_(e,c),_(e,d),v||(M=[me(t,"click",r[36]),me(d,"click",r[37])],v=!0)},p(p,N){N[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&G(a,i),N[0]&2&&f!==(f=p[1].length+"")&&G(u,f)},d(p){p&&m(e),v=!1,Xe(M)}}}function Fa(r){var S,B;let e,t,l,s,n,i,a,o,f,u,c,d,g=!(((S=r[11])==null?void 0:S.chatBubble)??!0)&&Ts(r),v=!(((B=r[11])==null?void 0:B.chatBubble)??!0)&&Bs(r),M=r[6].files&&Rs(r);const p=[Ua,za],N=[];function w(T,V){return T[7]===!0?0:1}return a=w(r),o=N[a]=p[a](r),{c(){e=y("div"),g&&g.c(),t=j(),l=y("div"),v&&v.c(),s=j(),n=y("div"),M&&M.c(),i=j(),o.c(),this.h()},l(T){e=I(T,"DIV",{class:!0,dir:!0,id:!0});var V=k(e);g&&g.l(V),t=A(V),l=I(V,"DIV",{class:!0});var R=k(l);v&&v.l(R),s=A(R),n=I(R,"DIV",{class:!0});var O=k(n);M&&M.l(O),i=A(O),o.l(O),O.forEach(m),R.forEach(m),V.forEach(m),this.h()},h(){h(n,"class",f="chat-"+r[6].role+" w-full min-w-full markdown-prose"),h(l,"class","flex-auto w-0 max-w-full pl-1"),h(e,"class","flex w-full user-message"),h(e,"dir",u=r[11].chatDirection),h(e,"id",c="message-"+r[6].id)},m(T,V){C(T,e,V),g&&g.m(e,null),_(e,t),_(e,l),v&&v.m(l,null),_(l,s),_(l,n),M&&M.m(n,null),_(n,i),N[a].m(n,null),d=!0},p(T,V){var O,E;((O=T[11])==null?void 0:O.chatBubble)??!0?g&&(ee(),D(g,1,1,()=>{g=null}),te()):g?(g.p(T,V),V[0]&2048&&b(g,1)):(g=Ts(T),g.c(),b(g,1),g.m(e,t)),((E=T[11])==null?void 0:E.chatBubble)??!0?v&&(ee(),D(v,1,1,()=>{v=null}),te()):v?(v.p(T,V),V[0]&2048&&b(v,1)):(v=Bs(T),v.c(),b(v,1),v.m(l,s)),T[6].files?M?(M.p(T,V),V[0]&64&&b(M,1)):(M=Rs(T),M.c(),b(M,1),M.m(n,i)):M&&(ee(),D(M,1,1,()=>{M=null}),te());let R=a;a=w(T),a===R?N[a].p(T,V):(ee(),D(N[R],1,1,()=>{N[R]=null}),te(),o=N[a],o?o.p(T,V):(o=N[a]=p[a](T),o.c()),b(o,1),o.m(n,null)),(!d||V[0]&64&&f!==(f="chat-"+T[6].role+" w-full min-w-full markdown-prose"))&&h(n,"class",f),(!d||V[0]&2048&&u!==(u=T[11].chatDirection))&&h(e,"dir",u),(!d||V[0]&64&&c!==(c="message-"+T[6].id))&&h(e,"id",c)},i(T){d||(b(g),b(v),b(M),b(o),d=!0)},o(T){D(g),D(v),D(M),D(o),d=!1},d(T){T&&m(e),g&&g.d(),v&&v.d(),M&&M.d(),N[a].d()}}}const Ga=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`};function Ya(r,e,t){let l,s,n,i;Me(r,Ht,Y=>t(11,s=Y)),Me(r,Ot,Y=>t(12,n=Y)),Me(r,Lt,Y=>t(13,i=Y));const a=qe("i18n");Me(r,a,Y=>t(10,l=Y));let{user:o}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{showPreviousMessage:d}=e,{showNextMessage:g}=e,{editMessage:v}=e,{deleteMessage:M}=e,{isFirstMessage:p}=e,{readOnly:N}=e,w=!1,S="",B,T=JSON.parse(JSON.stringify(f.messages[u]));const V=async Y=>{await un(Y)&&Le.success(l.t("Copying to clipboard was successful!"))},R=async()=>{t(7,w=!0),t(8,S=T.content),await Ne(),t(9,B.style.height="",B),t(9,B.style.height=`${B.scrollHeight}px`,B),B==null||B.focus()},O=async(Y=!0)=>{v(T.id,S,Y),t(7,w=!1),t(8,S="")},E=()=>{t(7,w=!1),t(8,S="")},L=async()=>{M(T.id)};vt(()=>{});const z=Y=>Y.id===T.user;function q(Y){ze[Y?"unshift":"push"](()=>{B=Y,t(9,B)})}function ie(){S=this.value,t(8,S)}const se=Y=>{var de,ue;Y.key==="Escape"&&((de=document.getElementById("close-edit-message-button"))==null||de.click());const P=Y.metaKey||Y.ctrlKey,Z=Y.key==="Enter";P&&Z&&((ue=document.getElementById("confirm-edit-message-button"))==null||ue.click())},ne=()=>{O(!1)},fe=()=>{E()},F=()=>{O()},le=()=>{d(T)},ge=()=>{g(T)},_e=()=>{R()},H=()=>{V(T.content)},x=()=>{L()},he=()=>{d(T)},ae=()=>{g(T)};return r.$$set=Y=>{"user"in Y&&t(0,o=Y.user),"history"in Y&&t(20,f=Y.history),"messageId"in Y&&t(21,u=Y.messageId),"siblings"in Y&&t(1,c=Y.siblings),"showPreviousMessage"in Y&&t(2,d=Y.showPreviousMessage),"showNextMessage"in Y&&t(3,g=Y.showNextMessage),"editMessage"in Y&&t(22,v=Y.editMessage),"deleteMessage"in Y&&t(23,M=Y.deleteMessage),"isFirstMessage"in Y&&t(4,p=Y.isFirstMessage),"readOnly"in Y&&t(5,N=Y.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&3145792&&f.messages&&JSON.stringify(T)!==JSON.stringify(f.messages[u])&&t(6,T=JSON.parse(JSON.stringify(f.messages[u])))},[o,c,d,g,p,N,T,w,S,B,l,s,n,i,a,V,R,O,E,L,f,u,v,M,z,q,ie,se,ne,fe,F,le,ge,_e,H,x,he,ae]}class Za extends Te{constructor(e){super(),Be(this,e,Ya,Fa,De,{user:0,history:20,messageId:21,siblings:1,showPreviousMessage:2,showNextMessage:3,editMessage:22,deleteMessage:23,isFirstMessage:4,readOnly:5},null,[-1,-1])}}function Ws(r){let e,t,l,s;const n=[Xa,Qa,Ka],i=[];function a(o,f){var u,c;return o[0].messages[o[3]].role==="user"?0:(((c=(u=o[0].messages[o[0].messages[o[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=a(r),t=i[e]=n[e](r),{c(){t.c(),l=ce()},l(o){t.l(o),l=ce()},m(o,f){i[e].m(o,f),C(o,l,f),s=!0},p(o,f){let u=e;e=a(o),e===u?i[e].p(o,f):(ee(),D(i[u],1,1,()=>{i[u]=null}),te(),t=i[e],t?t.p(o,f):(t=i[e]=n[e](o),t.c()),b(t,1),t.m(l.parentNode,l))},i(o){s||(b(t),s=!0)},o(o){D(t),s=!1},d(o){o&&m(l),i[e].d(o)}}}function Ka(r){var i;let e,t,l;function s(a){r[21](a)}let n={chatId:r[1],messageId:r[3],isLastMessage:r[3]===((i=r[0])==null?void 0:i.currentId),updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],continueResponse:r[15],regenerateResponse:r[14],mergeResponses:r[16],triggerScroll:r[18],addMessages:r[17],readOnly:r[19]};return r[0]!==void 0&&(n.history=r[0]),e=new Sa({props:n}),ze.push(()=>Ke(e,"history",s)),{c(){K(e.$$.fragment)},l(a){Q(e.$$.fragment,a)},m(a,o){X(e,a,o),l=!0},p(a,o){var u;const f={};o&2&&(f.chatId=a[1]),o&8&&(f.messageId=a[3]),o&9&&(f.isLastMessage=a[3]===((u=a[0])==null?void 0:u.currentId)),o&128&&(f.updateChat=a[7]),o&256&&(f.editMessage=a[8]),o&512&&(f.saveMessage=a[9]),o&2048&&(f.rateMessage=a[11]),o&4096&&(f.actionMessage=a[12]),o&8192&&(f.submitMessage=a[13]),o&32768&&(f.continueResponse=a[15]),o&16384&&(f.regenerateResponse=a[14]),o&65536&&(f.mergeResponses=a[16]),o&262144&&(f.triggerScroll=a[18]),o&131072&&(f.addMessages=a[17]),o&524288&&(f.readOnly=a[19]),!t&&o&1&&(t=!0,f.history=a[0],Ze(()=>t=!1)),e.$set(f)},i(a){l||(b(e.$$.fragment,a),l=!0)},o(a){D(e.$$.fragment,a),l=!1},d(a){$(e,a)}}}function Qa(r){var l;let e,t;return e=new vn({props:{chatId:r[1],history:r[0],messageId:r[3],isLastMessage:r[3]===r[0].currentId,siblings:((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[],showPreviousMessage:r[5],showNextMessage:r[6],updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],continueResponse:r[15],regenerateResponse:r[14],addMessages:r[17],readOnly:r[19]}}),{c(){K(e.$$.fragment)},l(s){Q(e.$$.fragment,s)},m(s,n){X(e,s,n),t=!0},p(s,n){var a;const i={};n&2&&(i.chatId=s[1]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&9&&(i.isLastMessage=s[3]===s[0].currentId),n&9&&(i.siblings=((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&128&&(i.updateChat=s[7]),n&256&&(i.editMessage=s[8]),n&512&&(i.saveMessage=s[9]),n&2048&&(i.rateMessage=s[11]),n&4096&&(i.actionMessage=s[12]),n&8192&&(i.submitMessage=s[13]),n&32768&&(i.continueResponse=s[15]),n&16384&&(i.regenerateResponse=s[14]),n&131072&&(i.addMessages=s[17]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){$(e,s)}}}function Xa(r){var l;let e,t;return e=new Za({props:{user:r[4],history:r[0],messageId:r[3],isFirstMessage:r[2]===0,siblings:r[0].messages[r[3]].parentId!==null?((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(r[0].messages).filter(qs).map(Js)??[],showPreviousMessage:r[5],showNextMessage:r[6],editMessage:r[8],deleteMessage:r[10],readOnly:r[19]}}),{c(){K(e.$$.fragment)},l(s){Q(e.$$.fragment,s)},m(s,n){X(e,s,n),t=!0},p(s,n){var a;const i={};n&16&&(i.user=s[4]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&4&&(i.isFirstMessage=s[2]===0),n&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((a=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:a.childrenIds)??[]:Object.values(s[0].messages).filter(qs).map(Js)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&256&&(i.editMessage=s[8]),n&1024&&(i.deleteMessage=s[10]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){$(e,s)}}}function $a(r){let e,t,l,s=r[0].messages[r[3]]&&Ws(r);return{c(){e=y("div"),s&&s.c(),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(m),this.h()},h(){var n;h(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((n=r[20])==null?void 0:n.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(n,i){C(n,e,i),s&&s.m(e,null),l=!0},p(n,[i]){var a;n[0].messages[n[3]]?s?(s.p(n,i),i&9&&b(s,1)):(s=Ws(n),s.c(),b(s,1),s.m(e,null)):s&&(ee(),D(s,1,1,()=>{s=null}),te()),(!l||i&1048576&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((a=n[20])==null?void 0:a.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&h(e,"class",t)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&m(e),s&&s.d()}}}const qs=r=>r.parentId===null,Js=r=>r.id;function xa(r,e,t){let l;Me(r,Ht,E=>t(20,l=E)),ht(),qe("i18n");let{chatId:s}=e,{idx:n=0}=e,{history:i}=e,{messageId:a}=e,{user:o}=e,{showPreviousMessage:f}=e,{showNextMessage:u}=e,{updateChat:c}=e,{editMessage:d}=e,{saveMessage:g}=e,{deleteMessage:v}=e,{rateMessage:M}=e,{actionMessage:p}=e,{submitMessage:N}=e,{regenerateResponse:w}=e,{continueResponse:S}=e,{mergeResponses:B}=e,{addMessages:T}=e,{triggerScroll:V}=e,{readOnly:R=!1}=e;function O(E){i=E,t(0,i)}return r.$$set=E=>{"chatId"in E&&t(1,s=E.chatId),"idx"in E&&t(2,n=E.idx),"history"in E&&t(0,i=E.history),"messageId"in E&&t(3,a=E.messageId),"user"in E&&t(4,o=E.user),"showPreviousMessage"in E&&t(5,f=E.showPreviousMessage),"showNextMessage"in E&&t(6,u=E.showNextMessage),"updateChat"in E&&t(7,c=E.updateChat),"editMessage"in E&&t(8,d=E.editMessage),"saveMessage"in E&&t(9,g=E.saveMessage),"deleteMessage"in E&&t(10,v=E.deleteMessage),"rateMessage"in E&&t(11,M=E.rateMessage),"actionMessage"in E&&t(12,p=E.actionMessage),"submitMessage"in E&&t(13,N=E.submitMessage),"regenerateResponse"in E&&t(14,w=E.regenerateResponse),"continueResponse"in E&&t(15,S=E.continueResponse),"mergeResponses"in E&&t(16,B=E.mergeResponses),"addMessages"in E&&t(17,T=E.addMessages),"triggerScroll"in E&&t(18,V=E.triggerScroll),"readOnly"in E&&t(19,R=E.readOnly)},[i,s,n,a,o,f,u,c,d,g,v,M,p,N,w,S,B,T,V,R,l,O]}class eo extends Te{constructor(e){super(),Be(this,e,xa,$a,De,{chatId:1,idx:2,history:0,messageId:3,user:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:8,saveMessage:9,deleteMessage:10,rateMessage:11,actionMessage:12,submitMessage:13,regenerateResponse:14,continueResponse:15,mergeResponses:16,addMessages:17,triggerScroll:18,readOnly:19})}}function to(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function lo(r,e,t){let{className:l="size-3"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class so extends Te{constructor(e){super(),Be(this,e,lo,to,De,{className:0,strokeWidth:1})}}function Fs(r,e,t){const l=r.slice();return l[7]=e[t],l[9]=t,l}function Gs(r){let e,t,l,s=r[2].t("Suggested")+"",n,i;return t=new so({}),{c(){e=y("div"),K(t.$$.fragment),l=j(),n=U(s),this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);Q(t.$$.fragment,o),l=A(o),n=W(o,s),o.forEach(m),this.h()},h(){h(e,"class","mb-1 flex gap-1 text-sm font-medium items-center text-gray-400 dark:text-gray-600")},m(a,o){C(a,e,o),X(t,e,null),_(e,l),_(e,n),i=!0},p(a,o){(!i||o&4)&&s!==(s=a[2].t("Suggested")+"")&&G(n,s)},i(a){i||(b(t.$$.fragment,a),i=!0)},o(a){D(t.$$.fragment,a),i=!1},d(a){a&&m(e),$(t)}}}function no(r){let e,t=r[7].content+"",l,s,n,i="Prompt";return{c(){e=y("div"),l=U(t),s=j(),n=y("div"),n.textContent=i,this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);l=W(o,t),o.forEach(m),s=A(a),n=I(a,"DIV",{class:!0,"data-svelte-h":!0}),Oe(n)!=="svelte-1jw4qwu"&&(n.textContent=i),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(n,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,o){C(a,e,o),_(e,l),C(a,s,o),C(a,n,o)},p(a,o){o&2&&t!==(t=a[7].content+"")&&G(l,t)},d(a){a&&(m(e),m(s),m(n))}}}function ro(r){let e,t=r[7].title[0]+"",l,s,n,i=r[7].title[1]+"",a;return{c(){e=y("div"),l=U(t),s=j(),n=y("div"),a=U(i),this.h()},l(o){e=I(o,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(m),s=A(o),n=I(o,"DIV",{class:!0});var u=k(n);a=W(u,i),u.forEach(m),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(n,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(o,f){C(o,e,f),_(e,l),C(o,s,f),C(o,n,f),_(n,a)},p(o,f){f&2&&t!==(t=o[7].title[0]+"")&&G(l,t),f&2&&i!==(i=o[7].title[1]+"")&&G(a,i)},d(o){o&&(m(e),m(s),m(n))}}}function Ys(r){let e,t,l,s,n;function i(u,c){return u[7].title&&u[7].title[0]!==""?ro:no}let a=i(r),o=a(r);function f(){return r[6](r[7])}return{c(){e=y("button"),t=y("div"),o.c(),l=j(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var c=k(e);t=I(c,"DIV",{class:!0});var d=k(t);o.l(d),d.forEach(m),l=A(c),c.forEach(m),this.h()},h(){h(t,"class","flex flex-col text-left"),h(e,"class","flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group")},m(u,c){C(u,e,c),_(e,t),o.m(t,null),_(e,l),s||(n=me(e,"click",f),s=!0)},p(u,c){r=u,a===(a=i(r))&&o?o.p(r,c):(o.d(1),o=a(r),o&&(o.c(),o.m(t,null)))},d(u){u&&m(e),o.d(),s=!1,n()}}}function io(r){let e,t,l,s,n=r[1].length>0&&Gs(r),i=ye(r[1]),a=[];for(let o=0;o<i.length;o+=1)a[o]=Ys(Fs(r,i,o));return{c(){n&&n.c(),e=j(),t=y("div");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){n&&n.l(o),e=A(o),t=I(o,"DIV",{class:!0});var f=k(t);for(let u=0;u<a.length;u+=1)a[u].l(f);f.forEach(m),this.h()},h(){h(t,"class",l="h-40 max-h-full overflow-auto scrollbar-none "+r[0])},m(o,f){n&&n.m(o,f),C(o,e,f),C(o,t,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(t,null);s=!0},p(o,[f]){if(o[1].length>0?n?(n.p(o,f),f&2&&b(n,1)):(n=Gs(o),n.c(),b(n,1),n.m(e.parentNode,e)):n&&(ee(),D(n,1,1,()=>{n=null}),te()),f&18){i=ye(o[1]);let u;for(u=0;u<i.length;u+=1){const c=Fs(o,i,u);a[u]?a[u].p(c,f):(a[u]=Ys(c),a[u].c(),a[u].m(t,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}(!s||f&1&&l!==(l="h-40 max-h-full overflow-auto scrollbar-none "+o[0]))&&h(t,"class",l)},i(o){s||(b(n),s=!0)},o(o){D(n),s=!1},d(o){o&&(m(e),m(t)),n&&n.d(o),Ue(a,o)}}}function ao(r,e,t){let l;const s=qe("i18n");Me(r,s,u=>t(2,l=u));const n=ht();let{suggestionPrompts:i=[]}=e,{className:a=""}=e,o=[];const f=u=>{n("select",u.content)};return r.$$set=u=>{"suggestionPrompts"in u&&t(5,i=u.suggestionPrompts),"className"in u&&t(0,a=u.className)},r.$$.update=()=>{r.$$.dirty&32&&t(1,o=(i??[]).reduce((u,c)=>[...u,c],[]).sort(()=>Math.random()-.5))},[a,o,l,s,n,i,f]}class oo extends Te{constructor(e){super(),Be(this,e,ao,io,De,{suggestionPrompts:5,className:0})}}function fo(r){let e,t;return{c(){e=be("svg"),t=be("path"),this.h()},l(l){e=ke(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=ke(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",r[1]),h(e,"stroke","currentColor"),h(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&m(e)}}}function uo(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class co extends Te{constructor(e){super(),Be(this,e,uo,fo,De,{className:0,strokeWidth:1})}}function Zs(r,e,t){const l=r.slice();return l[13]=e[t],l[15]=t,l}function ho(r){let e,t;return{c(){e=y("img"),this.h()},l(l){e=I(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,n;h(e,"crossorigin","anonymous"),Tt(e.src,t=((n=(s=(l=r[13])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.profile_image_url)??(r[4].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`))||h(e,"src",t),h(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),h(e,"alt","logo"),h(e,"draggable","false")},m(l,s){C(l,e,s)},p(l,s){var n,i,a;s&17&&!Tt(e.src,t=((a=(i=(n=l[13])==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??(l[4].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`))&&h(e,"src",t)},d(l){l&&m(e)}}}function Ks(r){var o,f,u;let e,t,l,s,n,i;t=new Re({props:{content:Rt.parse(gt(((u=(f=(o=r[0][r[3]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[ho]},$$scope:{ctx:r}}});function a(){return r[11](r[15])}return{c(){e=y("button"),K(t.$$.fragment),l=j()},l(c){e=I(c,"BUTTON",{});var d=k(e);Q(t.$$.fragment,d),l=A(d),d.forEach(m)},m(c,d){C(c,e,d),X(t,e,null),_(e,l),s=!0,n||(i=me(e,"click",a),n=!0)},p(c,d){var v,M,p;r=c;const g={};d&9&&(g.content=Rt.parse(gt(((p=(M=(v=r[0][r[3]])==null?void 0:v.info)==null?void 0:M.meta)==null?void 0:p.description)??""))),d&65553&&(g.$$scope={dirty:d,ctx:r}),t.$set(g)},i(c){s||(b(t.$$.fragment,c),s=!0)},o(c){D(t.$$.fragment,c),s=!1},d(c){c&&m(e),$(t),n=!1,i()}}}function Qs(r){let e,t;return e=new Re({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[mo]},$$scope:{ctx:r}}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function mo(r){let e,t,l,s;return t=new co({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=y("div"),K(t.$$.fragment),l=U(" Temporary Chat"),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);Q(t.$$.fragment,i),l=W(i," Temporary Chat"),i.forEach(m),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(n,i){C(n,e,i),X(t,e,null),_(e,l),s=!0},p:ve,i(n){s||(b(t.$$.fragment,n),s=!0)},o(n){D(t.$$.fragment,n),s=!1},d(n){n&&m(e),$(t)}}}function go(r){let e=r[4].t("Hello, {{name}}",{name:r[6].name})+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){C(l,t,s)},p(l,s){s&80&&e!==(e=l[4].t("Hello, {{name}}",{name:l[6].name})+"")&&G(t,e)},d(l){l&&m(t)}}}function _o(r){var l;let e=((l=r[0][r[3]])==null?void 0:l.name)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n&9&&e!==(e=((i=s[0][s[3]])==null?void 0:i.name)+"")&&G(t,e)},d(s){s&&m(t)}}}function vo(r){let e,t=r[4].t("How can I help you today?")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var n=k(e);l=W(n,t),n.forEach(m),this.h()},h(){h(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("How can I help you today?")+"")&&G(l,t)},d(s){s&&m(e)}}}function po(r){var a,o,f,u,c,d;let e,t,l=Rt.parse(gt((f=(o=(a=r[0][r[3]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:f.description))+"",s,n,i=((d=(c=(u=r[0][r[3]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:d.user)&&Xs(r);return{c(){e=y("div"),t=new Dn(!1),s=j(),i&&i.c(),n=ce(),this.h()},l(g){e=I(g,"DIV",{class:!0});var v=k(e);t=Vn(v,!1),v.forEach(m),s=A(g),i&&i.l(g),n=ce(),this.h()},h(){t.a=null,h(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(g,v){C(g,e,v),t.m(l,e),C(g,s,v),i&&i.m(g,v),C(g,n,v)},p(g,v){var M,p,N,w,S,B;v&9&&l!==(l=Rt.parse(gt((N=(p=(M=g[0][g[3]])==null?void 0:M.info)==null?void 0:p.meta)==null?void 0:N.description))+"")&&t.p(l),(B=(S=(w=g[0][g[3]])==null?void 0:w.info)==null?void 0:S.meta)!=null&&B.user?i?i.p(g,v):(i=Xs(g),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(g){g&&(m(e),m(s),m(n)),i&&i.d(g)}}}function Xs(r){let e,t;function l(i,a){var o,f,u;return(u=(f=(o=i[0][i[3]])==null?void 0:o.info)==null?void 0:f.meta)!=null&&u.user.community?ko:bo}let s=l(r),n=s(r);return{c(){e=y("div"),t=U(`By
								`),n.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var a=k(e);t=W(a,`By
								`),n.l(a),a.forEach(m),this.h()},h(){h(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,a){C(i,e,a),_(e,t),n.m(e,null)},p(i,a){s===(s=l(i))&&n?n.p(i,a):(n.d(1),n=s(i),n&&(n.c(),n.m(e,null)))},d(i){i&&m(e),n.d()}}}function bo(r){var l,s,n;let e=((n=(s=(l=r[0][r[3]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.user.name)+"",t;return{c(){t=U(e)},l(i){t=W(i,e)},m(i,a){C(i,t,a)},p(i,a){var o,f,u;a&9&&e!==(e=((u=(f=(o=i[0][i[3]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&G(t,e)},d(i){i&&m(t)}}}function ko(r){var n,i,a,o,f,u,c,d,g;let e,t=((a=(i=(n=r[0][r[3]])==null?void 0:n.info)==null?void 0:i.meta)!=null&&a.user.name?(u=(f=(o=r[0][r[3]])==null?void 0:o.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(g=(d=(c=r[0][r[3]])==null?void 0:c.info)==null?void 0:d.meta)==null?void 0:g.user.username}`)+"",l,s;return{c(){e=y("a"),l=U(t),this.h()},l(v){e=I(v,"A",{href:!0});var M=k(e);l=W(M,t),M.forEach(m),this.h()},h(){var v,M,p;h(e,"href",s="https://openwebui.com/m/"+((p=(M=(v=r[0][r[3]])==null?void 0:v.info)==null?void 0:M.meta)==null?void 0:p.user.username))},m(v,M){C(v,e,M),_(e,l)},p(v,M){var p,N,w,S,B,T,V,R,O,E,L,z;M&9&&t!==(t=((w=(N=(p=v[0][v[3]])==null?void 0:p.info)==null?void 0:N.meta)!=null&&w.user.name?(T=(B=(S=v[0][v[3]])==null?void 0:S.info)==null?void 0:B.meta)==null?void 0:T.user.name:`@${(O=(R=(V=v[0][v[3]])==null?void 0:V.info)==null?void 0:R.meta)==null?void 0:O.user.username}`)+"")&&G(l,t),M&9&&s!==(s="https://openwebui.com/m/"+((z=(L=(E=v[0][v[3]])==null?void 0:E.info)==null?void 0:L.meta)==null?void 0:z.user.username))&&h(e,"href",s)},d(v){v&&m(e)}}}function $s(r){var ie,se,ne,fe;let e,t,l,s,n,i,a,o,f,u,c,d,g,v,M,p,N,w,S=ye(r[0]),B=[];for(let F=0;F<S.length;F+=1)B[F]=Ks(Zs(r,S,F));const T=F=>D(B[F],1,1,()=>{B[F]=null});let V=r[5]&&Qs(r);function R(F,le){var ge;return(ge=F[0][F[3]])!=null&&ge.name?_o:go}let O=R(r),E=O(r);function L(F,le){var ge,_e,H;return((H=(_e=(ge=F[0][F[3]])==null?void 0:ge.info)==null?void 0:_e.meta)==null?void 0:H.description)??null?po:vo}let z=L(r),q=z(r);return p=new oo({props:{className:"grid grid-cols-2",suggestionPrompts:((ne=(se=(ie=r[0][r[3]])==null?void 0:ie.info)==null?void 0:se.meta)==null?void 0:ne.suggestion_prompts)??((fe=r[7])==null?void 0:fe.default_prompt_suggestions)??[]}}),p.$on("select",r[12]),{c(){e=y("div"),t=y("div"),l=y("div");for(let F=0;F<B.length;F+=1)B[F].c();n=j(),V&&V.c(),i=j(),a=y("div"),o=y("div"),f=y("div"),E.c(),c=j(),d=y("div"),q.c(),v=j(),M=y("div"),K(p.$$.fragment),this.h()},l(F){e=I(F,"DIV",{class:!0});var le=k(e);t=I(le,"DIV",{class:!0});var ge=k(t);l=I(ge,"DIV",{class:!0});var _e=k(l);for(let P=0;P<B.length;P+=1)B[P].l(_e);_e.forEach(m),ge.forEach(m),n=A(le),V&&V.l(le),i=A(le),a=I(le,"DIV",{class:!0});var H=k(a);o=I(H,"DIV",{});var x=k(o);f=I(x,"DIV",{class:!0});var he=k(f);E.l(he),he.forEach(m),c=A(x),d=I(x,"DIV",{});var ae=k(d);q.l(ae),ae.forEach(m),x.forEach(m),H.forEach(m),v=A(le),M=I(le,"DIV",{class:!0});var Y=k(M);Q(p.$$.fragment,Y),Y.forEach(m),le.forEach(m),this.h()},h(){h(l,"class","flex -space-x-4 mb-0.5"),h(t,"class","flex justify-start"),h(f,"class","capitalize line-clamp-1"),h(a,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),h(M,"class","w-full font-primary"),h(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(F,le){C(F,e,le),_(e,t),_(t,l);for(let ge=0;ge<B.length;ge+=1)B[ge]&&B[ge].m(l,null);_(e,n),V&&V.m(e,null),_(e,i),_(e,a),_(a,o),_(o,f),E.m(f,null),_(o,c),_(o,d),q.m(d,null),_(e,v),_(e,M),X(p,M,null),w=!0},p(F,le){var _e,H,x,he;if(le&25){S=ye(F[0]);let ae;for(ae=0;ae<S.length;ae+=1){const Y=Zs(F,S,ae);B[ae]?(B[ae].p(Y,le),b(B[ae],1)):(B[ae]=Ks(Y),B[ae].c(),b(B[ae],1),B[ae].m(l,null))}for(ee(),ae=S.length;ae<B.length;ae+=1)T(ae);te()}F[5]?V?le&32&&b(V,1):(V=Qs(F),V.c(),b(V,1),V.m(e,i)):V&&(ee(),D(V,1,1,()=>{V=null}),te()),O===(O=R(F))&&E?E.p(F,le):(E.d(1),E=O(F),E&&(E.c(),E.m(f,null))),z===(z=L(F))&&q?q.p(F,le):(q.d(1),q=z(F),q&&(q.c(),q.m(d,null)));const ge={};le&137&&(ge.suggestionPrompts=((x=(H=(_e=F[0][F[3]])==null?void 0:_e.info)==null?void 0:H.meta)==null?void 0:x.suggestion_prompts)??((he=F[7])==null?void 0:he.default_prompt_suggestions)??[]),p.$set(ge)},i(F){if(!w){for(let le=0;le<S.length;le+=1)b(B[le]);F&&(s||Dt(()=>{s=Vt(l,Ct,{duration:200}),s.start()})),b(V),F&&(u||Dt(()=>{u=Vt(f,Ct,{duration:200}),u.start()})),F&&(g||Dt(()=>{g=Vt(d,Ct,{duration:200,delay:200}),g.start()})),b(p.$$.fragment,F),F&&(N||Dt(()=>{N=Vt(M,Ct,{duration:200,delay:300}),N.start()})),w=!0}},o(F){B=B.filter(Boolean);for(let le=0;le<B.length;le+=1)D(B[le]);D(V),D(p.$$.fragment,F),w=!1},d(F){F&&m(e),Ue(B,F),V&&V.d(),E.d(),q.d(),$(p)}}}function wo(r){let e=r[2],t,l,s=$s(r);return{c(){s.c(),t=ce()},l(n){s.l(n),t=ce()},m(n,i){s.m(n,i),C(n,t,i),l=!0},p(n,[i]){i&4&&De(e,e=n[2])?(ee(),D(s,1,1,ve),te(),s=$s(n),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&m(t),s.d(n)}}}function yo(r,e,t){let l,s,n,i,a;Me(r,Ot,p=>t(10,l=p)),Me(r,Sn,p=>t(5,n=p)),Me(r,Lt,p=>t(6,i=p)),Me(r,fn,p=>t(7,a=p));const o=qe("i18n");Me(r,o,p=>t(4,s=p));let{modelIds:f=[]}=e,{models:u=[]}=e,{submitPrompt:c}=e,d=!1,g=0;vt(()=>{t(2,d=!0)});const v=p=>{t(3,g=p)},M=p=>{c(p.detail)};return r.$$set=p=>{"modelIds"in p&&t(9,f=p.modelIds),"models"in p&&t(0,u=p.models),"submitPrompt"in p&&t(1,c=p.submitPrompt)},r.$$.update=()=>{r.$$.dirty&1536&&t(0,u=f.map(p=>l.find(N=>N.id===p))),r.$$.dirty&513&&f.length>0&&t(3,g=u.length-1)},[u,c,d,g,s,n,i,a,o,f,l,v,M]}class Io extends Te{constructor(e){super(),Be(this,e,yo,wo,De,{modelIds:9,models:0,submitPrompt:1})}}function xs(r,e,t){const l=r.slice();return l[40]=e[t],l[42]=t,l}function Mo(r){let e,t=r[3],l,s=sn(r);return{c(){e=y("div"),s.c(),this.h()},l(n){e=I(n,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(m),this.h()},h(){h(e,"class","w-full pt-2")},m(n,i){C(n,e,i),s.m(e,null),l=!0},p(n,i){i[0]&8&&De(t,t=n[3])?(ee(),D(s,1,1,ve),te(),s=sn(n),s.c(),b(s,1),s.m(e,null)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&m(e),s.d(n)}}}function Eo(r){let e,t;return e=new Io({props:{modelIds:r[5],submitPrompt:r[32]}}),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[0]&32&&(n.modelIds=l[5]),s[0]&32770&&(n.submitPrompt=l[32]),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function en(r){let e,t;return e=new Qn({props:{$$slots:{default:[No]},$$scope:{ctx:r}}}),e.$on("visible",r[33]),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,s){X(e,l,s),t=!0},p(l,s){const n={};s[1]&4096&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function No(r){let e,t,l,s,n="Loading...",i;return t=new Pt({props:{className:" size-4"}}),{c(){e=y("div"),K(t.$$.fragment),l=j(),s=y("div"),s.textContent=n,this.h()},l(a){e=I(a,"DIV",{class:!0});var o=k(e);Q(t.$$.fragment,o),l=A(o),s=I(o,"DIV",{class:!0,"data-svelte-h":!0}),Oe(s)!=="svelte-17uns3n"&&(s.textContent=n),o.forEach(m),this.h()},h(){h(s,"class",""),h(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(a,o){C(a,e,o),X(t,e,null),_(e,l),_(e,s),i=!0},p:ve,i(a){i||(b(t.$$.fragment,a),i=!0)},o(a){D(t.$$.fragment,a),i=!1},d(a){a&&m(e),$(t)}}}function tn(r,e){let t,l,s,n;function i(o){e[34](o)}let a={chatId:e[3],messageId:e[40].id,idx:e[42],user:e[4],showPreviousMessage:e[19],showNextMessage:e[20],updateChat:e[18],editMessage:e[22],deleteMessage:e[25],rateMessage:e[21],actionMessage:e[23],saveMessage:e[24],submitMessage:e[9],regenerateResponse:e[7],continueResponse:e[6],mergeResponses:e[8],addMessages:e[10],triggerScroll:e[26],readOnly:e[11]};return e[0]!==void 0&&(a.history=e[0]),l=new eo({props:a}),ze.push(()=>Ke(l,"history",i)),{key:r,first:null,c(){t=ce(),K(l.$$.fragment),this.h()},l(o){t=ce(),Q(l.$$.fragment,o),this.h()},h(){this.first=t},m(o,f){C(o,t,f),X(l,o,f),n=!0},p(o,f){e=o;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&8192&&(u.messageId=e[40].id),f[0]&8192&&(u.idx=e[42]),f[0]&16&&(u.user=e[4]),f[0]&512&&(u.submitMessage=e[9]),f[0]&128&&(u.regenerateResponse=e[7]),f[0]&64&&(u.continueResponse=e[6]),f[0]&256&&(u.mergeResponses=e[8]),f[0]&1024&&(u.addMessages=e[10]),f[0]&2048&&(u.readOnly=e[11]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ze(()=>s=!1)),l.$set(u)},i(o){n||(b(l.$$.fragment,o),n=!0)},o(o){D(l.$$.fragment,o),n=!1},d(o){o&&m(t),$(l,o)}}}function ln(r){let e;return{c(){e=y("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),k(e).forEach(m),this.h()},h(){h(e,"class","pb-6")},m(t,l){C(t,e,l)},d(t){t&&m(e)}}}function sn(r){var M;let e,t=((M=r[13].at(0))==null?void 0:M.parentId)!==null,l,s=[],n=new Map,i,a,o,f,u,c=t&&en(r),d=ye(r[13]);const g=p=>p[40].id;for(let p=0;p<d.length;p+=1){let N=xs(r,d,p),w=g(N);n.set(w,s[p]=tn(w,N))}let v=r[12]&&ln();return{c(){e=y("div"),c&&c.c(),l=j();for(let p=0;p<s.length;p+=1)s[p].c();i=j(),a=y("div"),o=j(),v&&v.c(),f=ce(),this.h()},l(p){e=I(p,"DIV",{class:!0});var N=k(e);c&&c.l(N),l=A(N);for(let w=0;w<s.length;w+=1)s[w].l(N);N.forEach(m),i=A(p),a=I(p,"DIV",{class:!0}),k(a).forEach(m),o=A(p),v&&v.l(p),f=ce(),this.h()},h(){h(e,"class","w-full"),h(a,"class","pb-12")},m(p,N){C(p,e,N),c&&c.m(e,null),_(e,l);for(let w=0;w<s.length;w+=1)s[w]&&s[w].m(e,null);C(p,i,N),C(p,a,N),C(p,o,N),v&&v.m(p,N),C(p,f,N),u=!0},p(p,N){var w;N[0]&8192&&(t=((w=p[13].at(0))==null?void 0:w.parentId)!==null),t?c?(c.p(p,N),N[0]&8192&&b(c,1)):(c=en(p),c.c(),b(c,1),c.m(e,l)):c&&(ee(),D(c,1,1,()=>{c=null}),te()),N[0]&133967833&&(d=ye(p[13]),ee(),s=rn(s,N,g,1,p,d,n,e,an,tn,null,xs),te()),p[12]?v||(v=ln(),v.c(),v.m(f.parentNode,f)):v&&(v.d(1),v=null)},i(p){if(!u){b(c);for(let N=0;N<d.length;N+=1)b(s[N]);u=!0}},o(p){D(c);for(let N=0;N<s.length;N+=1)D(s[N]);u=!1},d(p){p&&(m(e),m(i),m(a),m(o),m(f)),c&&c.d();for(let N=0;N<s.length;N+=1)s[N].d();v&&v.d(p)}}}function Do(r){let e,t,l,s,n;const i=[Eo,Mo],a=[];function o(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=o(r,[-1,-1]),s=a[l]=i[l](r),{c(){e=y("div"),s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(m),this.h()},h(){h(e,"class",r[2])},m(f,u){C(f,e,u),a[l].m(e,null),n=!0},p(f,u){let c=l;l=o(f,u),l===c?a[l].p(f,u):(ee(),D(a[c],1,1,()=>{a[c]=null}),te(),s=a[l],s?s.p(f,u):(s=a[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!n||u[0]&4)&&h(e,"class",f[2])},i(f){n||(b(s),n=!0)},o(f){D(s),n=!1},d(f){f&&m(e),a[l].d()}}}function Vo(r,e,t){let l,s,n,i;Me(r,Ht,P=>t(35,l=P)),Me(r,Xt,P=>t(36,s=P)),Me(r,Lt,P=>t(37,n=P)),ht();const a=qe("i18n");Me(r,a,P=>t(15,i=P));let{className:o="h-full flex pt-8"}=e,{chatId:f=""}=e,{user:u=n}=e,{prompt:c}=e,{history:d={}}=e,{selectedModels:g}=e,v=[],{sendPrompt:M}=e,{continueResponse:p}=e,{regenerateResponse:N}=e,{mergeResponses:w}=e,{chatActionHandler:S}=e,{showMessage:B=()=>{}}=e,{submitMessage:T=()=>{}}=e,{addMessages:V=()=>{}}=e,{readOnly:R=!1}=e,{bottomPadding:O=!1}=e,{autoScroll:E}=e,L=20,z=!1;const q=async()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollTop+100,t(14,z=!0),t(31,L+=20),await Ne(),t(14,z=!1)},ie=()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollHeight},se=async()=>{t(0,d),await Ne(),await Hn(localStorage.token,f,{history:d,messages:v}),Xt.set(1),await Rn.set(await Ln(localStorage.token,s))},ne=async P=>{if(P.parentId!==null){let Z=d.messages[P.parentId].childrenIds[Math.max(d.messages[P.parentId].childrenIds.indexOf(P.id)-1,0)];if(P.id!==Z){let de=d.messages[Z].childrenIds;for(;de.length!==0;)Z=de.at(-1),de=d.messages[Z].childrenIds;t(0,d.currentId=Z,d)}}else{let Z=Object.values(d.messages).filter(ue=>ue.parentId===null).map(ue=>ue.id),de=Z[Math.max(Z.indexOf(P.id)-1,0)];if(P.id!==de){let ue=d.messages[de].childrenIds;for(;ue.length!==0;)de=ue.at(-1),ue=d.messages[de].childrenIds;t(0,d.currentId=de,d)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const Z=document.getElementById("messages-container");t(27,E=Z.scrollHeight-Z.scrollTop<=Z.clientHeight+50),setTimeout(()=>{ie()},100)}},fe=async P=>{if(P.parentId!==null){let Z=d.messages[P.parentId].childrenIds[Math.min(d.messages[P.parentId].childrenIds.indexOf(P.id)+1,d.messages[P.parentId].childrenIds.length-1)];if(P.id!==Z){let de=d.messages[Z].childrenIds;for(;de.length!==0;)Z=de.at(-1),de=d.messages[Z].childrenIds;t(0,d.currentId=Z,d)}}else{let Z=Object.values(d.messages).filter(ue=>ue.parentId===null).map(ue=>ue.id),de=Z[Math.min(Z.indexOf(P.id)+1,Z.length-1)];if(P.id!==de){let ue=d.messages[de].childrenIds;for(;ue.length!==0;)de=ue.at(-1),ue=d.messages[de].childrenIds;t(0,d.currentId=de,d)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const Z=document.getElementById("messages-container");t(27,E=Z.scrollHeight-Z.scrollTop<=Z.clientHeight+50),setTimeout(()=>{ie()},100)}},F=async(P,Z)=>{t(0,d.messages[P].annotation={...d.messages[P].annotation,rating:Z},d),await se()},le=async(P,Z,de=!0)=>{if(d.messages[P].role==="user")if(de){let ue=Z,we=$t(),oe={id:we,parentId:d.messages[P].parentId,childrenIds:[],role:"user",content:ue,...d.messages[P].files&&{files:d.messages[P].files},models:g},re=d.messages[P].parentId;re!==null&&t(0,d.messages[re].childrenIds=[...d.messages[re].childrenIds,we],d),t(0,d.messages[we]=oe,d),t(0,d.currentId=we,d),await Ne(),await M(ue,we)}else t(0,d.messages[P].content=Z,d),await se();else if(de){const ue=$t(),we=d.messages[P],oe=we.parentId,re={...we,id:ue,parentId:oe,childrenIds:[],files:void 0,content:Z,timestamp:Math.floor(Date.now()/1e3)};t(0,d.messages[ue]=re,d),t(0,d.currentId=ue,d),oe!==null&&t(0,d.messages[oe].childrenIds=[...d.messages[oe].childrenIds,ue],d),await se()}else t(0,d.messages[P].originalContent=d.messages[P].content,d),t(0,d.messages[P].content=Z,d),await se()},ge=async(P,Z,de=null)=>{await S(f,P,Z.model,Z.id,de)},_e=async(P,Z)=>{t(0,d.messages[P]=Z,d),await se()},H=async P=>{const Z=d.messages[P],de=Z.parentId,ue=Z.childrenIds??[],we=ue.flatMap(oe=>{var re;return((re=d.messages[oe])==null?void 0:re.childrenIds)??[]});de&&d.messages[de]&&t(0,d.messages[de].childrenIds=[...d.messages[de].childrenIds.filter(oe=>oe!==P),...we],d),we.forEach(oe=>{d.messages[oe]&&t(0,d.messages[oe].parentId=de,d)}),[P,...ue].forEach(oe=>{delete d.messages[oe]}),await Ne(),B({id:de}),await se()},x=()=>{if(E){const P=document.getElementById("messages-container");t(27,E=P.scrollHeight-P.scrollTop<=P.clientHeight+50),setTimeout(()=>{ie()},100)}},he=async P=>{let Z=P;if(P.includes("{{CLIPBOARD}}")){const ue=await navigator.clipboard.readText().catch(we=>(Le.error(i.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));Z=P.replaceAll("{{CLIPBOARD}}",ue)}t(1,c=Z),await Ne();const de=document.getElementById("chat-input-container");de&&(t(1,c=P),de.style.height="",de.style.height=Math.min(de.scrollHeight,200)+"px",de.focus()),await Ne()},ae=P=>{console.log("visible"),z||q()};function Y(P){d=P,t(0,d)}return r.$$set=P=>{"className"in P&&t(2,o=P.className),"chatId"in P&&t(3,f=P.chatId),"user"in P&&t(4,u=P.user),"prompt"in P&&t(1,c=P.prompt),"history"in P&&t(0,d=P.history),"selectedModels"in P&&t(5,g=P.selectedModels),"sendPrompt"in P&&t(28,M=P.sendPrompt),"continueResponse"in P&&t(6,p=P.continueResponse),"regenerateResponse"in P&&t(7,N=P.regenerateResponse),"mergeResponses"in P&&t(8,w=P.mergeResponses),"chatActionHandler"in P&&t(29,S=P.chatActionHandler),"showMessage"in P&&t(30,B=P.showMessage),"submitMessage"in P&&t(9,T=P.submitMessage),"addMessages"in P&&t(10,V=P.addMessages),"readOnly"in P&&t(11,R=P.readOnly),"bottomPadding"in P&&t(12,O=P.bottomPadding),"autoScroll"in P&&t(27,E=P.autoScroll)},r.$$.update=()=>{if(r.$$.dirty[0]&1|r.$$.dirty[1]&1)if(d.currentId){let P=[],Z=d.messages[d.currentId];for(;Z&&P.length<=L;)P.unshift({...Z}),Z=Z.parentId!==null?d.messages[Z.parentId]:null;t(13,v=P)}else t(13,v=[]);r.$$.dirty[0]&134221824&&E&&O&&(async()=>(await Ne(),ie()))()},[d,c,o,f,u,g,p,N,w,T,V,R,O,v,z,i,a,q,se,ne,fe,F,le,ge,_e,H,x,E,M,S,B,L,he,ae,Y]}class rf extends Te{constructor(e){super(),Be(this,e,Vo,Do,De,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,sendPrompt:28,continueResponse:6,regenerateResponse:7,mergeResponses:8,chatActionHandler:29,showMessage:30,submitMessage:9,addMessages:10,readOnly:11,bottomPadding:12,autoScroll:27},null,[-1,-1])}}export{co as E,rf as M,oo as S};
//# sourceMappingURL=Messages.DPfe3uBN.js.map
